2025-09-26 16:47:47,056 - __main__ - INFO - Initializing Data Sync AI services using your backup patterns...
2025-09-26 16:47:47,057 - __main__ - INFO - Environment check:
2025-09-26 16:47:47,057 - __main__ - INFO - FABRIC_CLIENT_ID: SET (36 chars)
2025-09-26 16:47:47,057 - __main__ - INFO - FABRIC_TENANT_ID: SET (36 chars)
2025-09-26 16:47:47,057 - __main__ - INFO - FABRIC_CLIENT_SECRET: SET (40 chars)
2025-09-26 16:47:47,058 - __main__ - INFO - FABRIC_SERVER: SET (88 chars)
2025-09-26 16:47:47,058 - __main__ - INFO - FABRIC_DATABASE: SET (59 chars)
2025-09-26 16:47:47,058 - __main__ - INFO - Testing Fabric credentials...
2025-09-26 16:47:47,058 - __main__ - INFO - AZURE_CLIENT_ID: SET
2025-09-26 16:47:47,058 - __main__ - INFO - AZURE_TENANT_ID: SET
2025-09-26 16:47:47,059 - __main__ - INFO - AZURE_CLIENT_SECRET: SET
2025-09-26 16:47:47,059 - __main__ - INFO - FABRIC_SERVER: vujzmxv6pj5utfki2rrm4f7ehm-3xoszn2rcmeebo5wm4avb26rmi.datawarehouse.fabric.microsoft.com
2025-09-26 16:47:47,059 - __main__ - INFO - FABRIC_DATABASE: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-26 16:47:47,059 - __main__ - INFO - SQL Fabric service initialized successfully
2025-09-26 16:47:47,060 - __main__ - INFO - Connecting to Fabric SQL with Service Principal authentication...
2025-09-26 16:49:21,700 - __main__ - ERROR - Failed to connect to Fabric SQL: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:49:21,700 - __main__ - ERROR - Query execution failed: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:49:21,701 - __main__ - ERROR - Table creation failed: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:49:21,745 - __main__ - INFO - DuckDB service initialized successfully
2025-09-26 16:49:21,749 - __main__ - INFO - Starting Data Sync AI using your exact backup patterns
2025-09-26 16:49:23,110 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.145:5000
2025-09-26 16:49:23,111 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-26 16:49:23,113 - werkzeug - INFO -  * Restarting with stat
2025-09-26 16:49:24,137 - __main__ - INFO - Initializing Data Sync AI services using your backup patterns...
2025-09-26 16:49:24,137 - __main__ - INFO - Environment check:
2025-09-26 16:49:24,138 - __main__ - INFO - FABRIC_CLIENT_ID: SET (36 chars)
2025-09-26 16:49:24,138 - __main__ - INFO - FABRIC_TENANT_ID: SET (36 chars)
2025-09-26 16:49:24,138 - __main__ - INFO - FABRIC_CLIENT_SECRET: SET (40 chars)
2025-09-26 16:49:24,138 - __main__ - INFO - FABRIC_SERVER: SET (88 chars)
2025-09-26 16:49:24,138 - __main__ - INFO - FABRIC_DATABASE: SET (59 chars)
2025-09-26 16:49:24,139 - __main__ - INFO - Testing Fabric credentials...
2025-09-26 16:49:24,139 - __main__ - INFO - AZURE_CLIENT_ID: SET
2025-09-26 16:49:24,139 - __main__ - INFO - AZURE_TENANT_ID: SET
2025-09-26 16:49:24,139 - __main__ - INFO - AZURE_CLIENT_SECRET: SET
2025-09-26 16:49:24,139 - __main__ - INFO - FABRIC_SERVER: vujzmxv6pj5utfki2rrm4f7ehm-3xoszn2rcmeebo5wm4avb26rmi.datawarehouse.fabric.microsoft.com
2025-09-26 16:49:24,140 - __main__ - INFO - FABRIC_DATABASE: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-26 16:49:24,140 - __main__ - INFO - SQL Fabric service initialized successfully
2025-09-26 16:49:24,140 - __main__ - INFO - Connecting to Fabric SQL with Service Principal authentication...
2025-09-26 16:50:57,806 - __main__ - ERROR - Failed to connect to Fabric SQL: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:50:57,807 - __main__ - ERROR - Query execution failed: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:50:57,807 - __main__ - ERROR - Table creation failed: ('CE269', "[CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error 12002 sending request to https://login.windows.net (0) (SQLDriverConnect); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Error requesting access token, HTTP status -1, expected 200 (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Failed to authenticate the user '07fa0494-da26-4a33-b764-0f020b250a38' in Entra ID (Authentication option is 'ActiveDirectoryServicePrincipal').\r\nError code 0xA190; state 41360\r\n (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [CE269] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)")
2025-09-26 16:50:57,839 - __main__ - INFO - DuckDB service initialized successfully
2025-09-26 16:50:57,842 - __main__ - INFO - Starting Data Sync AI using your exact backup patterns
2025-09-26 16:50:57,852 - werkzeug - WARNING -  * Debugger is active!
2025-09-26 16:50:57,862 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:17:59,715 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:17:59,715 - __main__ - WARNING - SQL Fabric connection not configured - using fallback
2025-09-29 12:18:01,778 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 12:18:01,778 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 12:18:01,780 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:18:02,431 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:18:02,431 - __main__ - WARNING - SQL Fabric connection not configured - using fallback
2025-09-29 12:18:03,177 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:18:03,184 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:19:12,464 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:12] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 12:19:12,706 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:12] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 12:19:31,555 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:31] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 12:19:31,805 - __main__ - INFO - Login successful: admin@example.com (admin)
2025-09-29 12:19:31,823 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:31] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 12:19:32,184 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 12:19:32,187 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:32] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 12:19:32,428 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 12:19:32,511 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 12:19:32] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 12:29:59,916 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 12:30:00,451 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:30:01,645 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:30:01,645 - __main__ - WARNING - SQL Fabric connection not configured - using fallback
2025-09-29 12:30:02,425 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:30:02,425 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:30:02,425 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:30:02,425 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:30:02,426 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:30:02,426 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:30:02,426 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:30:02,426 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:30:02,439 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:30:02,448 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:50:44,265 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 12:50:44,833 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:50:46,386 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:50:48,097 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:50:48,391 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:50:49,145 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:50:49,146 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:50:49,146 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:50:49,146 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:50:49,146 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:50:49,146 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:50:49,147 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:50:49,147 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:50:49,158 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:50:49,166 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:52:02,093 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 12:52:02,239 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:52:03,250 - __main__ - INFO - Using local file storage (Lakehouse URL not configured)
2025-09-29 12:52:03,273 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:52:03,871 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:52:03,980 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:52:04,721 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:52:04,721 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:52:04,721 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:52:04,721 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:52:04,722 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:52:04,722 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:52:04,722 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:52:04,722 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:52:04,738 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:52:04,744 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:55:14,688 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 12:55:15,002 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:55:16,042 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 12:55:16,068 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:55:16,905 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:55:17,107 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:55:17,864 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:55:17,865 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:55:17,865 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:55:17,865 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:55:17,865 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:55:17,866 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:55:17,866 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:55:17,866 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:55:17,877 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:55:17,884 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:55:48,531 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 12:55:48,677 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:55:49,668 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 12:55:49,687 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:55:50,422 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:55:50,552 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:55:51,302 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:55:51,303 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:55:51,303 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:55:51,303 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:55:51,303 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:55:51,303 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:55:51,304 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:55:51,304 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:55:51,313 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:55:51,319 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 12:57:52,099 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 12:57:52,115 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:57:52,798 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:57:52,928 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:57:53,619 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:57:53,619 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:57:53,619 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:57:53,619 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:57:53,620 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:57:53,620 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:57:53,620 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:57:53,620 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:57:54,911 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 12:57:54,912 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 12:57:54,914 - werkzeug - INFO -  * Restarting with stat
2025-09-29 12:57:55,562 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 12:57:55,578 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 12:57:56,390 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 12:57:56,601 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 12:57:57,291 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 12:57:57,291 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 12:57:57,292 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 12:57:57,292 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 12:57:57,292 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 12:57:57,292 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 12:57:57,292 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 12:57:57,292 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 12:57:57,300 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 12:57:57,305 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:00:33,802 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 13:00:34,232 - werkzeug - INFO -  * Restarting with stat
2025-09-29 13:00:35,439 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:00:35,466 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:00:36,350 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:00:36,557 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:00:37,313 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:00:37,313 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:00:37,313 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:00:37,314 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:00:37,314 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:00:37,314 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:00:37,314 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:00:37,314 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:00:37,324 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 13:00:37,330 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:00:49,438 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 13:00:49,583 - werkzeug - INFO -  * Restarting with stat
2025-09-29 13:00:50,563 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:00:50,585 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:01:01,777 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:01:01,886 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:01:02,635 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:01:02,636 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:01:02,636 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:01:02,636 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:01:02,636 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:01:02,636 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:01:02,637 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:01:02,637 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:01:02,645 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 13:01:02,651 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:01:18,083 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 13:01:18,221 - werkzeug - INFO -  * Restarting with stat
2025-09-29 13:01:19,153 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:01:19,172 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:01:20,085 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:01:20,292 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:01:21,040 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:01:21,040 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:01:21,040 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:01:21,041 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:01:21,041 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:01:21,041 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:01:21,041 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:01:21,042 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:01:21,051 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 13:01:21,057 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:01:36,819 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:01:36] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 13:02:05,806 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:02:05] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 13:02:19,802 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:02:19] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 13:02:20,050 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:02:20] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 13:02:31,798 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:02:31] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 13:03:56,506 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:03:56] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-09-29 13:03:57,159 - __main__ - ERROR - Registration failed: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'password_hash'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'role'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'domain'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-29 13:03:57,160 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:03:57] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-09-29 13:05:58,281 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 13:05:58,504 - werkzeug - INFO -  * Restarting with stat
2025-09-29 13:06:00,218 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:06:00,238 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:06:00,995 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:06:01,028 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 13:06:01,089 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2')]
2025-09-29 13:06:01,112 - __main__ - INFO - Added password_hash column
2025-09-29 13:06:01,135 - __main__ - INFO - Added role column
2025-09-29 13:06:01,158 - __main__ - INFO - Added domain column
2025-09-29 13:06:01,181 - __main__ - INFO - Added updated_at column
2025-09-29 13:06:01,207 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:06:01,962 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:06:01,962 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:06:01,962 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:06:01,962 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:06:01,963 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:06:01,963 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:06:01,963 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:06:01,963 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:06:01,979 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 13:06:01,985 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:06:53,208 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:06:53,222 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:06:53,887 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:06:53,909 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 13:06:53,930 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 13:06:53,950 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:06:54,647 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:06:54,647 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:06:54,648 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:06:54,648 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:06:54,648 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:06:54,648 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:06:54,648 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:06:54,648 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:06:55,935 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 13:06:55,935 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 13:06:55,937 - werkzeug - INFO -  * Restarting with stat
2025-09-29 13:06:56,569 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 13:06:56,583 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 13:06:57,244 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 13:06:57,271 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 13:06:57,295 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 13:06:57,319 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 13:06:58,007 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 13:06:58,008 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 13:06:58,008 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 13:06:58,008 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 13:06:58,008 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 13:06:58,008 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 13:06:58,009 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 13:06:58,009 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 13:06:58,016 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 13:06:58,020 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 13:07:03,499 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:03] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-09-29 13:07:04,146 - __main__ - INFO - New user registered: vamsi@gmail.in (ID: 9) - Pending approval
2025-09-29 13:07:04,170 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:04] "POST /api/auth/register HTTP/1.1" 200 -
2025-09-29 13:07:25,155 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:25] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 13:07:25,209 - __main__ - ERROR - Database login error: 'NoneType' object has no attribute 'encode'
2025-09-29 13:07:25,439 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-09-29 13:07:25,476 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:25] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 13:07:25,888 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 13:07:25,913 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:25] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 13:07:26,150 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 13:07:26,238 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 13:07:26] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 13:08:57,288 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 13:08:57,527 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:49:57,740 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:49:57,814 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:49:59,692 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:49:59,758 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:49:59,849 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:49:59,874 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:50:00,574 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:50:00,574 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:50:00,574 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:50:00,574 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:50:00,574 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:50:00,574 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:50:00,575 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:50:00,575 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:50:01,899 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 15:50:01,899 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 15:50:01,901 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:50:02,513 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:50:02,527 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:50:03,195 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:50:03,219 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:50:03,241 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:50:03,262 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:50:03,929 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:50:03,929 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:50:03,929 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:50:03,929 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:50:03,929 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:50:03,930 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:50:03,930 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:50:03,930 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:50:03,937 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:50:03,943 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:51:00,302 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:51:00] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:51:00,962 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:51:00] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 403 -
2025-09-29 15:54:16,830 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 15:54:17,071 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:54:18,205 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:54:18,225 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:54:18,955 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:54:18,989 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:54:19,036 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:54:19,059 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:54:19,822 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:54:19,822 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:54:19,823 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:54:19,823 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:54:19,823 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:54:19,823 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:54:19,823 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:54:19,823 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:54:19,840 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:54:19,847 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:54:27,844 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 15:54:27,978 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:54:28,869 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:54:28,890 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:54:29,424 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:54:29,447 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:54:29,469 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:54:29,490 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:54:30,215 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:54:30,216 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:54:30,216 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:54:30,216 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:54:30,216 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:54:30,217 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:54:30,217 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:54:30,217 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:54:30,226 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:54:30,233 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:54:49,544 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:54:49,558 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:54:50,234 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:54:50,258 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:54:50,281 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:54:50,302 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:54:50,975 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:54:50,975 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:54:50,975 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:54:50,975 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:54:50,976 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:54:50,976 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:54:50,976 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:54:50,976 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:54:52,239 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 15:54:52,239 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 15:54:52,240 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:54:52,870 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:54:52,883 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:54:53,512 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:54:53,535 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:54:53,556 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:54:53,578 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:54:54,290 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:54:54,290 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:54:54,290 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:54:54,290 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:54:54,290 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:54:54,291 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:54:54,291 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:54:54,291 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:54:54,302 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:54:54,309 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:54:57,061 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:54:57] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:54:57,702 - __main__ - INFO - Auto-approved admin user: admin@example.com
2025-09-29 15:54:57,703 - __main__ - INFO - Login successful: admin@example.com (user) - Real database
2025-09-29 15:54:57,735 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:54:57] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:54:57,906 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:54:57] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:54:58,236 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:54:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:56:57,458 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 15:56:57,668 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:56:58,478 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:56:58,500 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:56:59,359 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:56:59,396 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:56:59,432 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:56:59,467 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:57:00,187 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:57:00,187 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:57:00,187 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:57:00,188 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:57:00,188 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:57:00,188 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:57:00,188 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:57:00,188 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:57:00,197 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:57:00,202 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:57:26,389 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 15:57:26,520 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:57:27,362 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:57:27,377 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:57:28,167 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:57:28,194 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:57:28,221 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:57:28,245 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:57:28,965 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:57:28,965 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:57:28,965 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:57:28,965 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:57:28,966 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:57:28,966 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:57:28,966 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:57:28,966 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:57:28,974 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:57:28,980 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:58:15,789 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:58:15,803 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:58:16,760 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:58:16,805 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:58:16,849 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:58:16,893 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:58:17,578 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:58:17,578 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:58:17,578 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:58:17,578 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:58:17,578 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:58:17,578 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:58:17,578 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:58:17,578 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:58:18,848 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 15:58:18,848 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 15:58:18,850 - werkzeug - INFO -  * Restarting with stat
2025-09-29 15:58:19,472 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 15:58:19,486 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 15:58:20,243 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 15:58:20,286 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 15:58:20,346 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 15:58:20,385 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 15:58:21,073 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 15:58:21,073 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 15:58:21,074 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 15:58:21,074 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 15:58:21,074 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 15:58:21,074 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 15:58:21,074 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 15:58:21,074 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 15:58:21,082 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 15:58:21,086 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 15:58:25,953 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 15:58:26,221 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 15:58:26,282 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:58:26,310 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:58:51,272 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:51] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:58:52,138 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:58:52] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-09-29 15:59:03,456 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:03] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:59:04,033 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-29 15:59:04,094 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:04] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 15:59:04,173 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:04] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 15:59:04,490 - __main__ - ERROR - Failed to get users: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-29 15:59:04,499 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:04] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-29 15:59:04,690 - __main__ - ERROR - Failed to get admin stats: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 15:59:04,700 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:04] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:59:05,216 - __main__ - ERROR - Failed to get admin stats: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 15:59:05,227 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:05] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 15:59:47,637 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:47] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-09-29 15:59:48,277 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 15:59:48] "[31m[1mPOST /api/auth/register HTTP/1.1[0m" 409 -
2025-09-29 16:00:12,512 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:12] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:00:13,117 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-29 16:00:13,167 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:13] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:00:13,239 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:13] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:00:13,559 - __main__ - ERROR - Failed to get users: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-29 16:00:13,569 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:13] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-29 16:00:13,697 - __main__ - ERROR - Failed to get admin stats: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:00:13,707 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:00:14,216 - __main__ - ERROR - Failed to get admin stats: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:00:14,228 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:00:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:01:19,716 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 16:01:20,007 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:01:21,120 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:01:21,185 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:01:22,322 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:01:22,350 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:01:22,414 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:01:22,437 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:01:23,177 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:01:23,177 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:01:23,177 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:01:23,177 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:01:23,178 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:01:23,178 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:01:23,178 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:01:23,178 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:01:23,190 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:01:23,197 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:01:34,346 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 16:01:34,509 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:01:35,428 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:01:35,444 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:01:36,229 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:01:36,269 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:01:36,309 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:01:36,346 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:01:37,070 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:01:37,071 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:01:37,071 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:01:37,071 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:01:37,071 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:01:37,071 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:01:37,072 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:01:37,072 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:01:37,082 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:01:37,088 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:01:45,031 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 16:01:45,203 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:01:46,022 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:01:46,041 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:01:46,651 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:01:46,678 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:01:46,705 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:01:46,731 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:01:47,454 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:01:47,455 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:01:47,455 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:01:47,455 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:01:47,455 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:01:47,456 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:01:47,456 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:01:47,456 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:01:47,465 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:01:47,471 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:02:22,017 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 16:02:22,178 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:04:53,059 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:04:53,073 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:04:53,899 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:04:53,942 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:04:53,985 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:04:54,026 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:09:35,844 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:09:35,925 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:09:36,681 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:09:36,705 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:09:36,766 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:09:36,787 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:09:37,482 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:09:37,483 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:09:37,483 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:09:37,483 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:09:37,483 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:09:37,483 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:09:37,483 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:09:37,483 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:09:38,760 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 16:09:38,760 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 16:09:38,762 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:09:39,360 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:09:39,373 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:09:39,981 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:09:40,005 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:09:40,032 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:09:40,051 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:09:40,731 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:09:40,731 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:09:40,731 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:09:40,731 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:09:40,731 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:09:40,732 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:09:40,732 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:09:40,732 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:09:40,739 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:09:40,745 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:09:46,961 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 16:09:47,207 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 16:09:47,298 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-29 16:09:47,304 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:09:47,308 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:47] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:09:47,319 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:47] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:09:47,421 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:09:47,431 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:47] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:09:47,657 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:09:47,667 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:09:47] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:11:06,852 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-29 16:11:07,112 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:11:08,292 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:11:08,318 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:11:08,993 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:11:09,019 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:11:09,043 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:11:09,066 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:11:09,839 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:11:09,839 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:11:09,839 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:11:09,840 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:11:09,840 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:11:09,840 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:11:09,840 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:11:09,840 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:11:09,853 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:11:09,861 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:13:58,017 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 16:13:58,167 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-29 16:13:58,416 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:13:58,427 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:13:58,564 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-29 16:13:58,575 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:13:58,601 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:13:58,613 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:13:58,960 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:13:58,970 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:13:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:26:08,138 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:26:08,153 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:26:09,525 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:26:09,553 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:26:09,621 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:26:09,642 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:26:10,418 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:26:10,419 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:26:10,419 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:26:10,419 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:26:10,419 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:26:10,419 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:26:10,419 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:26:10,419 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:26:11,714 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-29 16:26:11,715 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-29 16:26:11,717 - werkzeug - INFO -  * Restarting with stat
2025-09-29 16:26:12,367 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-29 16:26:12,381 - __main__ - INFO - DuckDB memory tables initialized
2025-09-29 16:26:12,901 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-29 16:26:12,927 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-29 16:26:12,949 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-29 16:26:12,970 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-29 16:26:13,671 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-29 16:26:13,671 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-29 16:26:13,672 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-29 16:26:13,672 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-29 16:26:13,672 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-29 16:26:13,672 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-29 16:26:13,672 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-29 16:26:13,672 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-29 16:26:13,679 - werkzeug - WARNING -  * Debugger is active!
2025-09-29 16:26:13,687 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-29 16:26:42,988 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:42] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 16:26:43,245 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:43] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-29 16:26:57,850 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:57] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:26:58,434 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-29 16:26:58,470 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:58] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:26:58,535 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:26:58,544 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:58] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:26:58,857 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-29 16:26:58,866 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:58] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-29 16:26:58,926 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:26:58,936 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:26:59,357 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:26:59,366 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:26:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:27:10,620 - __main__ - INFO - User approved: ID 9
2025-09-29 16:27:10,653 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:10] "POST /api/admin/users/9/approve HTTP/1.1" 200 -
2025-09-29 16:27:10,833 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:27:10,843 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:10] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:27:11,082 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:27:11,092 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:27:13,975 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:13] "OPTIONS /api/admin/users/9/change-role HTTP/1.1" 200 -
2025-09-29 16:27:14,379 - __main__ - INFO - Role changed: vamsi@gmail.in -> TENANT by admin
2025-09-29 16:27:14,411 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:14] "POST /api/admin/users/9/change-role HTTP/1.1" 200 -
2025-09-29 16:27:14,570 - __main__ - INFO - Admin retrieved 9 users from SQL Fabric
2025-09-29 16:27:14,580 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:14] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-29 16:27:14,836 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-29 16:27:14,845 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:27:22,999 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:22] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-29 16:27:49,150 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:49] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-09-29 16:27:49,765 - __main__ - INFO - New user registered: suku@gmail.in (ID: 10) - Pending approval
2025-09-29 16:27:49,786 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:27:49] "POST /api/auth/register HTTP/1.1" 200 -
2025-09-29 16:28:08,957 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:08] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:28:09,512 - __main__ - INFO - Login successful: vamsi@gmail.in (tenant) - Real database
2025-09-29 16:28:09,549 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:09] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-29 16:28:09,580 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:09] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-29 16:28:09,907 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:09] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-29 16:28:09,963 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:09] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-29 16:28:10,353 - werkzeug - INFO - 127.0.0.1 - - [29/Sep/2025 16:28:10] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 10:45:47,216 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 10:45:47,429 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 10:45:47,581 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:47] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 10:45:47,635 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:47] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 10:45:47,644 - __main__ - ERROR - Failed to get tenant stats: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-09-30 10:45:47,663 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:47] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 10:45:47,997 - __main__ - ERROR - Failed to get tenant stats: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:45:48,008 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:48] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 10:45:52,890 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:45:52] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 10:46:55,408 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:55] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 10:46:55,800 - __main__ - ERROR - Database login error: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:46:56,068 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-09-30 10:46:56,099 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:56] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 10:46:56,199 - __main__ - ERROR - Failed to get users from SQL Fabric: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:46:56,211 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:56] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 10:46:56,508 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:46:56,520 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 10:46:56,537 - __main__ - ERROR - Failed to get users from SQL Fabric: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:46:56,549 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:56] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 10:46:56,860 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 10:46:56,879 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 10:46:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 10:59:46,125 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 10:59:46,214 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 10:59:48,542 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 10:59:48,626 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 10:59:48,719 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 10:59:48,739 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 10:59:49,481 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 10:59:49,481 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 10:59:49,481 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 10:59:49,482 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 10:59:49,482 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 10:59:49,482 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 10:59:49,482 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 10:59:49,482 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 10:59:50,779 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 10:59:50,779 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 10:59:50,781 - werkzeug - INFO -  * Restarting with stat
2025-09-30 10:59:51,528 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 10:59:51,543 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 10:59:52,238 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 10:59:52,262 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 10:59:52,284 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 10:59:52,304 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 10:59:53,002 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 10:59:53,002 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 10:59:53,002 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 10:59:53,002 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 10:59:53,003 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 10:59:53,003 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 10:59:53,003 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 10:59:53,003 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 10:59:53,011 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 10:59:53,019 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 11:00:42,305 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 11:00:42,568 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 11:00:42,662 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-30 11:00:42,673 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:00:42,675 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 11:00:42,689 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:42] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 11:00:42,808 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-30 11:00:42,819 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:00:43,043 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 11:00:43,058 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:43] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 11:00:51,199 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:00:51] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:01:05,120 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:05] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:01:05,743 - __main__ - INFO - Login successful: vamsi@gmail.in (tenant) - Real database
2025-09-30 11:01:05,780 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:05] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:01:05,816 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:05] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:01:06,150 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:06] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:01:06,183 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:01:06,580 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:01:46,304 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:01:46] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:02:02,168 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:02] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:02:03,023 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:03] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-09-30 11:02:13,942 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:13] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:02:14,520 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-30 11:02:14,557 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:14] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:02:14,616 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 11:02:14,627 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:14] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 11:02:14,951 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-30 11:02:14,962 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:14] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 11:02:15,005 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-30 11:02:15,015 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:02:15,448 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-30 11:02:15,458 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:02:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:30:27,803 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:27] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:30:35,536 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:35] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:30:36,180 - __main__ - INFO - Login successful: vamsi@gmail.in (tenant) - Real database
2025-09-30 11:30:36,219 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:36] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:30:36,260 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:36] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:30:36,590 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:36] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:30:36,632 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:30:37,030 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:30:37] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:31:25,205 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:25] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:31:40,487 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:40] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:31:41,054 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-30 11:31:41,092 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:41] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:31:41,130 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 11:31:41,140 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:41] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 11:31:41,459 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-30 11:31:41,469 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:41] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 11:31:41,529 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-30 11:31:41,539 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:31:41,958 - __main__ - ERROR - Failed to get admin stats from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW)")
2025-09-30 11:31:41,968 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:31:55,027 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:31:55] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:32:01,341 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:01] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:32:01,618 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:01] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 403 -
2025-09-30 11:32:13,948 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:13] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:32:14,513 - __main__ - INFO - Login successful: kiran@gmail.com (user) - Real database
2025-09-30 11:32:14,549 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:14] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:32:14,577 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:32:14,897 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:32:14,907 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:14] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 11:32:14,917 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:32:15,256 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_active'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:32:15,267 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:32:15] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 11:43:16,705 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-30 11:43:17,128 - werkzeug - INFO -  * Restarting with stat
2025-09-30 11:43:18,886 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 11:43:18,961 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 11:43:20,490 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 11:43:20,571 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 11:43:20,644 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 11:43:20,666 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 11:43:21,427 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 11:43:21,428 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 11:43:21,428 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 11:43:21,428 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 11:43:21,428 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 11:43:21,428 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 11:43:21,429 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 11:43:21,429 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 11:43:21,447 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 11:43:21,454 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 11:44:48,786 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-30 11:44:49,043 - werkzeug - INFO -  * Restarting with stat
2025-09-30 11:44:49,890 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 11:44:49,904 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 11:44:50,628 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 11:44:50,652 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 11:44:50,677 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 11:44:50,697 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 11:44:51,630 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 11:44:51,630 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 11:44:51,630 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 11:44:51,630 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 11:44:51,631 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 11:44:51,631 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 11:44:51,631 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 11:44:51,631 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 11:44:51,645 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 11:44:51,653 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 11:45:06,451 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-30 11:45:06,584 - werkzeug - INFO -  * Restarting with stat
2025-09-30 11:45:07,930 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 11:45:07,957 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 11:45:08,841 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 11:45:08,868 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 11:45:08,892 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 11:45:08,915 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 11:45:09,716 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 11:45:09,717 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 11:45:09,717 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 11:45:09,717 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 11:45:09,717 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 11:45:09,718 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 11:45:09,718 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 11:45:09,718 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 11:45:09,733 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 11:45:09,743 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 11:45:20,061 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 11:45:20,080 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 11:45:20,814 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 11:45:20,836 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 11:45:21,187 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 11:45:21,207 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 11:45:22,057 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 11:45:22,058 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 11:45:22,058 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 11:45:22,059 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 11:45:22,059 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 11:45:22,059 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 11:45:22,059 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 11:45:22,060 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 11:45:23,385 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 11:45:23,385 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 11:45:23,387 - werkzeug - INFO -  * Restarting with stat
2025-09-30 11:45:24,132 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 11:45:24,147 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 11:45:25,056 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 11:45:25,103 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 11:45:25,149 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 11:45:25,194 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 11:45:26,846 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 11:45:26,846 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 11:45:26,846 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 11:45:26,846 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 11:45:26,846 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 11:45:26,847 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 11:45:26,847 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 11:45:26,847 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 11:45:26,860 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 11:45:26,873 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 11:45:47,041 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:45:47] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 11:45:47,281 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:45:47] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 11:46:05,083 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:05] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:05,693 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-30 11:46:05,753 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:05] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:05,839 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 11:46:05,849 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:05] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 11:46:06,167 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-30 11:46:06,176 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:06] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 11:46:06,347 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 10, 'pending_approvals': 3, 'total_validations': 0, 'total_templates': 78, 'role_distribution': {'admin': 1, 'tenant': 1, 'user': 8}, 'system_status': 'operational', 'active_tenants': 1}
2025-09-30 11:46:06,357 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:06,899 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 10, 'pending_approvals': 3, 'total_validations': 0, 'total_templates': 78, 'role_distribution': {'admin': 1, 'tenant': 1, 'user': 8}, 'system_status': 'operational', 'active_tenants': 1}
2025-09-30 11:46:06,910 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:13,478 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:13] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:46:19,085 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:19] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:19,370 - __main__ - INFO - Login successful: vamsi@gmail.in (tenant) - Real database
2025-09-30 11:46:19,428 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:19] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:19,762 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:19] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:46:19,899 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:19] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:20,031 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:20] "[31m[1mGET /api/admin/users HTTP/1.1[0m" 403 -
2025-09-30 11:46:20,228 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:20] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:48,276 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:48] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 11:46:57,968 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:57] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:58,586 - __main__ - INFO - Login successful: kiran@gmail.com (user) - Real database
2025-09-30 11:46:58,648 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:58] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 11:46:58,730 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:59,057 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:46:59,074 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:46:59,084 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:59] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 11:46:59,443 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:46:59,452 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:46:59] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 11:52:29,320 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 11:52:29,528 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 11:52:29,681 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:29] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:52:29,709 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:29] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 11:52:29,739 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:52:29,752 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:29] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 11:52:30,027 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 11:52:30,040 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 11:52:30] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:01:08,246 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:01:08,469 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:01:08,577 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:01:08,624 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:01:08,658 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:01:08,668 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:01:08,912 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:01:08,922 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:08] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:01:16,462 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:16] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 12:01:27,582 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:01:27,596 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:01:29,025 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:01:29,071 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:01:29,165 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:01:29,207 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:01:29,920 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:01:29,920 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:01:29,920 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:01:29,920 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:01:29,920 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:01:29,921 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:01:29,921 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:01:29,921 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:01:31,214 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 12:01:31,214 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 12:01:31,216 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:01:31,818 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:01:31,831 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:01:32,469 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:01:32,495 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:01:32,519 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:01:32,542 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:01:33,290 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:01:33,291 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:01:33,291 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:01:33,291 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:01:33,291 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:01:33,291 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:01:33,291 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:01:33,291 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:01:33,299 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:01:33,307 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:01:42,386 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:42] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:01:42,961 - __main__ - INFO - Login successful: kiran@gmail.com (user) - Real database
2025-09-30 12:01:43,000 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:43] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:01:43,027 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:01:43,352 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:01:43,364 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:43] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:01:43,368 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:01:43,700 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:01:43,710 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:01:43] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:04:36,186 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:04:36] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:04:36,411 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:04:36] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:04:45,857 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:04:45] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:05:02,588 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:05:02] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:05:11,624 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:05:11] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:05:13,483 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:05:13] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:05:14,149 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:05:14] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:06:40,676 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:06:40,766 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:06:41,635 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:06:41,663 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:06:41,688 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:06:41,712 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:06:42,624 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:06:42,625 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:06:42,625 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:06:42,625 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:06:42,625 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:06:42,625 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:06:42,626 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:06:42,626 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:06:43,948 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 12:06:43,948 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 12:06:43,950 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:06:44,669 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:06:44,688 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:06:45,608 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:06:45,632 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:06:45,654 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:06:45,674 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:06:46,385 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:06:46,385 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:06:46,386 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:06:46,386 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:06:46,386 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:06:46,386 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:06:46,386 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:06:46,386 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:06:46,399 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:06:46,406 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:07:07,209 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:07] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:07:07,439 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:07] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:07:17,296 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:17] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:07:17,881 - __main__ - INFO - Login successful: kiran@gmail.com (user) - Real database
2025-09-30 12:07:17,917 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:17] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:07:17,983 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:17] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:07:18,307 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:07:18,308 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:07:18,320 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:18] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:07:18,671 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:07:18,681 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:07:18] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:17:15,799 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:17:15,885 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:17:17,356 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:17:17,381 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:17:17,456 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:17:17,476 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:17:18,149 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:17:18,149 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:17:18,150 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:17:18,150 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:17:18,150 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:17:18,150 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:17:18,150 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:17:18,150 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:17:19,442 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 12:17:19,442 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 12:17:19,444 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:17:20,085 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:17:20,099 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:17:20,960 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:17:20,983 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:17:21,006 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:17:21,027 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:17:21,706 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:17:21,707 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:17:21,707 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:17:21,707 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:17:21,707 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:17:21,707 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:17:21,707 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:17:21,707 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:17:21,714 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:17:21,722 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:27:34,078 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:27:34,105 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:27:35,369 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:27:35,396 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:27:35,464 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:27:35,487 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:27:36,221 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:27:36,221 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:27:36,222 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:27:36,222 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:27:36,222 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:27:36,222 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:27:36,222 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:27:36,222 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:27:37,525 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 12:27:37,525 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 12:27:37,527 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:27:38,228 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:27:38,243 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:27:38,949 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:27:38,988 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:27:39,009 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:27:39,029 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:27:39,723 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:27:39,723 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:27:39,723 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:27:39,723 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:27:39,723 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:27:39,723 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:27:39,724 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:27:39,724 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:27:39,732 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:27:39,737 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:27:49,058 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:49] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:27:49,381 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:49] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 12:27:51,897 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:51] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:27:52,474 - __main__ - INFO - Login successful: kiran@gmail.com (user) - Real database
2025-09-30 12:27:52,510 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:52] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 12:27:52,590 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:27:52,912 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:27:52,922 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:52] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:27:52,934 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:27:53,274 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-09-30 12:27:53,283 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:27:53] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:36:08,437 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-09-30 12:36:08,876 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:36:10,091 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:36:10,197 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:36:11,048 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:36:11,074 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:36:11,144 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:36:11,165 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:36:11,960 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:36:11,960 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:36:11,960 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:36:11,960 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:36:11,960 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:36:11,961 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:36:11,961 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:36:11,961 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:36:11,974 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:36:11,985 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:36:43,555 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:36:43,569 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:36:44,317 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:36:44,343 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:36:44,364 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:36:44,385 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:36:45,069 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:36:45,069 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:36:45,069 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:36:45,069 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:36:45,069 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:36:45,069 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:36:45,070 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:36:45,070 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:36:46,338 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 12:36:46,339 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 12:36:46,340 - werkzeug - INFO -  * Restarting with stat
2025-09-30 12:36:46,939 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 12:36:46,953 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 12:36:47,708 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 12:36:47,731 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 12:36:47,753 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 12:36:47,774 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 12:36:48,453 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 12:36:48,453 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 12:36:48,454 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 12:36:48,454 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 12:36:48,454 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 12:36:48,454 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 12:36:48,454 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 12:36:48,454 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 12:36:48,461 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 12:36:48,466 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 12:36:51,893 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:36:52,144 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:36:52,224 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:36:52,280 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:36:52,297 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:36:52,309 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:52] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:36:52,567 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:36:52,578 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:36:52] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:48:05,276 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:48:05,505 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:48:05,609 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:48:05,639 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:48:05,668 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:48:05,680 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:48:05,954 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:48:05,965 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:48:05] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:51:52,204 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:51:52,429 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 12:51:52,535 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:51:52,569 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 12:51:52,599 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:51:52,610 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 12:51:52,885 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 12:51:52,897 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 12:51:52] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:22:03,575 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 13:22:03,644 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 13:22:05,370 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 13:22:05,432 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 13:22:05,514 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 13:22:05,557 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 13:22:06,256 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 13:22:06,256 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 13:22:06,256 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 13:22:06,256 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 13:22:06,256 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 13:22:06,256 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 13:22:06,257 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 13:22:06,257 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 13:22:07,563 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 13:22:07,564 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 13:22:07,566 - werkzeug - INFO -  * Restarting with stat
2025-09-30 13:22:08,214 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 13:22:08,230 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 13:22:09,058 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 13:22:09,104 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 13:22:09,147 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 13:22:09,190 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 13:22:09,879 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 13:22:09,880 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 13:22:09,880 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 13:22:09,880 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 13:22:09,880 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 13:22:09,880 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 13:22:09,880 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 13:22:09,880 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 13:22:09,890 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 13:22:09,899 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 13:22:15,247 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:22:15,490 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:22:15,582 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:22:15,607 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:22:15,644 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:22:15,655 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:22:15,946 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:22:15,956 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:22:15] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:27:50,007 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:27:50,243 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:27:50,351 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:27:50,398 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:27:50,448 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:27:50,458 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:27:50,718 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:27:50,729 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:27:50] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:31:31,136 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:31:31,369 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:31:31,476 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:31:31,497 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:31:31,517 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:31:31,527 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:31:31,874 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:31:31,886 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:31:31] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:37:27,334 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:37:27,577 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 13:37:27,666 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:27] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:37:27,706 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:27] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 13:37:27,732 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:37:27,745 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:27] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 13:37:28,010 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 13:37:28,021 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 13:37:28] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 14:33:53,894 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 14:33:54,103 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 14:33:54,236 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 14:33:54,270 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 14:33:54,276 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-09-30 14:33:54,287 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:54] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 14:33:54,558 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-09-30 14:33:54,567 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 14:33:54] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 15:34:51,669 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 15:34:51,775 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 15:34:54,062 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 15:34:54,168 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 15:34:54,273 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 15:34:54,369 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 15:34:55,540 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 15:34:55,541 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 15:34:55,541 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 15:34:55,541 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 15:34:55,542 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 15:34:55,542 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 15:34:55,542 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 15:34:55,542 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 15:34:56,872 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 15:34:56,873 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 15:34:56,875 - werkzeug - INFO -  * Restarting with stat
2025-09-30 15:34:58,006 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 15:34:58,029 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 15:34:59,802 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 15:34:59,906 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 15:35:00,002 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 15:35:00,105 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 15:35:01,203 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 15:35:01,203 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 15:35:01,203 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 15:35:01,203 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 15:35:01,204 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 15:35:01,204 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 15:35:01,204 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 15:35:01,205 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 15:35:01,219 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 15:35:01,247 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 15:36:53,438 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:36:53] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 15:36:53,661 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:36:53] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-09-30 15:37:13,635 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:13] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 15:37:14,536 - __main__ - INFO - Login successful: admin@example.com (admin) - Real database
2025-09-30 15:37:14,692 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:14] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 15:37:14,870 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 15:37:14,880 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:14] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 15:37:15,216 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-09-30 15:37:15,226 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:15] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-09-30 15:37:15,587 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 10, 'pending_approvals': 3, 'total_validations': 0, 'total_templates': 78, 'role_distribution': {'admin': 1, 'tenant': 1, 'user': 8}, 'system_status': 'operational', 'active_tenants': 1}
2025-09-30 15:37:15,599 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 15:37:16,155 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 10, 'pending_approvals': 3, 'total_validations': 0, 'total_templates': 78, 'role_distribution': {'admin': 1, 'tenant': 1, 'user': 8}, 'system_status': 'operational', 'active_tenants': 1}
2025-09-30 15:37:16,165 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:16] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 15:37:35,618 - __main__ - INFO - User approved: ID 4
2025-09-30 15:37:35,670 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:35] "POST /api/admin/users/4/approve HTTP/1.1" 200 -
2025-09-30 15:37:35,805 - __main__ - INFO - Admin retrieved 10 users from SQL Fabric
2025-09-30 15:37:35,815 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:35] "GET /api/admin/users HTTP/1.1" 200 -
2025-09-30 15:37:36,587 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 10, 'pending_approvals': 2, 'total_validations': 0, 'total_templates': 78, 'role_distribution': {'admin': 1, 'tenant': 1, 'user': 8}, 'system_status': 'operational', 'active_tenants': 1}
2025-09-30 15:37:36,596 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:37:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 15:38:07,035 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:07] "POST /api/auth/logout HTTP/1.1" 200 -
2025-09-30 15:38:16,295 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:16] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-09-30 15:38:17,181 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-09-30 15:38:17,349 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:17] "POST /api/auth/login HTTP/1.1" 200 -
2025-09-30 15:38:17,543 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 15:38:17,556 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:17] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 15:38:17,757 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:17] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 15:38:17,990 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 15:38:18,000 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:17] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 15:38:18,104 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 15:38:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 17:05:49,181 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 17:05:49,247 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 17:05:50,723 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 17:05:50,796 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 17:05:50,894 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 17:05:50,915 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 17:05:51,634 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 17:05:51,634 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 17:05:51,634 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 17:05:51,634 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 17:05:51,635 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 17:05:51,635 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 17:05:51,635 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 17:05:51,635 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 17:05:52,929 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-09-30 17:05:52,929 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-09-30 17:05:52,931 - werkzeug - INFO -  * Restarting with stat
2025-09-30 17:05:53,534 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-09-30 17:05:53,546 - __main__ - INFO - DuckDB memory tables initialized
2025-09-30 17:05:54,165 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-09-30 17:05:54,187 - __main__ - INFO - Existing tables: ['file_data_80f27263_5ced_4d7e_91c2_cc4bf0e00541', 'BuildVersion', 'ErrorLog', 'validation_corrections', 'file_data_83a02048_b150_4340_af27_c108f786eb21', 'file_data_f61f6e43_bb4d_4493_a278_d7ca6d50e5b7', 'file_data_8ca0f1b0_bbcd_4bc7_8825_bf128679e890', 'file_data_442321eb_b820_48c3_9e0c_ae83bcef9131', 'file_data_491d2101_ce1d_4386_aa42_dc2eec25dae5', 'validation_sessions', 'file_data_9266d405_b7aa_4c50_bf70_3bde3bd7155f', 'file_data_e3214f73_cff7_4055_8620_b9b5b19316db', 'validation_errors', 'file_data_a7fbc703_a34e_431e_abe3_3edfc0e96517', 'file_data_2e86c48a_f298_4c02_868b_785083d6433c', 'file_data_e5d5d09d_16df_4c25_9030_56c1f5745a8e', 'file_data_b2d695c9_c7ff_4c05_8817_3c10492c3306', 'file_data_f946047b_6eab_417d_a25e_25e9a64842bb', 'file_data_31c490c4_d93a_4929_86ac_8981c285ddaa', 'file_data_f47ff664_928c_496d_b846_361227c19001', 'file_data_d4b9523d_83c8_4d51_ab06_07ccfa6b053b', 'file_data_b2b1001e_742b_4fee_abe8_4d3d1390deb1', 'file_data_128b0060_0ab0_469e_acb1_20abf9bbfdb1', 'file_data_475558d5_3df7_4e01_ba24_83edcb905291', 'file_data_499fcd34_fb27_48e4_bdc5_867cb47c7864', 'file_data_c4e8bd69_aa8b_4b2d_b14c_cc2b3abfde0b', 'file_data_baa99913_4314_4e8a_8a36_943d8cc3efd0', 'roles', 'file_data_894c4f69_c71e_4ea1_b3c6_1b5bd0e6f29c', 'file_data_969b7eb0_76b4_43dc_b494_ccdea566b68d', 'users', 'file_data_abc72ce7_9d3f_46d9_9eef_d1fc49d23b3c', 'column_validation', 'Address', 'login_details', 'Product', 'excel_templates', 'SalesOrderDetail', 'column_validations', 'ProductModelProductDescription', 'SalesOrderHeader', 'file_data_066af03c_7f4c_40fc_a67c_4c6d08c7bf48', 'template_columns', 'Customer', 'ProductDescription', 'validation_rule_types', 'ProductModel', 'column_validation_rules', 'CustomerAddress', 'ProductCategory', 'validation_history']
2025-09-30 17:05:54,210 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('is_approved', 'bit'), ('created_at', 'datetime2'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('updated_at', 'datetime')]
2025-09-30 17:05:54,229 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-09-30 17:05:54,930 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-09-30 17:05:54,931 - __main__ - INFO - DuckDB Analytics: Enabled
2025-09-30 17:05:54,931 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-09-30 17:05:54,931 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-09-30 17:05:54,931 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-09-30 17:05:54,931 - __main__ - INFO - Data Validation: 3-step workflow
2025-09-30 17:05:54,931 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-09-30 17:05:54,932 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-09-30 17:05:54,939 - werkzeug - WARNING -  * Debugger is active!
2025-09-30 17:05:54,948 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-09-30 17:06:36,540 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 17:06:36,794 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-09-30 17:06:36,871 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 17:06:36,946 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-09-30 17:06:36,980 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 17:06:36,987 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:36] "GET /api/templates HTTP/1.1" 200 -
2025-09-30 17:06:37,222 - __main__ - INFO - Fetched 78 templates from SQL Fabric
2025-09-30 17:06:37,239 - werkzeug - INFO - 127.0.0.1 - - [30/Sep/2025 17:06:37] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 10:26:28,700 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 10:26:28,750 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 10:26:29,117 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:29] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 10:26:29,138 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-01 10:26:29,151 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:29] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 10:26:29,375 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:29] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 10:26:29,456 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-01 10:26:29,469 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:26:29] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 10:48:22,043 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 10:48:22,113 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 10:48:22,526 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 10:48:22,532 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-01 10:48:22,544 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 10:48:22,780 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 10:48:22,865 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-01 10:48:22,877 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 10:48:22] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 11:57:04,468 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 11:57:04,528 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 11:57:05,722 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 11:57:05,751 - __main__ - INFO - Existing tables: ['Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 11:57:05,774 - __main__ - INFO - Created login_details table
2025-10-01 11:57:05,796 - __main__ - INFO - Created excel_templates table
2025-10-01 11:57:05,821 - __main__ - INFO - Created validation_sessions table
2025-10-01 11:57:05,844 - __main__ - INFO - Created validation_errors table
2025-10-01 11:57:05,871 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 11:57:06,594 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 11:57:06,594 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 11:57:06,594 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 11:57:06,594 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 11:57:06,594 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 11:57:06,595 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 11:57:06,595 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 11:57:06,595 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 11:57:07,905 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 11:57:07,905 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 11:57:07,909 - werkzeug - INFO -  * Restarting with stat
2025-10-01 11:57:08,544 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 11:57:08,561 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 11:57:09,180 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 11:57:09,202 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 11:57:09,250 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 11:57:09,270 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 11:57:09,992 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 11:57:09,992 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 11:57:09,992 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 11:57:09,992 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 11:57:09,992 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 11:57:09,992 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 11:57:09,993 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 11:57:09,993 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 11:57:10,000 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 11:57:10,009 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 11:57:23,097 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 11:57:23,332 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 11:57:23,432 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 11:57:23,493 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 11:57:23,507 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'template_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'template_name'. (207)")
2025-10-01 11:57:23,515 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 11:57:23,782 - __main__ - ERROR - Failed to get templates: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'template_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'template_name'. (207)")
2025-10-01 11:57:23,788 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:23] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 11:57:25,551 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:25] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-01 11:57:43,830 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:43] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 11:57:44,184 - __main__ - ERROR - Database login error: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'password'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 11:57:44,406 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-10-01 11:57:44,416 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:44] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 11:57:44,465 - __main__ - INFO - Admin retrieved 0 users from SQL Fabric
2025-10-01 11:57:44,473 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:44] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-01 11:57:44,791 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-01 11:57:44,797 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:44] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-10-01 11:57:44,901 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 0, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 11:57:44,907 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:44] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 11:57:45,323 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 0, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 11:57:45,332 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 11:57:51,016 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 11:57:51] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-01 12:00:02,759 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:00:02,819 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:00:03,618 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:00:03,641 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:00:03,703 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:00:03,724 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:00:04,431 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:00:04,431 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:00:04,431 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:00:04,432 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:00:04,432 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:00:04,432 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:00:04,432 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:00:04,432 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:00:05,711 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:00:05,712 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:00:05,713 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:00:06,317 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:00:06,331 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:00:06,962 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:00:06,984 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:00:07,010 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:00:07,030 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:00:07,740 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:00:07,740 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:00:07,740 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:00:07,740 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:00:07,740 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:00:07,740 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:00:07,741 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:00:07,741 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:00:07,748 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:00:07,754 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:00:53,674 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app.py', reloading
2025-10-01 12:00:53,870 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:00:55,225 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:00:55,251 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:00:56,116 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:00:56,139 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:00:56,162 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:00:56,183 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:00:56,969 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:00:56,969 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:00:56,969 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:00:56,969 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:00:56,970 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:00:56,970 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:00:56,970 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:00:56,970 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:00:56,984 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:00:56,992 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:14:02,227 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:14:03,637 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:14:05,361 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:14:05,449 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:14:06,811 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:14:06,834 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:14:06,871 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:14:06,891 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:14:07,651 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:14:07,651 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:14:07,651 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:14:07,651 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:14:07,651 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:14:07,652 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:14:07,652 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:14:07,652 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:14:07,664 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:14:07,673 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:14:51,166 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:14:51,370 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:14:52,553 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:14:52,574 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:14:53,190 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:14:53,211 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:14:53,233 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:14:53,253 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:14:54,039 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:14:54,039 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:14:54,039 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:14:54,039 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:14:54,039 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:14:54,040 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:14:54,040 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:14:54,040 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:14:54,053 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:14:54,060 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:15:06,250 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:15:06,409 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:15:07,386 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:15:07,406 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:15:08,054 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:15:08,076 - __main__ - INFO - Existing tables: ['login_details', 'excel_templates', 'validation_sessions', 'validation_errors', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:15:08,097 - __main__ - INFO - Current login_details columns: [('id', 'int'), ('email', 'varchar'), ('password_hash', 'varchar'), ('first_name', 'varchar'), ('last_name', 'varchar'), ('role', 'varchar'), ('is_approved', 'bit'), ('domain', 'varchar'), ('created_at', 'datetime'), ('updated_at', 'datetime')]
2025-10-01 12:15:08,116 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:15:08,865 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:15:08,865 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:15:08,866 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:15:08,866 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:15:08,866 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:15:08,866 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:15:08,866 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:15:08,866 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:15:08,878 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:15:08,886 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:25:59,750 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:25:59,819 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:26:01,037 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:26:01,060 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:26:01,099 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar')]
2025-10-01 12:26:01,122 - __main__ - INFO - Added password_hash column
2025-10-01 12:26:01,146 - __main__ - INFO - Added role column
2025-10-01 12:26:01,171 - __main__ - INFO - Added domain column
2025-10-01 12:26:01,195 - __main__ - INFO - Added is_approved column
2025-10-01 12:26:01,218 - __main__ - INFO - Added updated_at column
2025-10-01 12:26:01,246 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:26:01,964 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:26:01,965 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:26:01,965 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:26:01,965 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:26:01,965 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:26:01,965 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:26:01,966 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:26:01,966 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:26:03,254 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:26:03,254 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:26:03,256 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:26:03,851 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:26:03,864 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:26:04,407 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:26:04,429 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:26:04,450 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:26:04,469 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:26:05,148 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:26:05,148 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:26:05,149 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:26:05,149 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:26:05,149 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:26:05,149 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:26:05,149 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:26:05,149 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:26:05,156 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:26:05,161 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:27:11,514 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:11] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 12:27:11,917 - __main__ - ERROR - Database login error: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 12:27:12,135 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-10-01 12:27:12,156 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:12] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 12:27:12,227 - __main__ - ERROR - Failed to get users from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW)")
2025-10-01 12:27:12,234 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:12] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-10-01 12:27:12,560 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-01 12:27:12,567 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:12] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-10-01 12:27:12,620 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 0, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 12:27:12,627 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 12:27:13,044 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 0, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 12:27:13,051 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 12:27:17,852 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:17] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-01 12:27:38,561 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:38] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:27:38,895 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:38] "[31m[1mPOST /api/auth/register HTTP/1.1[0m" 400 -
2025-10-01 12:27:44,789 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:44] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:27:44,811 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:27:44] "[31m[1mPOST /api/auth/register HTTP/1.1[0m" 400 -
2025-10-01 12:32:28,335 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:32:28] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:32:28,534 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:32:28] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:32:51,111 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:32:51] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:32:51,440 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:32:51] "[31m[1mPOST /api/auth/register HTTP/1.1[0m" 400 -
2025-10-01 12:38:31,142 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:38:31,608 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:38:32,913 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:38:32,933 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:38:35,072 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:38:35,096 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:38:35,164 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:38:35,185 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:38:35,957 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:38:35,958 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:38:35,958 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:38:35,958 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:38:35,958 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:38:35,958 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:38:35,958 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:38:35,959 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:38:35,971 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:38:35,977 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:38:42,605 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:38:42,751 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:38:43,615 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:38:43,635 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:38:44,221 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:38:44,244 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:38:44,265 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:38:44,285 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:38:45,006 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:38:45,006 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:38:45,007 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:38:45,007 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:38:45,007 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:38:45,007 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:38:45,007 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:38:45,007 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:38:45,015 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:38:45,020 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:38:49,730 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:38:49,923 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:38:50,848 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:38:50,865 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:38:51,381 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:38:51,403 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:38:51,424 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:38:51,444 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:38:52,176 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:38:52,176 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:38:52,177 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:38:52,177 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:38:52,177 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:38:52,177 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:38:52,177 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:38:52,177 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:38:52,186 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:38:52,192 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:41:40,161 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:41:40,176 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:41:40,847 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:41:40,869 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:41:40,890 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:41:40,911 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:41:41,618 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:41:41,618 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:41:41,618 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:41:41,618 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:41:41,618 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:41:41,619 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:41:41,619 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:41:41,619 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:41:42,918 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:41:42,918 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:41:42,920 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:41:43,570 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:41:43,583 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:41:44,492 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:41:44,515 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:41:44,537 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:41:44,557 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:41:45,241 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:41:45,241 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:41:45,241 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:41:45,241 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:41:45,241 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:41:45,241 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:41:45,242 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:41:45,242 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:41:45,248 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:41:45,256 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:41:49,811 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:41:49] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:41:50,052 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:41:50] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:42:04,096 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:42:04] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:42:04,674 - __main__ - INFO - Registering user: email=vamsi@gmail.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:42:04,725 - __main__ - ERROR - Data attempted: email=vamsi@gmail.com, first_name=vamsi, last_name=ade
2025-10-01 12:42:04,725 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:42:04] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-10-01 12:43:44,885 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 12:43:45,216 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:43:46,665 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:43:46,681 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:43:47,496 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:43:47,528 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:43:47,550 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:43:47,570 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:43:48,325 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:43:48,325 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:43:48,325 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:43:48,325 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:43:48,326 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:43:48,326 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:43:48,326 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:43:48,326 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:43:48,341 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:43:48,351 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:46:21,740 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:46:21,754 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:46:22,461 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:46:22,484 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:46:22,557 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:46:22,578 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:46:23,252 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:46:23,252 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:46:23,252 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:46:23,252 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:46:23,253 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:46:23,253 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:46:23,253 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:46:23,253 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:46:24,542 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:46:24,543 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:46:24,544 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:46:25,144 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:46:25,158 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:46:25,943 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:46:25,986 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:46:26,027 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:46:26,067 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:46:26,764 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:46:26,765 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:46:26,765 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:46:26,765 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:46:26,765 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:46:26,765 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:46:26,766 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:46:26,766 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:46:26,773 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:46:26,778 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:46:31,202 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:46:31] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:46:31,791 - __main__ - INFO - Registering user: email=vamsi@gmail.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:46:31,832 - __main__ - ERROR - [ERROR] Registration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.login_details'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 12:46:31,833 - __main__ - ERROR - Data attempted: email=vamsi@gmail.com, first_name=vamsi, last_name=ade
2025-10-01 12:46:31,872 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:46:31] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-10-01 12:53:41,504 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:53:41,578 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:53:43,005 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:53:43,029 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:53:43,050 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:53:43,071 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:53:43,754 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:53:43,754 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:53:43,754 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:53:43,754 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:53:43,754 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:53:43,754 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:53:43,755 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:53:43,755 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:53:45,028 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:53:45,028 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:53:45,030 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:53:45,636 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:53:45,649 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:53:46,261 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:53:46,284 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'login_details', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:53:46,306 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:53:46,326 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:53:46,997 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:53:46,997 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:53:46,997 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:53:46,998 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:53:46,998 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:53:46,998 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:53:46,998 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:53:46,998 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:53:47,005 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:53:47,013 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:53:51,214 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:53:51] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:53:51,811 - __main__ - INFO - Registering user: email=vamsi@gmail.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:53:51,857 - __main__ - ERROR - [ERROR] Registration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.login_details'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 12:53:51,857 - __main__ - ERROR - Data attempted: email=vamsi@gmail.com, first_name=vamsi, last_name=ade
2025-10-01 12:53:51,902 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:53:51] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-10-01 12:53:54,923 - __main__ - INFO - Registering user: email=vamsi@gmail.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:53:54,968 - __main__ - ERROR - [ERROR] Registration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.login_details'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 12:53:54,969 - __main__ - ERROR - Data attempted: email=vamsi@gmail.com, first_name=vamsi, last_name=ade
2025-10-01 12:53:55,013 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:53:55] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-10-01 12:53:56,161 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:53:56] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:53:56,484 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:53:56] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:54:15,890 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:54:15] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:54:16,455 - __main__ - INFO - Registering user: email=vamsi@email.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:54:16,477 - __main__ - ERROR - [ERROR] Registration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.login_details'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 12:54:16,477 - __main__ - ERROR - Data attempted: email=vamsi@email.com, first_name=vamsi, last_name=ade
2025-10-01 12:54:16,499 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:54:16] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 500 -
2025-10-01 12:59:09,959 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:59:09,976 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:59:10,598 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:59:10,625 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:59:10,668 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:59:10,688 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:59:11,372 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:59:11,372 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:59:11,372 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:59:11,372 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:59:11,372 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:59:11,373 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:59:11,373 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:59:11,373 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:59:12,655 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 12:59:12,656 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 12:59:12,658 - werkzeug - INFO -  * Restarting with stat
2025-10-01 12:59:13,265 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 12:59:13,280 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 12:59:13,855 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 12:59:13,878 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 12:59:13,901 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 12:59:13,923 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 12:59:14,621 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 12:59:14,622 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 12:59:14,622 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 12:59:14,622 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 12:59:14,622 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 12:59:14,622 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 12:59:14,622 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 12:59:14,623 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 12:59:14,630 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 12:59:14,638 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 12:59:19,701 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:19] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:59:19,957 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:19] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 12:59:37,149 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:37] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-01 12:59:37,712 - __main__ - INFO - Registering user: email=vamsi@gmail.com, first_name=vamsi, last_name=ade, phone=
2025-10-01 12:59:37,761 - __main__ - INFO - [SUCCESS] User registered successfully: vamsi@gmail.com (ID: 1) - Pending approval
2025-10-01 12:59:37,782 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:37] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 201 -
2025-10-01 12:59:55,864 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:55] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 12:59:56,207 - __main__ - ERROR - Database login error: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 12:59:56,421 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-10-01 12:59:56,431 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:56] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 12:59:56,482 - __main__ - ERROR - Failed to get users from SQL Fabric: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207) (SQLExecDirectW)")
2025-10-01 12:59:56,489 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:56] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-10-01 12:59:56,803 - __main__ - ERROR - Failed to get users from SQL Fabric: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-01 12:59:56,810 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:56] "[35m[1mGET /api/admin/users HTTP/1.1[0m" 500 -
2025-10-01 12:59:56,910 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 12:59:56,921 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 12:59:57,348 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 12:59:57,355 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 12:59:57] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:02:04,849 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:02:05,428 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:02:07,355 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:02:07,540 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:02:08,384 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:02:08,409 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:02:08,430 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:02:08,464 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:02:09,254 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:02:09,254 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:02:09,254 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:02:09,254 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:02:09,254 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:02:09,254 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:02:09,255 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:02:09,255 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:02:09,267 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:02:09,279 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:02:12,409 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:02:12,606 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:02:13,660 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:02:13,678 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:02:14,497 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:02:14,523 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:02:14,546 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:02:14,567 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:02:15,305 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:02:15,306 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:02:15,306 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:02:15,306 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:02:15,306 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:02:15,306 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:02:15,306 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:02:15,307 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:02:15,318 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:02:15,324 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:02:26,965 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:02:27,142 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:02:28,113 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:02:28,132 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:02:28,809 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:02:28,832 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:02:28,853 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:02:28,879 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:02:29,598 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:02:29,598 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:02:29,598 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:02:29,599 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:02:29,599 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:02:29,599 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:02:29,599 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:02:29,599 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:02:29,608 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:02:29,613 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:02:34,390 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:02:34,588 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:02:35,544 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:02:35,566 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:02:36,193 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:02:36,215 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:02:36,236 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:02:36,256 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:02:36,995 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:02:36,996 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:02:36,996 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:02:36,996 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:02:36,996 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:02:36,996 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:02:36,997 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:02:36,997 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:02:37,005 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:02:37,013 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:02:46,653 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:02:46,868 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:02:47,845 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:02:47,862 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:02:48,485 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:02:48,520 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:02:48,549 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:02:48,571 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:02:49,350 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:02:49,350 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:02:49,350 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:02:49,350 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:02:49,350 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:02:49,351 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:02:49,351 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:02:49,351 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:02:49,360 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:02:49,367 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:03:25,303 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:03:25,318 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:03:26,028 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:03:26,050 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:03:26,071 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:03:26,090 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:03:26,824 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:03:26,824 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:03:26,824 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:03:26,824 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:03:26,825 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:03:26,825 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:03:26,825 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:03:26,825 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:03:28,105 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 13:03:28,105 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 13:03:28,107 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:03:28,912 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:03:28,945 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:03:29,674 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:03:29,698 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:03:29,721 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:03:29,742 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:03:30,528 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:03:30,529 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:03:30,529 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:03:30,529 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:03:30,529 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:03:30,529 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:03:30,529 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:03:30,530 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:03:30,543 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:03:30,555 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:03:33,436 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:03:33,692 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:03:33,890 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 13:03:33,897 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:33] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:03:34,018 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 13:03:34,025 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:03:34,231 - __main__ - INFO - Admin retrieved 1 users from SQL Fabric
2025-10-01 13:03:34,239 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:34] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-01 13:03:34,671 - __main__ - INFO - Admin retrieved 1 users from SQL Fabric
2025-10-01 13:03:34,681 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:34] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-01 13:03:38,781 - __main__ - INFO - User approved: ID 1
2025-10-01 13:03:38,809 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:38] "POST /api/admin/users/1/approve HTTP/1.1" 200 -
2025-10-01 13:03:39,051 - __main__ - INFO - Admin retrieved 1 users from SQL Fabric
2025-10-01 13:03:39,059 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:39] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-01 13:03:39,235 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 0, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-01 13:03:39,243 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:39] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:03:55,383 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:03:55] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-01 13:04:00,312 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:00] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 13:04:00,896 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 13:04:00,930 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:00] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 13:04:00,962 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:04:01,281 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:01] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:04:01,296 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:04:01,305 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:01] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:04:01,647 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:04:01,653 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:04:01] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:48,701 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:48] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:48,914 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:48] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:49,038 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:49] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:49,067 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:49] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:49,080 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:49,090 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:49] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:49,431 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:49,437 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:49] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:52,643 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:52,909 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:52,963 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:52,979 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:52,996 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:53,003 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:53,300 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:53,307 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:53,355 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:53,680 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:08:53,682 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:53,694 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:53,701 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:08:54,012 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:08:54,041 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:08:54,048 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:08:54] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:21:49,961 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:21:50,141 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:21:50,291 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:21:50,327 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:21:50,352 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:21:50,360 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:21:50,651 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:21:50,659 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:21:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:21:56,101 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:21:56,787 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:21:58,229 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:21:58,305 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:21:59,596 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:21:59,619 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:21:59,675 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:21:59,695 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:22:00,498 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:22:00,498 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:22:00,498 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:22:00,499 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:22:00,499 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:22:00,499 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:22:00,499 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:22:00,499 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:22:00,515 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:22:00,527 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:24:05,644 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:24:05,804 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:24:05,974 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:05] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:24:06,018 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:24:06,056 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:24:06,064 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:06] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:24:06,322 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:24:06,329 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:06] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:24:40,206 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:24:40,465 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 13:24:40,527 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:24:40,578 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 13:24:40,593 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:24:40,600 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:24:40,862 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 13:24:40,868 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 13:24:40] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 13:28:47,530 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:28:47,937 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:28:48,747 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:28:48,763 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:28:49,486 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:28:49,511 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:28:49,534 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:28:49,554 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:28:50,284 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:28:50,284 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:28:50,285 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:28:50,285 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:28:50,285 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:28:50,285 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:28:50,285 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:28:50,285 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:28:50,295 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:28:50,303 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:34:04,890 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:34:05,541 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:34:07,441 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:34:07,540 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:34:09,773 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:34:09,818 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:34:09,871 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:34:09,895 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:34:09,916 - __main__ - ERROR - Failed to initialize SQL Fabric tables: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_description'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_category'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 13:34:10,725 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:34:10,725 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:34:10,725 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:34:10,725 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:34:10,725 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:34:10,726 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:34:10,726 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:34:10,726 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:34:10,741 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:34:10,761 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:35:05,709 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:35:05,790 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:35:06,459 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:35:06,484 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:35:06,510 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:35:06,532 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:35:06,555 - __main__ - ERROR - Failed to initialize SQL Fabric tables: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_description'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_category'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 13:35:07,274 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:35:07,274 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:35:07,275 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:35:07,275 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:35:07,275 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:35:07,275 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:35:07,275 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:35:07,275 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:35:08,580 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 13:35:08,581 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 13:35:08,582 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:35:09,188 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:35:09,203 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:35:09,812 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:35:09,833 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:35:09,856 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:35:09,875 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:35:09,894 - __main__ - ERROR - Failed to initialize SQL Fabric tables: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_description'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_category'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 13:35:10,581 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:35:10,582 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:35:10,582 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:35:10,582 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:35:10,582 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:35:10,582 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:35:10,582 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:35:10,583 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:35:10,589 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:35:10,597 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:40:20,432 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:40:20,501 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:40:21,226 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:40:21,250 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:40:21,314 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:40:21,335 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:40:21,389 - __main__ - ERROR - Failed to initialize SQL Fabric tables: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'rule_type_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.validation_rule_types'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 13:40:22,144 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:40:22,144 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:40:22,144 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:40:22,144 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:40:22,144 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:40:22,144 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:40:22,145 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:40:22,145 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:40:23,429 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 13:40:23,429 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 13:40:23,431 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:40:24,117 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:40:24,131 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:40:24,732 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:40:24,760 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:40:24,783 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:40:24,804 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:40:24,862 - __main__ - ERROR - Failed to initialize SQL Fabric tables: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'rule_type_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.validation_rule_types'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 13:40:25,598 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:40:25,598 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:40:25,598 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:40:25,598 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:40:25,599 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:40:25,599 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:40:25,599 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:40:25,599 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:40:25,609 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:40:25,622 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:42:14,088 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 13:42:15,181 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:42:16,647 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:42:16,771 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:42:17,667 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:42:17,703 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:42:17,725 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:42:17,745 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-01 13:42:18,026 - __main__ - INFO - Seeded 10 validation rule types
2025-10-01 13:42:18,055 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:42:18,884 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:42:18,885 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:42:18,885 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:42:18,885 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:42:18,885 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:42:18,885 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:42:18,886 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:42:18,886 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:42:18,900 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:42:18,912 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 13:42:49,739 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:42:49,755 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:42:50,396 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:42:50,419 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:42:50,451 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:42:50,513 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:42:51,234 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:42:51,235 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:42:51,235 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:42:51,235 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:42:51,235 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:42:51,235 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:42:51,236 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:42:51,236 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:42:52,507 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 13:42:52,507 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 13:42:52,509 - werkzeug - INFO -  * Restarting with stat
2025-10-01 13:42:53,147 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 13:42:53,161 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 13:42:53,940 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 13:42:53,981 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 13:42:54,024 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 13:42:54,103 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 13:42:54,772 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 13:42:54,772 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 13:42:54,773 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 13:42:54,773 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 13:42:54,773 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 13:42:54,773 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 13:42:54,773 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 13:42:54,773 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 13:42:54,780 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 13:42:54,786 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 14:45:31,418 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:45:31,503 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:45:32,685 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:45:32,716 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:45:32,756 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:45:32,837 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:45:33,588 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:45:33,588 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:45:33,588 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:45:33,588 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:45:33,589 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:45:33,589 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:45:33,589 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:45:33,589 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 14:45:34,891 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 14:45:34,891 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 14:45:34,893 - werkzeug - INFO -  * Restarting with stat
2025-10-01 14:45:35,718 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:45:35,736 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:45:36,640 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:45:36,682 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:45:36,723 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:45:36,817 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:45:37,535 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:45:37,536 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:45:37,536 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:45:37,536 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:45:37,536 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:45:37,536 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:45:37,536 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:45:37,536 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 14:45:37,545 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 14:45:37,552 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 14:45:43,037 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:43] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 14:45:43,288 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:43] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 14:45:44,531 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:44] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 14:45:44,845 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 14:45:44,901 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:44] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 14:45:45,317 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 14:45:45,353 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 14:45:45,361 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:45] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 14:45:45,585 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 14:45:45,690 - __main__ - INFO - Fetched 0 templates from SQL Fabric
2025-10-01 14:45:45,700 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:45:45] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 14:46:05,236 - __main__ - INFO - File loaded for analysis: test_04-07.xlsx (3 rows)
2025-10-01 14:46:05,251 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:05] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 14:46:15,531 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:15] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 14:46:15,861 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:15] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 14:46:45,222 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:45] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:46:45,608 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 14:46:45,616 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:45] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:46:48,937 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 14:46:48,944 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:48] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:46:53,845 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:53] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:46:54,215 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 14:46:54,223 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:46:54] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:47:00,711 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:47:00] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:47:01,081 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'name'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rules_config'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'id'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 14:47:01,088 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:47:01] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:50:58,906 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:50:58,980 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:50:59,879 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:50:59,914 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:50:59,974 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:51:00,027 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:51:00,804 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:51:00,804 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:51:00,805 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:51:00,805 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:51:00,805 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:51:00,805 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:51:00,805 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:51:00,805 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 14:51:02,077 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 14:51:02,078 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 14:51:02,079 - werkzeug - INFO -  * Restarting with stat
2025-10-01 14:51:03,038 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:51:03,058 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:51:03,700 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:51:03,725 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:51:03,746 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:51:03,785 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:51:04,546 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:51:04,546 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:51:04,546 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:51:04,546 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:51:04,547 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:51:04,547 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:51:04,547 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:51:04,547 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 14:51:04,561 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 14:51:04,573 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 14:51:08,634 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:08] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:51:09,009 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 14:51:09,048 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:09] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:51:14,794 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:14] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:51:15,146 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 14:51:15,177 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:15] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:51:45,256 - __main__ - INFO - File loaded for analysis: test_04-07.xlsx (3 rows)
2025-10-01 14:51:45,267 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:45] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 14:51:51,262 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:51] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 14:51:51,598 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:51:51] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 14:52:15,181 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:52:15] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 14:52:15,534 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 14:52:15,561 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 14:52:15] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 14:59:26,404 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 14:59:27,428 - werkzeug - INFO -  * Restarting with stat
2025-10-01 14:59:29,119 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:59:29,204 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:59:30,516 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:59:30,540 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:59:30,565 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:59:30,613 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:59:31,403 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:59:31,403 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:59:31,403 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:59:31,403 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:59:31,403 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:59:31,404 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:59:31,404 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:59:31,404 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 14:59:31,419 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 14:59:31,430 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 14:59:58,144 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 14:59:58,158 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 14:59:58,839 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 14:59:58,861 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 14:59:58,916 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 14:59:58,962 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 14:59:59,637 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 14:59:59,637 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 14:59:59,637 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 14:59:59,637 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 14:59:59,637 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 14:59:59,638 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 14:59:59,638 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 14:59:59,638 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:00:00,898 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:00:00,898 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:00:00,900 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:00:01,548 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:00:01,566 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:00:02,216 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:00:02,238 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:00:02,259 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:00:02,309 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:00:03,008 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:00:03,009 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:00:03,009 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:00:03,009 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:00:03,009 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:00:03,009 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:00:03,009 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:00:03,010 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:00:03,016 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:00:03,022 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:00:16,971 - __main__ - INFO - File loaded for analysis: test_04-07.xlsx (3 rows)
2025-10-01 15:00:16,982 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:16] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 15:00:22,225 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:22] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:00:22,559 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:22] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:00:35,951 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:35] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:00:36,326 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 15:00:36,372 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:36] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:00:41,087 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 15:00:41,133 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:00:41] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:02:25,317 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 15:02:27,109 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:02:28,403 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:02:28,427 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:02:29,284 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:02:29,327 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:02:29,374 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:02:29,455 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:02:30,207 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:02:30,207 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:02:30,207 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:02:30,208 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:02:30,208 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:02:30,208 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:02:30,208 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:02:30,208 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:02:30,220 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:02:30,228 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:03:07,907 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:03:07,921 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:03:08,535 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:03:08,563 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:03:08,587 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:03:08,630 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:03:09,324 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:03:09,325 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:03:09,325 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:03:09,325 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:03:09,325 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:03:09,325 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:03:09,325 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:03:09,325 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:03:10,593 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:03:10,593 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:03:10,595 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:03:11,197 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:03:11,210 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:03:12,019 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:03:12,062 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:03:12,106 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:03:12,187 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:03:12,865 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:03:12,865 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:03:12,865 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:03:12,866 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:03:12,866 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:03:12,866 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:03:12,866 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:03:12,866 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:03:12,873 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:03:12,878 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:03:21,133 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:21] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:03:21,637 - __main__ - INFO - Created new template: Template_20251001_150321 (ID: 1)
2025-10-01 15:03:21,637 - __main__ - INFO - Rules config: {'name ': ['Text', 'Required'], 'num1': ['Required', 'Int'], 'num2': ['Required', 'Int'], 'sum': ['Required', 'Int']}
2025-10-01 15:03:21,744 - __main__ - INFO - Cleaned up session tables for: ae57364c-5111-4e94-a290-0dd39c59d94a
2025-10-01 15:03:21,751 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:21] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:03:21,787 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 15:03:22,132 - __main__ - INFO - Fetched 1 templates from SQL Fabric
2025-10-01 15:03:22,138 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:22] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 15:03:40,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:03:40,279 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '88406e46-fb6b-4278-9363-d4a59a820800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:41 GMT'
    'Content-Length': '1753'
2025-10-01 15:03:40,295 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:03:40,527 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '56c47343-3d5d-431c-9b18-5c53ab3c3300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:42 GMT'
    'Content-Length': '1691'
2025-10-01 15:03:40,528 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:03:40,529 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Ftest_04-07.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b6b5fbc0-9ea9-11f0-a558-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:41,553 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:43 GMT'
    'ETag': '"0x8DE00CD9CFA1DB0"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '18845350-701f-006b-63b6-32ac42000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b6b5fbc0-9ea9-11f0-a558-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:43 GMT'
2025-10-01 15:03:41,554 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Ftest_04-07.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '15929'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b79b1aef-9ea9-11f0-bf7f-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:03:41,605 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '18845352-701f-006b-65b6-32ac42000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b79b1aef-9ea9-11f0-bf7f-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:43 GMT'
2025-10-01 15:03:41,606 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Ftest_04-07.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00CD9CFA1DB0"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b7a30702-9ea9-11f0-817a-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:41,668 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:43 GMT'
    'ETag': '"0x8DE00CD9D0EBDF1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '18845356-701f-006b-69b6-32ac42000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b7a30702-9ea9-11f0-817a-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:43 GMT'
2025-10-01 15:03:41,669 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/a3c865f9-f03d-47ac-824a-4d6079e04485/test_04-07.xlsx
2025-10-01 15:03:41,912 - __main__ - INFO - File loaded for validation: test_04-07.xlsx (3 rows)
2025-10-01 15:03:41,927 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:41] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 15:03:51,312 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:03:51,441 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8484e8ae-3459-426c-afa4-dd07903b3400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:52 GMT'
    'Content-Length': '1753'
2025-10-01 15:03:51,442 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:03:51,624 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3ada5d1d-6e0f-496c-9b0d-33db5bdc0500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:52 GMT'
    'Content-Length': '1688'
2025-10-01 15:03:51,624 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:03:51,625 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bd6c1088-9ea9-11f0-82dc-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:51,903 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:53 GMT'
    'ETag': '"0x8DE00CDA32B91C8"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a9e505d5-d01f-0039-38b6-328c11000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bd6c1088-9ea9-11f0-82dc-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:53 GMT'
2025-10-01 15:03:51,904 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5043'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bdc65df2-9ea9-11f0-ac0a-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:03:51,945 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a9e505de-d01f-0039-41b6-328c11000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bdc65df2-9ea9-11f0-ac0a-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:53 GMT'
2025-10-01 15:03:51,946 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00CDA32B91C8"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bdcccc5a-9ea9-11f0-9277-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:52,006 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:53 GMT'
    'ETag': '"0x8DE00CDA3394B25"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a9e505df-d01f-0039-42b6-328c11000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bdcccc5a-9ea9-11f0-9277-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:53 GMT'
2025-10-01 15:03:52,007 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/a3c865f9-f03d-47ac-824a-4d6079e04485/corrected_corrected.xlsx
2025-10-01 15:03:52,101 - __main__ - INFO - Validation session saved: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:52,149 - __main__ - INFO - Cleaned up session tables for: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:52,178 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:52] "[35m[1mGET /api/validation/download-corrected HTTP/1.1[0m" 500 -
2025-10-01 15:03:54,323 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:03:54,454 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f7292be5-27a1-4c0d-8de0-146377033700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:56 GMT'
    'Content-Length': '1753'
2025-10-01 15:03:54,455 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:03:54,596 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '68e282d1-a294-4625-81a7-9cde9e363100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:56 GMT'
    'Content-Length': '1692'
2025-10-01 15:03:54,597 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:03:54,597 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bf378bab-9ea9-11f0-aea0-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:54,985 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:56 GMT'
    'ETag': '"0x8DE00CDA4FB377C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'db94185f-d01f-0064-0ab6-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bf378bab-9ea9-11f0-aea0-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:56 GMT'
2025-10-01 15:03:54,986 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5043'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bf9cb49b-9ea9-11f0-aadd-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:03:55,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'db941869-d01f-0064-14b6-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bf9cb49b-9ea9-11f0-aadd-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:56 GMT'
2025-10-01 15:03:55,048 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00CDA4FB377C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfa62dec-9ea9-11f0-af14-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:55,131 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:57 GMT'
    'ETag': '"0x8DE00CDA512F745"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'db94186d-d01f-0064-18b6-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bfa62dec-9ea9-11f0-af14-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:56 GMT'
2025-10-01 15:03:55,132 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/a3c865f9-f03d-47ac-824a-4d6079e04485/corrected_corrected.xlsx
2025-10-01 15:03:55,221 - __main__ - INFO - Validation session saved: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:55,263 - __main__ - INFO - Cleaned up session tables for: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:55,278 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:55] "[35m[1mGET /api/validation/download-corrected HTTP/1.1[0m" 500 -
2025-10-01 15:03:55,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:03:55,812 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '889c788a-446a-4106-bd34-7523fea63300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:57 GMT'
    'Content-Length': '1753'
2025-10-01 15:03:55,813 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:03:55,991 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '17d4d0ce-a20f-4eee-af1b-dc8318700500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:57 GMT'
    'Content-Length': '1688'
2025-10-01 15:03:55,992 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:03:55,992 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bffce07b-9ea9-11f0-a0be-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:56,344 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:58 GMT'
    'ETag': '"0x8DE00CDA5CD6A4C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b7e625f-b01f-005d-05b6-327d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bffce07b-9ea9-11f0-a0be-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:58 GMT'
2025-10-01 15:03:56,345 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5043'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c06c1d1e-9ea9-11f0-a30a-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:03:56,383 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b7e6260-b01f-005d-06b6-327d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c06c1d1e-9ea9-11f0-a30a-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:58 GMT'
2025-10-01 15:03:56,384 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Fa3c865f9-f03d-47ac-824a-4d6079e04485%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00CDA5CD6A4C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c071fb67-9ea9-11f0-88d7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:03:56,443 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 09:33:58 GMT'
    'ETag': '"0x8DE00CDA5DE7F39"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b7e6261-b01f-005d-07b6-327d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c071fb67-9ea9-11f0-88d7-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 09:33:58 GMT'
2025-10-01 15:03:56,444 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/a3c865f9-f03d-47ac-824a-4d6079e04485/corrected_corrected.xlsx
2025-10-01 15:03:56,532 - __main__ - INFO - Validation session saved: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:56,585 - __main__ - INFO - Cleaned up session tables for: a3c865f9-f03d-47ac-824a-4d6079e04485
2025-10-01 15:03:56,604 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:03:56] "[35m[1mGET /api/validation/download-corrected HTTP/1.1[0m" 500 -
2025-10-01 15:07:57,462 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 15:07:58,188 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:08:00,114 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:08:00,244 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:08:01,145 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:08:01,170 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:08:01,199 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:08:01,245 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:08:02,067 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:08:02,068 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:08:02,068 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:08:02,068 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:08:02,068 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:08:02,069 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:08:02,069 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:08:02,069 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:08:02,085 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:08:02,097 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:08:27,103 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 15:08:27,280 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:08:28,249 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:08:28,265 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:08:29,115 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:08:29,157 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:08:29,199 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:08:29,280 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:08:30,006 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:08:30,007 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:08:30,007 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:08:30,007 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:08:30,007 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:08:30,007 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:08:30,007 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:08:30,008 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:08:30,016 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:08:30,023 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:09:18,821 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 15:09:18,993 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:09:20,010 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:09:20,029 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:09:20,848 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:09:20,871 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:09:20,893 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:09:20,946 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:09:21,700 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:09:21,701 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:09:21,701 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:09:21,701 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:09:21,701 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:09:21,701 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:09:21,702 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:09:21,702 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:09:21,713 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:09:21,720 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:15:34,513 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:15:34,585 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:15:35,735 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:15:35,758 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:15:35,821 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:15:35,861 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:15:36,591 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:15:36,591 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:15:36,591 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:15:36,592 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:15:36,592 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:15:36,592 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:15:36,592 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:15:36,592 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:15:37,893 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:15:37,893 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:15:37,895 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:15:38,573 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:15:38,587 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:15:39,137 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:15:39,159 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:15:39,183 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:15:39,227 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:15:39,974 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:15:39,975 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:15:39,975 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:15:39,975 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:15:39,975 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:15:39,975 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:15:39,976 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:15:39,976 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:15:39,985 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:15:39,996 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:15:42,219 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 15:15:42,463 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 15:15:42,559 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 15:15:42,592 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 15:15:42,609 - __main__ - INFO - Fetched 1 templates from SQL Fabric
2025-10-01 15:15:42,619 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 15:15:42,904 - __main__ - INFO - Fetched 1 templates from SQL Fabric
2025-10-01 15:15:42,913 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:42] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 15:15:53,217 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-01 15:15:53,227 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:53] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 15:15:59,544 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:59] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:15:59,872 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:15:59] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:16:12,456 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:16:12] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:16:12,888 - __main__ - INFO - Created new template: Template_20251001_151612 (ID: 2)
2025-10-01 15:16:12,915 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_selected'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 15:16:12,953 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:16:12] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:16:20,487 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:16:20] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:16:20,918 - __main__ - INFO - Created new template: Template_20251001_151620 (ID: 2)
2025-10-01 15:16:20,943 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_selected'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 15:16:20,980 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:16:20] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:20:18,266 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 15:20:18,831 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:20:20,249 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:20:20,331 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:20:21,387 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:20:21,430 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:20:21,472 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:20:21,552 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:20:22,313 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:20:22,313 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:20:22,313 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:20:22,314 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:20:22,314 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:20:22,314 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:20:22,314 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:20:22,314 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:20:22,326 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:20:22,339 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:20:47,718 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:20:47,730 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:20:48,602 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:20:48,644 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:20:48,689 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:20:48,769 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:20:49,441 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:20:49,441 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:20:49,441 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:20:49,442 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:20:49,442 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:20:49,442 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:20:49,442 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:20:49,442 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:20:50,733 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:20:50,733 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:20:50,735 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:20:51,370 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:20:51,386 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:20:52,040 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:20:52,064 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:20:52,087 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:20:52,131 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:20:52,821 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:20:52,822 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:20:52,822 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:20:52,822 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:20:52,822 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:20:52,822 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:20:52,823 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:20:52,823 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:20:52,834 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:20:52,841 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:20:54,444 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:20:54] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:20:54,875 - __main__ - INFO - Created new template: Template_20251001_152054 (ID: 2)
2025-10-01 15:20:54,901 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'column_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.template_columns'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 15:20:54,971 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:20:54] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:21:00,341 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:21:00] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:21:00,759 - __main__ - INFO - Created new template: Template_20251001_152100 (ID: 2)
2025-10-01 15:21:00,782 - __main__ - ERROR - Failed to save template: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'column_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.template_columns'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-01 15:21:00,837 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:21:00] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 15:29:16,212 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:29:16,311 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:29:17,475 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:29:17,498 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:29:17,591 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:29:17,630 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:29:18,363 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:29:18,363 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:29:18,364 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:29:18,364 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:29:18,364 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:29:18,364 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:29:18,364 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:29:18,364 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:29:19,642 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:29:19,642 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:29:19,644 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:29:20,277 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:29:20,291 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:29:20,975 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:29:21,001 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:29:21,027 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:29:21,074 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:29:21,747 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:29:21,747 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:29:21,747 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:29:21,747 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:29:21,748 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:29:21,748 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:29:21,748 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:29:21,748 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:29:21,755 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:29:21,761 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:29:28,387 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:29:28] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:29:28,835 - __main__ - INFO - Created new template: Template_20251001_152928 (ID: 2)
2025-10-01 15:29:28,914 - __main__ - INFO - Inserted column: name  (column_id: 1)
2025-10-01 15:29:29,035 - __main__ - INFO - Added rule Text to column name 
2025-10-01 15:29:29,131 - __main__ - INFO - Added rule Required to column name 
2025-10-01 15:29:29,205 - __main__ - INFO - Inserted column: cgst (column_id: 2)
2025-10-01 15:29:29,300 - __main__ - INFO - Added rule Required to column cgst
2025-10-01 15:29:29,401 - __main__ - INFO - Added rule Int to column cgst
2025-10-01 15:29:29,478 - __main__ - INFO - Inserted column: sgst (column_id: 3)
2025-10-01 15:29:29,587 - __main__ - INFO - Added rule Required to column sgst
2025-10-01 15:29:29,689 - __main__ - INFO - Added rule Int to column sgst
2025-10-01 15:29:29,762 - __main__ - INFO - Inserted column: gst (column_id: 4)
2025-10-01 15:29:29,855 - __main__ - INFO - Added rule Required to column gst
2025-10-01 15:29:29,947 - __main__ - INFO - Added rule Int to column gst
2025-10-01 15:29:30,018 - __main__ - INFO - Cleaned up session tables for: 20efa48f-03e2-4c90-a803-c2b6ef74597c
2025-10-01 15:29:30,025 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:29:30] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:29:30,065 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:29:30] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 15:29:30,395 - __main__ - INFO - Fetched 2 templates from SQL Fabric
2025-10-01 15:29:30,402 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:29:30] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 15:37:23,279 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:37:23,379 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:37:24,308 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:37:24,334 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:37:24,415 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:37:24,462 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:37:25,229 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:37:25,229 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:37:25,230 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:37:25,230 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:37:25,230 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:37:25,230 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:37:25,230 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:37:25,230 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:37:26,510 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 15:37:26,510 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 15:37:26,512 - werkzeug - INFO -  * Restarting with stat
2025-10-01 15:37:27,159 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 15:37:27,174 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 15:37:27,855 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 15:37:27,881 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 15:37:27,905 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 15:37:27,955 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 15:37:28,653 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 15:37:28,653 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 15:37:28,653 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 15:37:28,654 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 15:37:28,654 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 15:37:28,654 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 15:37:28,654 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 15:37:28,654 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 15:37:28,662 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 15:37:28,670 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 15:37:42,407 - __main__ - INFO - File loaded for analysis: date.xlsx (3 rows)
2025-10-01 15:37:42,420 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:37:42] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 15:37:47,581 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:37:47] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:37:47,607 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:37:47] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 15:37:58,464 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:37:58] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:37:58,916 - __main__ - INFO - Created new template: date.xlsx (ID: 3)
2025-10-01 15:37:58,988 - __main__ - INFO - Inserted column: name (column_id: 5)
2025-10-01 15:37:59,083 - __main__ - INFO - Added rule Required to column name
2025-10-01 15:37:59,176 - __main__ - INFO - Added rule Text to column name
2025-10-01 15:37:59,246 - __main__ - INFO - Inserted column: email (column_id: 6)
2025-10-01 15:37:59,341 - __main__ - INFO - Added rule Required to column email
2025-10-01 15:37:59,439 - __main__ - INFO - Added rule Email to column email
2025-10-01 15:37:59,512 - __main__ - INFO - Inserted column: date (column_id: 7)
2025-10-01 15:37:59,607 - __main__ - INFO - Added rule Required to column date
2025-10-01 15:37:59,710 - __main__ - INFO - Added rule Alphanumeric to column date
2025-10-01 15:37:59,781 - __main__ - INFO - Inserted column: num (column_id: 8)
2025-10-01 15:37:59,881 - __main__ - INFO - Added rule Required to column num
2025-10-01 15:37:59,976 - __main__ - INFO - Added rule Int to column num
2025-10-01 15:38:00,055 - __main__ - INFO - Cleaned up session tables for: 0eea5c48-62a7-41f7-8b22-fdf4f2ec20ed
2025-10-01 15:38:00,063 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:00] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 15:38:00,228 - __main__ - INFO - Fetched 3 templates from SQL Fabric
2025-10-01 15:38:00,237 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:00] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 15:38:00,452 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 15:38:17,493 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:38:17,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8ef54d14-0bd0-4a50-88fc-14cc6ef00600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:19 GMT'
    'Content-Length': '1753'
2025-10-01 15:38:17,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:38:17,973 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c11bd474-d97d-4c53-80f9-196981880700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:19 GMT'
    'Content-Length': '1688'
2025-10-01 15:38:17,974 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:38:17,975 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8cf62d5a-9eae-11f0-8efe-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:18,457 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:20 GMT'
    'ETag': '"0x8DE00D272E7A27C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '76367872-301f-001e-15bb-329bd5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8cf62d5a-9eae-11f0-8efe-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:19 GMT'
2025-10-01 15:38:18,458 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8d898482-9eae-11f0-a757-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:38:18,505 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '76367879-301f-001e-1cbb-329bd5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8d898482-9eae-11f0-a757-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:19 GMT'
2025-10-01 15:38:18,506 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00D272E7A27C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8d90e1de-9eae-11f0-be72-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:18,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:20 GMT'
    'ETag': '"0x8DE00D272F64E5D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7636787d-301f-001e-1fbb-329bd5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8d90e1de-9eae-11f0-be72-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:19 GMT'
2025-10-01 15:38:18,566 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/4cf9cea3-4baf-47cf-aff2-e4cba6687299/date.xlsx
2025-10-01 15:38:18,576 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 15:38:18,588 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:18] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 15:38:30,233 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:38:30,491 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ba6ec5e2-edbd-46c8-8bb2-a85977610600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
    'Content-Length': '1753'
2025-10-01 15:38:30,492 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:38:30,646 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '4d30290c-7fd2-4bf7-a145-c2ad7a733600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
    'Content-Length': '1693'
2025-10-01 15:38:30,647 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:38:30,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '948e2bea-9eae-11f0-b939-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:30,980 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:32 GMT'
    'ETag': '"0x8DE00D27A5E80FC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e3c59927-401f-002d-0ebb-3298c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '948e2bea-9eae-11f0-b939-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
2025-10-01 15:38:30,982 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5051'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '95007767-9eae-11f0-98f3-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:38:31,019 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e3c5992f-401f-002d-16bb-3298c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '95007767-9eae-11f0-98f3-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
2025-10-01 15:38:31,020 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00D27A5E80FC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9506609c-9eae-11f0-9f0f-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:31,087 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:33 GMT'
    'ETag': '"0x8DE00D27A6C6C95"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e3c59930-401f-002d-17bb-3298c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '9506609c-9eae-11f0-9f0f-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
2025-10-01 15:38:31,087 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/4cf9cea3-4baf-47cf-aff2-e4cba6687299/date_corrected.xlsx
2025-10-01 15:38:31,142 - __main__ - INFO - Validation session saved: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:31,167 - __main__ - INFO - Cleaned up session tables for: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:31,174 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:31] "[33mGET /api/validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-01 15:38:31,511 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:38:31,664 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '81315660-f9b7-44ea-8845-24e8f8663700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
    'Content-Length': '1753'
2025-10-01 15:38:31,665 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:38:31,819 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '81315660-f9b7-44ea-8845-24e8fc663700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:32 GMT'
    'Content-Length': '1693'
2025-10-01 15:38:31,819 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:38:31,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '95514b85-9eae-11f0-9b93-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:32,171 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:34 GMT'
    'ETag': '"0x8DE00D27B0DE49C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f1e478a4-c01f-005c-2ebb-32d29f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '95514b85-9eae-11f0-9b93-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:33 GMT'
2025-10-01 15:38:32,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5051'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '95b634d8-9eae-11f0-9fa1-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:38:32,208 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f1e478b3-c01f-005c-3dbb-32d29f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '95b634d8-9eae-11f0-9fa1-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:33 GMT'
2025-10-01 15:38:32,209 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00D27B0DE49C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '95bbb320-9eae-11f0-a833-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:32,270 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:34 GMT'
    'ETag': '"0x8DE00D27B218011"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f1e478b5-c01f-005c-3fbb-32d29f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '95bbb320-9eae-11f0-a833-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:33 GMT'
2025-10-01 15:38:32,271 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/4cf9cea3-4baf-47cf-aff2-e4cba6687299/date_corrected.xlsx
2025-10-01 15:38:32,326 - __main__ - INFO - Validation session saved: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:32,351 - __main__ - INFO - Cleaned up session tables for: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:32,360 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:32] "[33mGET /api/validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-01 15:38:32,389 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:38:32,548 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '66884b42-8587-4c33-85a7-d51322a03500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:33 GMT'
    'Content-Length': '1753'
2025-10-01 15:38:32,549 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:38:32,816 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8d4aaf6e-70f9-49c3-9059-15598d7b3d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:34 GMT'
    'Content-Length': '1687'
2025-10-01 15:38:32,817 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:38:32,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '95d73da9-9eae-11f0-b81f-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:33,038 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:34 GMT'
    'ETag': '"0x8DE00D27B98C148"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '417cbc41-901f-004a-76bb-32d482000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '95d73da9-9eae-11f0-b81f-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:34 GMT'
2025-10-01 15:38:33,041 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5051'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '963a9eab-9eae-11f0-91c3-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:38:33,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '417cbc48-901f-004a-7dbb-32d482000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '963a9eab-9eae-11f0-91c3-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:34 GMT'
2025-10-01 15:38:33,079 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00D27B98C148"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9640917e-9eae-11f0-afe9-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:33,161 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:35 GMT'
    'ETag': '"0x8DE00D27BA8D951"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '417cbc4e-901f-004a-03bb-32d482000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '9640917e-9eae-11f0-afe9-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:34 GMT'
2025-10-01 15:38:33,162 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/4cf9cea3-4baf-47cf-aff2-e4cba6687299/date_corrected.xlsx
2025-10-01 15:38:33,225 - __main__ - INFO - Validation session saved: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:33,251 - __main__ - INFO - Cleaned up session tables for: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:33,261 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:33] "[33mGET /api/validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-01 15:38:33,591 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 15:38:33,829 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '26039413-8f65-4642-9fe4-d1e0989b0800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:34 GMT'
    'Content-Length': '1753'
2025-10-01 15:38:33,831 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 15:38:33,995 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '96a98a55-f0e6-4100-bd26-73acd48f3c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:35 GMT'
    'Content-Length': '1693'
2025-10-01 15:38:33,996 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 15:38:33,996 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '968e926b-9eae-11f0-93b3-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:34,380 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:36 GMT'
    'ETag': '"0x8DE00D27C5235A4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6bd71401-701f-000f-35bb-320161000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '968e926b-9eae-11f0-93b3-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:35 GMT'
2025-10-01 15:38:34,382 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5051'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '97075e28-9eae-11f0-91d9-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 15:38:34,436 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6bd7140f-701f-000f-43bb-320161000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '97075e28-9eae-11f0-91d9-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:35 GMT'
2025-10-01 15:38:34,438 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F4cf9cea3-4baf-47cf-aff2-e4cba6687299%2Fdate_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00D27C5235A4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '970fdc57-9eae-11f0-b74a-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 15:38:34,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 10:08:36 GMT'
    'ETag': '"0x8DE00D27C7C1EA1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6bd71415-701f-000f-49bb-320161000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '970fdc57-9eae-11f0-b74a-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 10:08:35 GMT'
2025-10-01 15:38:34,584 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/4cf9cea3-4baf-47cf-aff2-e4cba6687299/date_corrected.xlsx
2025-10-01 15:38:34,638 - __main__ - INFO - Validation session saved: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:34,663 - __main__ - INFO - Cleaned up session tables for: 4cf9cea3-4baf-47cf-aff2-e4cba6687299
2025-10-01 15:38:34,671 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 15:38:34] "[33mGET /api/validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-01 16:08:31,133 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:08:31,203 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:08:32,695 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:08:32,769 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:08:32,881 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:08:32,942 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:08:33,799 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:08:33,800 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:08:33,800 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:08:33,800 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:08:33,801 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:08:33,801 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:08:33,801 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:08:33,802 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:08:35,119 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:08:35,120 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:08:35,122 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:08:35,946 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:08:35,962 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:08:36,736 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:08:36,766 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:08:36,788 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:08:36,832 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:08:37,542 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:08:37,543 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:08:37,543 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:08:37,543 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:08:37,543 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:08:37,543 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:08:37,543 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:08:37,544 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:08:37,551 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:08:37,562 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:08:49,873 - __main__ - INFO - File loaded for analysis: test_10-07.xlsx (4 rows)
2025-10-01 16:08:49,887 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:08:49] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 16:08:55,827 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:08:55] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 16:08:55,855 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:08:55] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-01 16:09:16,727 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:09:16] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 16:09:17,179 - __main__ - INFO - Created new template: test_10-07.xlsx (ID: 4)
2025-10-01 16:09:17,231 - __main__ - ERROR - Failed to save template: ('The SQL contains 6 parameter markers, but 5 parameters were supplied', 'HY000')
2025-10-01 16:09:17,232 - __main__ - ERROR - Template name: test_10-07.xlsx, Headers: ['Age', 'DOB', 'Email']...
2025-10-01 16:09:17,270 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:09:17] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 16:09:41,878 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:09:41] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 16:09:42,298 - __main__ - INFO - Created new template: test_10-07.xlsx (ID: 4)
2025-10-01 16:09:42,341 - __main__ - ERROR - Failed to save template: ('The SQL contains 6 parameter markers, but 5 parameters were supplied', 'HY000')
2025-10-01 16:09:42,341 - __main__ - ERROR - Template name: test_10-07.xlsx, Headers: ['Age', 'DOB', 'Email']...
2025-10-01 16:09:42,375 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:09:42] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 16:11:47,593 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:11:47,757 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:11:48,495 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:11:48,528 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:11:48,571 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:11:48,623 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:11:49,343 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:11:49,343 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:11:49,343 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:11:49,344 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:11:49,344 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:11:49,344 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:11:49,344 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:11:49,344 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:11:50,609 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:11:50,609 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:11:50,611 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:11:51,236 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:11:51,250 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:11:52,015 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:11:52,038 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:11:52,059 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:11:52,099 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:11:52,788 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:11:52,788 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:11:52,789 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:11:52,789 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:11:52,789 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:11:52,789 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:11:52,789 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:11:52,789 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:11:52,797 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:11:52,805 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:11:55,470 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:11:55] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 16:11:55,914 - __main__ - INFO - Created new template: test_10-07.xlsx (ID: 4)
2025-10-01 16:11:55,977 - __main__ - ERROR - Failed to save template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_selected'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-01 16:11:55,977 - __main__ - ERROR - Template name: test_10-07.xlsx, Headers: ['Age', 'DOB', 'Email']...
2025-10-01 16:11:56,008 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:11:56] "[35m[1mPOST /api/validation/configure-rules HTTP/1.1[0m" 500 -
2025-10-01 16:14:08,706 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:14:08,774 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:14:09,368 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:14:09,394 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:14:09,420 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:14:09,477 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:14:10,232 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:14:10,232 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:14:10,232 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:14:10,232 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:14:10,232 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:14:10,232 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:14:10,233 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:14:10,233 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:14:11,502 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:14:11,502 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:14:11,504 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:14:12,161 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:14:12,175 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:14:12,693 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:14:12,714 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:14:12,734 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:14:12,774 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:14:13,491 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:14:13,491 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:14:13,492 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:14:13,492 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:14:13,492 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:14:13,492 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:14:13,492 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:14:13,492 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:14:13,500 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:14:13,510 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:14:19,309 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:14:19] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 16:14:19,744 - __main__ - INFO - Created new template: test_10-07.xlsx (ID: 4)
2025-10-01 16:14:19,813 - __main__ - INFO - Inserted column: Age (column_id: 9)
2025-10-01 16:14:19,905 - __main__ - INFO - Added rule Required to column Age
2025-10-01 16:14:19,980 - __main__ - INFO - Added rule Int to column Age
2025-10-01 16:14:20,040 - __main__ - INFO - Inserted column: DOB (column_id: 10)
2025-10-01 16:14:20,119 - __main__ - INFO - Added rule Required to column DOB
2025-10-01 16:14:20,205 - __main__ - INFO - Added rule Alphanumeric to column DOB
2025-10-01 16:14:20,266 - __main__ - INFO - Inserted column: Email (column_id: 11)
2025-10-01 16:14:20,342 - __main__ - INFO - Added rule Required to column Email
2025-10-01 16:14:20,427 - __main__ - INFO - Added rule Email to column Email
2025-10-01 16:14:20,496 - __main__ - INFO - Inserted column: SUM (column_id: 12)
2025-10-01 16:14:20,573 - __main__ - INFO - Added rule Required to column SUM
2025-10-01 16:14:20,665 - __main__ - INFO - Added rule Int to column SUM
2025-10-01 16:14:20,725 - __main__ - INFO - Inserted column: NUM 2 (column_id: 13)
2025-10-01 16:14:20,804 - __main__ - INFO - Added rule Required to column NUM 2
2025-10-01 16:14:20,890 - __main__ - INFO - Added rule Int to column NUM 2
2025-10-01 16:14:20,947 - __main__ - INFO - Inserted column: NUM 1 (column_id: 14)
2025-10-01 16:14:21,024 - __main__ - INFO - Added rule Required to column NUM 1
2025-10-01 16:14:21,104 - __main__ - INFO - Added rule Int to column NUM 1
2025-10-01 16:14:21,176 - __main__ - INFO - Cleaned up session tables for: e0e8bc8a-c1ae-44e7-8b9d-27c8c7d4eab7
2025-10-01 16:14:21,184 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:14:21] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-01 16:14:21,225 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:14:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:14:21,553 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:14:21,560 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:14:21] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:16:19,748 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:16:19,807 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:16:20,335 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:16:20,370 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:16:20,413 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:16:20,469 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:16:21,182 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:16:21,182 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:16:21,182 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:16:21,183 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:16:21,183 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:16:21,183 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:16:21,183 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:16:21,183 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:16:22,452 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:16:22,453 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:16:22,455 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:16:23,099 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:16:23,114 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:16:23,718 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:16:23,743 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:16:23,769 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:16:23,813 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:16:24,524 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:16:24,525 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:16:24,525 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:16:24,525 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:16:24,525 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:16:24,525 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:16:24,526 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:16:24,526 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:16:24,534 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:16:24,542 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:16:26,162 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:16:26,415 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:16:26,491 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:16:26,509 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:16:26,530 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:16:26,537 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:16:26,831 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:16:26,847 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:16:26] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:33,291 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:24:33,361 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:24:34,690 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:24:34,713 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:24:34,734 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:24:34,773 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:24:35,504 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:24:35,504 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:24:35,504 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:24:35,504 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:24:35,504 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:24:35,505 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:24:35,505 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:24:35,505 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:24:36,783 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:24:36,784 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:24:36,785 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:24:37,419 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:24:37,433 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:24:38,074 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:24:38,096 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:24:38,116 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:24:38,155 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:24:38,829 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:24:38,829 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:24:38,829 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:24:38,829 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:24:38,830 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:24:38,830 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:24:38,830 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:24:38,830 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:24:38,837 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:24:38,843 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:24:45,006 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:45,256 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:45,331 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:45,362 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:45,384 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:45,411 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:45,670 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:45,697 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:45] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:50,193 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:50,523 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:50,525 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:50,536 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:50,562 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:50,781 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:50,870 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:50,897 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:52,813 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:53,135 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:24:53,150 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:53,165 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:53,191 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:24:53,391 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:24:53,496 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:24:53,523 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:24:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:25:09,358 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:09] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 16:25:09,596 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:09] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 16:25:10,987 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:10] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 16:25:11,585 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 16:25:11,616 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:11] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 16:25:11,704 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:25:12,029 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:25:12,032 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:25:12,066 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:25:12,401 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:25:12,489 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:25:18,326 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:18] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:25:18,585 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:18] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:25:18,660 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:25:18,680 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:25:18,942 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:25:18,985 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:18] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:25:19,335 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:25:19,365 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:25:19] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:27:05,246 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:27:05,321 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:27:06,136 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:27:06,159 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:27:06,230 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:27:06,275 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:27:07,007 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:27:07,007 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:27:07,008 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:27:07,008 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:27:07,008 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:27:07,008 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:27:07,008 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:27:07,008 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:27:08,290 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:27:08,291 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:27:08,292 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:27:08,903 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:27:08,917 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:27:09,588 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:27:09,610 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:27:09,633 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:27:09,690 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:27:10,385 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:27:10,385 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:27:10,385 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:27:10,386 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:27:10,386 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:27:10,386 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:27:10,386 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:27:10,386 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:27:10,393 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:27:10,400 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:27:15,938 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:27:16,177 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:16] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:27:16,268 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:16] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:27:16,284 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:16] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:27:16,303 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:27:16,329 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:16] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:27:16,665 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:27:16,692 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:27:16] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:30:54,172 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:30:54,232 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:30:54,943 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:30:55,004 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:30:55,034 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:30:55,083 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:30:55,838 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:30:55,838 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:30:55,839 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:30:55,839 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:30:55,839 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:30:55,839 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:30:55,839 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:30:55,839 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:30:57,108 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:30:57,108 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:30:57,110 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:30:58,047 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:30:58,067 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:30:58,762 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:30:58,789 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:30:58,814 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:30:58,865 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:30:59,704 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:30:59,704 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:30:59,705 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:30:59,705 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:30:59,705 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:30:59,706 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:30:59,706 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:30:59,707 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:30:59,723 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:30:59,736 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:31:10,657 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:10] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 16:31:10,895 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:10] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 16:31:12,086 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:12] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 16:31:14,196 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 16:31:14,229 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:14] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 16:31:14,628 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:14,643 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:14,672 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:14] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:31:14,877 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:14,963 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:14,998 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:14] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:31:20,260 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:31:20,594 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:31:20,613 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:20,627 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:20,654 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:31:20,839 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:20,955 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:20,982 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:20] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:31:39,537 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:39] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:31:39,792 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:39] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:31:39,868 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:39] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:39,889 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:39] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:31:39,902 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:39,930 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:39] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:31:40,279 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:31:40,306 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:31:40] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:42:34,572 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:42:34,672 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:42:37,044 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:42:37,154 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:42:37,250 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:42:37,454 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:42:38,623 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:42:38,624 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:42:38,624 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:42:38,624 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:42:38,625 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:42:38,625 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:42:38,625 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:42:38,626 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:42:40,043 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:42:40,043 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:42:40,046 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:42:41,129 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:42:41,156 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:42:42,984 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:42:43,086 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:42:43,189 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:42:43,393 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:42:44,489 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:42:44,490 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:42:44,490 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:42:44,490 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:42:44,490 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:42:44,490 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:42:44,491 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:42:44,491 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:42:44,502 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:42:44,515 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:42:58,794 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:42:59,038 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:42:59,129 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:42:59,173 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:42:59,267 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:42:59,377 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:59] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:42:59,574 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:42:59,607 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:42:59] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:49:49,910 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:49:50,024 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:49:51,564 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:49:51,644 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:49:51,746 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:49:51,950 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:49:53,189 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:49:53,190 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:49:53,190 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:49:53,190 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:49:53,191 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:49:53,191 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:49:53,191 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:49:53,191 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:49:54,491 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:49:54,491 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:49:54,494 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:49:55,822 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:49:55,849 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:49:57,787 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:49:57,891 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:49:57,992 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:49:58,196 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:49:59,355 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:49:59,355 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:49:59,355 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:49:59,356 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:49:59,356 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:49:59,357 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:49:59,357 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:49:59,357 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:49:59,372 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:49:59,391 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:50:01,403 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:50:01,439 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:50:01,811 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:01] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:50:01,902 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:50:01,911 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:01] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:50:02,065 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:02] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:50:02,208 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:50:02,216 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:02] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:50:12,964 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:50:13,214 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:50:13,289 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:50:13,323 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:50:13,369 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:50:13,379 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:13] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:50:13,763 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:50:13,777 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:50:13] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:52:13,655 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:52:13,771 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 16:52:13,986 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:52:14,030 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 16:52:14,115 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:52:14,125 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:14] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:52:14,598 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 16:52:14,607 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:14] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 16:52:35,436 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 16:52:36,104 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '958a6a17-5479-4c80-91bb-e7e4fc763a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:22:37 GMT'
    'Content-Length': '1753'
2025-10-01 16:52:36,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 16:52:36,411 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '77749fb3-a98c-4d0b-ac0a-600dc7ae3900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:22:37 GMT'
    'Content-Length': '1692'
2025-10-01 16:52:36,412 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 16:52:36,413 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5bd09288-a07a-49db-aa01-b44e96a70a09%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ee1a1369-9eb8-11f0-9cc0-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:52:37,434 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:22:39 GMT'
    'ETag': '"0x8DE00DCD48CB97C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2a22b84c-f01f-0063-1dc5-32eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ee1a1369-9eb8-11f0-9cc0-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:22:39 GMT'
2025-10-01 16:52:37,436 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5bd09288-a07a-49db-aa01-b44e96a70a09%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef4b7da2-9eb8-11f0-8fc7-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 16:52:37,489 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2a22b850-f01f-0063-20c5-32eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ef4b7da2-9eb8-11f0-8fc7-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:22:39 GMT'
2025-10-01 16:52:37,491 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5bd09288-a07a-49db-aa01-b44e96a70a09%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00DCD48CB97C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ef53e1b5-9eb8-11f0-a7ee-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:52:37,552 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:22:39 GMT'
    'ETag': '"0x8DE00DCD4AD5DE9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2a22b851-f01f-0063-21c5-32eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ef53e1b5-9eb8-11f0-a7ee-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:22:39 GMT'
2025-10-01 16:52:37,553 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/5bd09288-a07a-49db-aa01-b44e96a70a09/date.xlsx
2025-10-01 16:52:38,232 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 16:52:38,264 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:52:38] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 16:56:38,564 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:56:38,945 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:56:41,152 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:56:41,264 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:56:41,358 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:56:41,562 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:56:42,712 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:56:42,712 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:56:42,713 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:56:42,713 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:56:42,713 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:56:42,714 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:56:42,714 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:56:42,714 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:56:44,066 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-01 16:56:44,067 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 16:56:44,069 - werkzeug - INFO -  * Restarting with stat
2025-10-01 16:56:45,154 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 16:56:45,186 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 16:56:47,093 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 16:56:47,196 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 16:56:47,298 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 16:56:47,502 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 16:56:48,634 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 16:56:48,634 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 16:56:48,634 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 16:56:48,635 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 16:56:48,635 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 16:56:48,635 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 16:56:48,635 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 16:56:48,636 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 16:56:48,649 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 16:56:48,664 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 16:57:11,435 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 16:57:11,706 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '16e64c68-edf0-46cd-ad2a-e0736fe83900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:13 GMT'
    'Content-Length': '1753'
2025-10-01 16:57:11,714 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 16:57:12,094 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '71e8a797-1fe4-4b2d-bde0-8727efef3d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:13 GMT'
    'Content-Length': '1692'
2025-10-01 16:57:12,095 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 16:57:12,095 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '929c4a46-9eb9-11f0-a00c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:57:13,615 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:27:15 GMT'
    'ETag': '"0x8DE00DD79243440"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5a0497de-501f-000e-33c6-320206000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '929c4a46-9eb9-11f0-a00c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:15 GMT'
2025-10-01 16:57:13,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '93e96c8b-9eb9-11f0-b793-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 16:57:13,820 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5a0497e5-501f-000e-3ac6-320206000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '93e96c8b-9eb9-11f0-b793-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:15 GMT'
2025-10-01 16:57:13,821 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00DD79243440"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '940897d9-9eb9-11f0-ad60-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:57:13,922 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:27:15 GMT'
    'ETag': '"0x8DE00DD7964699D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5a0497e6-501f-000e-3bc6-320206000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '940897d9-9eb9-11f0-ad60-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:15 GMT'
2025-10-01 16:57:13,923 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/552c343d-b140-4709-bb30-4f0822a6685c/date.xlsx
2025-10-01 16:57:14,365 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 16:57:14,388 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:57:14] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 16:57:23,724 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 16:57:24,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3590ae8d-cf51-4f61-b129-004abaf13800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:25 GMT'
    'Content-Length': '1753'
2025-10-01 16:57:24,268 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 16:57:24,575 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'd2e5f75e-f30e-457b-b4b8-df58ce430900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:25 GMT'
    'Content-Length': '1687'
2025-10-01 16:57:24,576 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 16:57:24,577 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fcorrected_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '99ef9aa2-9eb9-11f0-83e9-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:57:25,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:27:27 GMT'
    'ETag': '"0x8DE00DD8058B23C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2aed6cc6-d01f-0032-0ec6-3287b0000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '99ef9aa2-9eb9-11f0-83e9-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:26 GMT'
2025-10-01 16:57:25,700 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5051'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9b1d2e9e-9eb9-11f0-bcdf-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 16:57:25,801 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2aed6cc8-d01f-0032-10c6-3287b0000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '9b1d2e9e-9eb9-11f0-bcdf-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:26 GMT'
2025-10-01 16:57:25,806 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F552c343d-b140-4709-bb30-4f0822a6685c%2Fcorrected_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00DD8058B23C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '9b2d415c-9eb9-11f0-9c20-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 16:57:25,908 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 11:27:27 GMT'
    'ETag': '"0x8DE00DD808A6159"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2aed6cc9-d01f-0032-11c6-3287b0000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '9b2d415c-9eb9-11f0-9c20-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 11:27:26 GMT'
2025-10-01 16:57:25,909 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/552c343d-b140-4709-bb30-4f0822a6685c/corrected_corrected.xlsx
2025-10-01 16:57:26,107 - __main__ - INFO - Validation session saved: 552c343d-b140-4709-bb30-4f0822a6685c
2025-10-01 16:57:26,224 - __main__ - INFO - Cleaned up session tables for: 552c343d-b140-4709-bb30-4f0822a6685c
2025-10-01 16:57:26,234 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 16:57:26] "[33mGET /api/validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-01 17:00:54,170 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 17:00:54,209 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 17:00:54,555 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 17:00:54,708 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 17:00:54,719 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:54] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 17:00:54,809 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 17:00:55,010 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 17:00:55,022 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:00:55] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 17:01:02,264 - __main__ - INFO - File loaded for analysis: test26-06.xlsx (3 rows)
2025-10-01 17:01:02,286 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:01:02] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 17:01:04,603 - __main__ - INFO - File loaded for analysis: test26-06.xlsx (3 rows)
2025-10-01 17:01:04,621 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:01:04] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 17:01:05,733 - __main__ - INFO - File loaded for analysis: test26-06.xlsx (3 rows)
2025-10-01 17:01:05,746 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 17:01:05] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 18:29:42,125 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 18:29:42,269 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 18:29:42,467 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 18:29:42,498 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 18:29:42,507 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-01 18:29:42,518 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 18:29:42,800 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-01 18:29:42,808 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:29:42] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 18:30:25,631 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 18:30:25,731 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 18:30:29,043 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 18:30:29,181 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 18:30:29,356 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 18:30:29,505 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 18:30:30,348 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 18:30:30,349 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 18:30:30,349 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 18:30:30,349 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 18:30:30,349 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 18:30:30,350 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 18:30:30,350 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 18:30:30,350 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 18:30:31,771 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://127.0.0.1:5000
2025-10-01 18:30:31,771 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 18:30:31,774 - werkzeug - INFO -  * Restarting with stat
2025-10-01 18:30:32,913 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 18:30:32,934 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 18:30:34,300 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 18:30:34,357 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 18:30:34,427 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 18:30:34,620 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 18:30:35,587 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 18:30:35,588 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 18:30:35,588 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 18:30:35,588 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 18:30:35,588 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 18:30:35,588 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 18:30:35,589 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 18:30:35,589 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 18:30:35,603 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 18:30:35,618 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 18:30:38,062 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 18:30:38,102 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 18:30:38,444 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 18:30:38,534 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 18:30:38,542 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:38] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 18:30:38,775 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 18:30:38,940 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 18:30:39,579 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:39] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 18:30:50,671 - __main__ - INFO - File loaded for analysis: testing.xlsx (4 rows)
2025-10-01 18:30:50,692 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:30:50] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 18:31:04,975 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 18:31:05,601 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e112501e-69bb-4cfc-b1a5-e293d36d3e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:01:07 GMT'
    'Content-Length': '1753'
2025-10-01 18:31:05,610 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 18:31:05,907 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f7badf12-ebec-4996-ac06-ead9c94e1d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:01:07 GMT'
    'Content-Length': '1693'
2025-10-01 18:31:05,908 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 18:31:05,909 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F89398ee9-2037-438d-9bba-3c1b098f1ce4%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b07648b4-9ec6-11f0-8119-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 18:31:07,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:01:10 GMT'
    'ETag': '"0x8DE00EA97DBC714"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8d24088d-601f-0048-43d3-323681000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b07648b4-9ec6-11f0-8119-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:01:10 GMT'
2025-10-01 18:31:07,649 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F89398ee9-2037-438d-9bba-3c1b098f1ce4%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b20e840f-9ec6-11f0-a0a1-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 18:31:07,852 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8d24088f-601f-0048-45d3-323681000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b20e840f-9ec6-11f0-a0a1-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:01:10 GMT'
2025-10-01 18:31:07,854 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F89398ee9-2037-438d-9bba-3c1b098f1ce4%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00EA97DBC714"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b22db78b-9ec6-11f0-b155-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 18:31:07,975 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:01:10 GMT'
    'ETag': '"0x8DE00EA98275A85"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8d240891-601f-0048-47d3-323681000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b22db78b-9ec6-11f0-b155-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:01:10 GMT'
2025-10-01 18:31:07,976 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/89398ee9-2037-438d-9bba-3c1b098f1ce4/date.xlsx
2025-10-01 18:31:07,987 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 18:31:08,002 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:31:08] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 18:32:13,000 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 18:32:13,701 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9565871a-8e9b-42db-9677-4bf3eee83f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:02:15 GMT'
    'Content-Length': '1753'
2025-10-01 18:32:13,705 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 18:32:14,124 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7eb2c3e4-f40b-40aa-a7c2-05ab98ca3800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:02:16 GMT'
    'Content-Length': '1687'
2025-10-01 18:32:14,128 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 18:32:14,130 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F01088ef3-fd06-463f-a577-1f067ede0da7%2Ftesting.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd901a307-9ec6-11f0-a08d-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 18:32:15,356 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:02:18 GMT'
    'ETag': '"0x8DE00EAC04DF680"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6c24ead4-801f-0046-12d3-32438a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'd901a307-9ec6-11f0-a08d-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:02:17 GMT'
2025-10-01 18:32:15,362 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F01088ef3-fd06-463f-a577-1f067ede0da7%2Ftesting.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16841'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'da6ab2ce-9ec6-11f0-8d76-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 18:32:15,540 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6c24ead9-801f-0046-17d3-32438a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'da6ab2ce-9ec6-11f0-8d76-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:02:18 GMT'
2025-10-01 18:32:15,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F01088ef3-fd06-463f-a577-1f067ede0da7%2Ftesting.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00EAC04DF680"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'da8617fd-9ec6-11f0-88ac-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 18:32:15,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:02:18 GMT'
    'ETag': '"0x8DE00EAC0815A19"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6c24eae0-801f-0046-1ed3-32438a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'da8617fd-9ec6-11f0-88ac-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:02:18 GMT'
2025-10-01 18:32:15,711 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/01088ef3-fd06-463f-a577-1f067ede0da7/testing.xlsx
2025-10-01 18:32:15,852 - __main__ - INFO - File loaded for validation: testing.xlsx (4 rows)
2025-10-01 18:32:15,884 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 18:32:15] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 18:57:53,328 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 18:57:53,481 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 18:57:57,164 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 18:57:57,254 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 18:57:57,396 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 18:57:57,483 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 18:57:57,628 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:00:37,243 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:00:37,362 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:00:39,107 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:00:39,169 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:00:39,226 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:00:39,310 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:00:39,440 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:02:01,865 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:02:02,008 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:02:04,827 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:02:04,897 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:02:04,979 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:02:05,106 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:02:05,245 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:02:06,281 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:02:06,281 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:02:06,282 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:02:06,282 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:02:06,282 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:02:06,282 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:02:06,283 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:02:06,283 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:02:06,337 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.62.246.115:5000
2025-10-01 19:02:06,337 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 19:02:06,341 - werkzeug - INFO -  * Restarting with stat
2025-10-01 19:02:07,497 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:02:07,523 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:02:09,524 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:02:09,627 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:02:09,736 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:02:10,036 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:02:10,117 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:02:11,293 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:02:11,293 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:02:11,293 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:02:11,294 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:02:11,294 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:02:11,294 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:02:11,294 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:02:11,295 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:02:11,310 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 19:02:11,332 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 19:02:24,864 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:02:25,722 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'bba38eda-8324-4d44-aeac-f51920880900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:32:27 GMT'
    'Content-Length': '1753'
2025-10-01 19:02:25,731 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:02:26,023 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3e28a995-0452-4ce5-a55a-517695b83800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:32:28 GMT'
    'Content-Length': '1692'
2025-10-01 19:02:26,023 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:02:26,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa0b6f079-3171-4d11-8cc1-2c3b886d9b11%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '10f6a15f-9ecb-11f0-bd43-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:02:27,958 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:32:30 GMT'
    'ETag': '"0x8DE00EEF8A4C55C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '242ad95d-401f-0052-32d7-32fb2f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '10f6a15f-9ecb-11f0-bd43-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:32:30 GMT'
2025-10-01 19:02:27,959 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa0b6f079-3171-4d11-8cc1-2c3b886d9b11%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '12cf1603-9ecb-11f0-92a9-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:02:28,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '242ad960-401f-0052-35d7-32fb2f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '12cf1603-9ecb-11f0-92a9-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:32:30 GMT'
2025-10-01 19:02:28,164 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa0b6f079-3171-4d11-8cc1-2c3b886d9b11%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00EEF8A4C55C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '12ee3fe8-9ecb-11f0-83ef-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:02:28,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:32:31 GMT'
    'ETag': '"0x8DE00EEF8E3456D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '242ad963-401f-0052-38d7-32fb2f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '12ee3fe8-9ecb-11f0-83ef-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:32:30 GMT'
2025-10-01 19:02:28,472 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/a0b6f079-3171-4d11-8cc1-2c3b886d9b11/date.xlsx
2025-10-01 19:02:29,026 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:02:29,058 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:02:29] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:08:02,765 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-01 19:08:03,816 - werkzeug - INFO -  * Restarting with stat
2025-10-01 19:08:05,227 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:08:05,345 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:08:08,867 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:08:08,938 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:08:09,097 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:08:09,237 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:08:09,422 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:08:10,538 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:08:10,539 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:08:10,539 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:08:10,539 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:08:10,540 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:08:10,540 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:08:10,540 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:08:10,541 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:08:10,562 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 19:08:10,581 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 19:08:12,282 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:08:12,319 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:08:12,664 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:08:12,747 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:08:12,757 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:08:12,925 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:08:13,165 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:08:13,175 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:13] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:08:28,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:08:29,541 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '92a23e0d-0e48-454e-bba9-c6cc22da3c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:38:32 GMT'
    'Content-Length': '1753'
2025-10-01 19:08:29,549 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:08:29,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '10f4028f-c201-4149-b6ae-854e198a3e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:38:32 GMT'
    'Content-Length': '1692'
2025-10-01 19:08:29,746 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:08:29,746 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5795df04-ff13-4d82-a4e4-5ace1eba5e6f%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e9da71be-9ecb-11f0-b96b-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:08:31,486 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:38:34 GMT'
    'ETag': '"0x8DE00EFD158409C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5d867e9a-a01f-0023-6fd8-32edce000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e9da71be-9ecb-11f0-b96b-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:38:33 GMT'
2025-10-01 19:08:31,488 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5795df04-ff13-4d82-a4e4-5ace1eba5e6f%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eb7d1401-9ecb-11f0-a4d1-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:08:31,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5d867ea0-a01f-0023-75d8-32edce000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'eb7d1401-9ecb-11f0-a4d1-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:38:34 GMT'
2025-10-01 19:08:31,804 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5795df04-ff13-4d82-a4e4-5ace1eba5e6f%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00EFD158409C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ebad65bc-9ecb-11f0-a6d7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:08:32,013 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:38:34 GMT'
    'ETag': '"0x8DE00EFD1A34639"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5d867eab-a01f-0023-80d8-32edce000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ebad65bc-9ecb-11f0-a6d7-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:38:34 GMT'
2025-10-01 19:08:32,014 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/5795df04-ff13-4d82-a4e4-5ace1eba5e6f/date.xlsx
2025-10-01 19:08:32,621 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:08:32,658 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:08:32] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:13:32,410 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:32] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:13:32,613 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:32] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:13:32,751 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:13:32,785 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:13:32,973 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:13:32,985 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:32] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:13:33,386 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:13:33,398 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:33] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:13:39,207 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:13:39,928 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fdd8ed8d-ca73-4b85-8857-79b8a5023e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:43:42 GMT'
    'Content-Length': '1753'
2025-10-01 19:13:39,931 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:13:40,229 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1a9a691b-b24d-4519-8ee8-80c53f883e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:43:42 GMT'
    'Content-Length': '1692'
2025-10-01 19:13:40,230 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:13:40,231 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19950826-27d3-4745-aa83-3d0c43503351%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a2e6ec5a-9ecc-11f0-a27c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:13:41,979 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:43:44 GMT'
    'ETag': '"0x8DE00F08A675E74"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'dba2981e-d01f-0064-07d9-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a2e6ec5a-9ecc-11f0-a27c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:43:44 GMT'
2025-10-01 19:13:41,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19950826-27d3-4745-aa83-3d0c43503351%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a48f076e-9ecc-11f0-b7ad-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:13:42,277 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'dba29836-d01f-0064-1fd9-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a48f076e-9ecc-11f0-b7ad-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:43:44 GMT'
2025-10-01 19:13:42,279 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19950826-27d3-4745-aa83-3d0c43503351%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00F08A675E74"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a4bc08cb-9ecc-11f0-9311-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:13:42,481 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:43:45 GMT'
    'ETag': '"0x8DE00F08AAF2081"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'dba2985f-d01f-0064-48d9-328695000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a4bc08cb-9ecc-11f0-9311-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:43:44 GMT'
2025-10-01 19:13:42,482 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/19950826-27d3-4745-aa83-3d0c43503351/date.xlsx
2025-10-01 19:13:42,633 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:13:42,667 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:13:42] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:17:09,075 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:17:09,243 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:17:09,433 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:17:09,468 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:17:09,524 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:17:09,535 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:17:09,820 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:17:09,832 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:09] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:17:33,855 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:17:34,118 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:17:34,193 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:17:34,257 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:17:34,420 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:17:34,432 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:34] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:17:34,627 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:17:34,638 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:34] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:17:42,206 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:17:42,756 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3c5afcbc-f173-41fb-a90e-bd25394f4000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:47:45 GMT'
    'Content-Length': '1753'
2025-10-01 19:17:42,760 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:17:43,025 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'e4c27959-3433-4e14-a559-a358b4273c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:47:45 GMT'
    'Content-Length': '1693'
2025-10-01 19:17:43,026 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:17:43,027 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F47ca42d0-d75e-4273-9e81-f065f4286b91%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '33bdb344-9ecd-11f0-b76f-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:17:44,495 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:47:47 GMT'
    'ETag': '"0x8DE00F11AEF1614"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8cd9f42e-101f-005f-3ad9-3233fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '33bdb344-9ecd-11f0-b76f-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:47:46 GMT'
2025-10-01 19:17:44,503 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F47ca42d0-d75e-4273-9e81-f065f4286b91%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '351c7e2a-9ecd-11f0-a34e-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:17:44,628 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8cd9f443-101f-005f-4fd9-3233fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '351c7e2a-9ecd-11f0-a34e-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:47:47 GMT'
2025-10-01 19:17:44,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F47ca42d0-d75e-4273-9e81-f065f4286b91%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00F11AEF1614"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '352ff41a-9ecd-11f0-9e96-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:17:44,769 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:47:47 GMT'
    'ETag': '"0x8DE00F11B216AF9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8cd9f454-101f-005f-60d9-3233fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '352ff41a-9ecd-11f0-9e96-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:47:47 GMT'
2025-10-01 19:17:44,770 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/47ca42d0-d75e-4273-9e81-f065f4286b91/date.xlsx
2025-10-01 19:17:44,915 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:17:45,176 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:17:45] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:22:01,371 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:01] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 19:22:01,487 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:01] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 19:22:30,324 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:30] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 19:22:31,141 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 19:22:31,235 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:31] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 19:22:31,679 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:22:31,799 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:22:31,811 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:31] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:22:31,922 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:22:32,108 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:22:32,117 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:32] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:22:45,137 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:22:45,545 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '77e83814-6bdc-4037-8caa-0d76e0963c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:52:48 GMT'
    'Content-Length': '1753'
2025-10-01 19:22:45,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:22:45,836 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'fd068906-e73b-4c0c-87dc-473f496b3a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:52:48 GMT'
    'Content-Length': '1692'
2025-10-01 19:22:45,839 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:22:45,840 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F53a72fcb-43f1-4c47-a18b-501e90af8746%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e84cde08-9ecd-11f0-a854-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:22:47,774 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:52:50 GMT'
    'ETag': '"0x8DE00F1CFAD19E4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'c74510bd-001f-0031-7dda-3266d4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e84cde08-9ecd-11f0-a854-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:52:49 GMT'
2025-10-01 19:22:47,784 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F53a72fcb-43f1-4c47-a18b-501e90af8746%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e9e18821-9ecd-11f0-aa93-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:22:47,977 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'c74510c2-001f-0031-02da-3266d4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e9e18821-9ecd-11f0-aa93-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:52:50 GMT'
2025-10-01 19:22:47,980 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F53a72fcb-43f1-4c47-a18b-501e90af8746%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00F1CFAD19E4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e9ff7a60-9ecd-11f0-b728-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:22:48,489 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:52:50 GMT'
    'ETag': '"0x8DE00F1CFF042F1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'c74510c8-001f-0031-07da-3266d4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e9ff7a60-9ecd-11f0-b728-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:52:50 GMT'
2025-10-01 19:22:48,490 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/53a72fcb-43f1-4c47-a18b-501e90af8746/date.xlsx
2025-10-01 19:22:48,690 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:22:48,725 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:22:48] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:26:11,484 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:26:11,528 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:26:11,878 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:26:11,941 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:26:11,954 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:11] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:26:12,134 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:26:12,269 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:26:12,300 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:26:19,100 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-01 19:26:19,471 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '27b078d5-834a-4d5c-b8ae-fefb3b1d3f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:56:21 GMT'
    'Content-Length': '1753'
2025-10-01 19:26:19,473 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-01 19:26:19,858 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6df9c814-8678-45c3-b6af-f0be49ee4000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:56:21 GMT'
    'Content-Length': '1687'
2025-10-01 19:26:19,859 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-01 19:26:19,860 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F1dd97cbf-1dcf-43e9-a9d0-85056e924c0d%2Fdate.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '67d56a9e-9ece-11f0-9ed8-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:26:20,978 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:56:23 GMT'
    'ETag': '"0x8DE00F24ECC6C40"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a2d834e2-101f-0044-5bdb-32fd32000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '67d56a9e-9ece-11f0-9ed8-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:56:23 GMT'
2025-10-01 19:26:20,983 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F1dd97cbf-1dcf-43e9-a9d0-85056e924c0d%2Fdate.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '68f52d1d-9ece-11f0-a128-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-01 19:26:21,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a2d834e7-101f-0044-60db-32fd32000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '68f52d1d-9ece-11f0-a128-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:56:23 GMT'
2025-10-01 19:26:21,093 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F1dd97cbf-1dcf-43e9-a9d0-85056e924c0d%2Fdate.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE00F24ECC6C40"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6905e8a5-9ece-11f0-8e19-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-01 19:26:21,205 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Wed, 01 Oct 2025 13:56:23 GMT'
    'ETag': '"0x8DE00F24EF47D29"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a2d834eb-101f-0044-61db-32fd32000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6905e8a5-9ece-11f0-8e19-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Wed, 01 Oct 2025 13:56:23 GMT'
2025-10-01 19:26:21,205 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/1dd97cbf-1dcf-43e9-a9d0-85056e924c0d/date.xlsx
2025-10-01 19:26:21,344 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-01 19:26:21,373 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:26:21] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-01 19:32:49,682 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:32:49,788 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:32:50,051 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:32:50,098 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:32:50,197 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:32:50,210 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:32:50,608 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:32:50,619 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:32:50] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:33:02,408 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:33:02] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:33:05,638 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:33:05] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:33:07,019 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:33:07] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:33:13,312 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:33:13] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:39:48,187 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:39:48,263 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:39:50,527 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:39:50,588 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:39:50,682 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:39:50,806 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:39:50,977 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:39:51,635 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:39:51,635 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:39:51,635 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:39:51,635 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:39:51,636 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:39:51,636 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:39:51,636 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:39:51,636 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:39:51,686 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.62.246.115:5000
2025-10-01 19:39:51,686 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 19:39:51,688 - werkzeug - INFO -  * Restarting with stat
2025-10-01 19:39:52,333 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:39:52,347 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:39:53,695 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:39:53,762 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:39:53,832 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:39:53,956 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:39:54,022 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:39:54,685 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:39:54,685 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:39:54,686 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:39:54,686 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:39:54,686 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:39:54,686 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:39:54,686 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:39:54,686 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:39:54,693 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 19:39:54,700 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 19:40:13,132 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:13] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 19:40:13,385 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:13] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-01 19:40:14,658 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:14] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-01 19:40:15,311 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-01 19:40:15,404 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:15] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-01 19:40:15,571 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:40:15,910 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:40:15,948 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:40:15,963 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:15] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:40:16,354 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:40:16,370 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:16] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:40:24,499 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:40:24] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:44:50,291 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:44:50,383 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:44:52,048 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:44:52,108 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:44:52,168 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:44:52,287 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:44:52,415 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:44:53,071 - __main__ - ERROR - Failed to register data validation routes: View function mapping is overwriting an existing endpoint function: upload_file_for_validation
2025-10-01 19:44:53,078 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:44:53,078 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:44:53,078 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:44:53,079 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:44:53,079 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:44:53,079 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:44:53,079 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:44:53,079 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:44:53,103 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.62.246.115:5000
2025-10-01 19:44:53,103 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 19:44:53,105 - werkzeug - INFO -  * Restarting with stat
2025-10-01 19:44:53,719 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:44:53,733 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:44:54,948 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:44:55,088 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:44:55,147 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:44:55,266 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:44:55,347 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:44:56,113 - __main__ - ERROR - Failed to register data validation routes: View function mapping is overwriting an existing endpoint function: upload_file_for_validation
2025-10-01 19:44:56,123 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:44:56,124 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:44:56,124 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:44:56,124 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:44:56,125 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:44:56,125 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:44:56,125 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:44:56,125 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:44:56,139 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 19:44:56,153 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-01 19:45:06,415 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:06] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:45:06,677 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:06] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-01 19:45:06,751 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:45:06,799 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-01 19:45:06,867 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:45:06,882 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:06] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:45:07,197 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-01 19:45:07,211 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:07] "GET /api/templates HTTP/1.1" 200 -
2025-10-01 19:45:13,921 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:13] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:45:15,318 - werkzeug - INFO - 127.0.0.1 - - [01/Oct/2025 19:45:15] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-01 19:53:16,020 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:53:16,108 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:53:18,658 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:53:18,720 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:53:18,825 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:53:18,928 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:53:19,043 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:53:19,706 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:53:19,707 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:53:19,707 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:53:19,707 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:53:19,707 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:53:19,707 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:53:19,707 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:53:19,708 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:53:19,731 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.62.246.115:5000
2025-10-01 19:53:19,731 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-01 19:53:19,733 - werkzeug - INFO -  * Restarting with stat
2025-10-01 19:53:20,410 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-01 19:53:20,424 - __main__ - INFO - DuckDB memory tables initialized
2025-10-01 19:53:21,678 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-01 19:53:21,738 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-01 19:53:21,812 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-01 19:53:21,990 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-01 19:53:22,043 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-01 19:53:22,715 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-01 19:53:22,715 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-01 19:53:22,715 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-01 19:53:22,716 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-01 19:53:22,716 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-01 19:53:22,716 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-01 19:53:22,716 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-01 19:53:22,716 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-01 19:53:22,723 - werkzeug - WARNING -  * Debugger is active!
2025-10-01 19:53:22,731 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-02 11:49:59,789 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:49:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-02 11:49:59,859 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:49:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-02 11:50:00,429 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:50:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-02 11:50:00,463 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-02 11:50:00,496 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:50:00] "GET /api/templates HTTP/1.1" 200 -
2025-10-02 11:50:02,377 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:50:02] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-02 11:50:02,689 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-02 11:50:02,703 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 11:50:02] "GET /api/templates HTTP/1.1" 200 -
2025-10-02 18:08:56,346 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-02 18:08:56,474 - __main__ - INFO - DuckDB memory tables initialized
2025-10-02 18:09:10,332 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-02 18:09:10,434 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-02 18:09:10,539 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-02 18:09:10,653 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-02 18:09:10,839 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-02 18:09:11,593 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-02 18:09:11,593 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-02 18:09:11,594 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-02 18:09:11,594 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-02 18:09:11,594 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-02 18:09:11,594 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-02 18:09:11,594 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-02 18:09:11,594 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-02 18:09:13,044 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://10.143.122.115:5000
2025-10-02 18:09:13,045 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-02 18:09:13,047 - werkzeug - INFO -  * Restarting with stat
2025-10-02 18:09:14,247 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-02 18:09:14,272 - __main__ - INFO - DuckDB memory tables initialized
2025-10-02 18:09:15,684 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-02 18:09:15,743 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-02 18:09:15,797 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-02 18:09:15,880 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-02 18:09:15,959 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-02 18:09:16,741 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-02 18:09:16,741 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-02 18:09:16,741 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-02 18:09:16,741 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-02 18:09:16,742 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-02 18:09:16,742 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-02 18:09:16,742 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-02 18:09:16,742 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-02 18:09:16,754 - werkzeug - WARNING -  * Debugger is active!
2025-10-02 18:09:16,768 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-02 18:09:19,118 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-02 18:09:19,370 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-02 18:09:19,474 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-02 18:09:19,597 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-02 18:09:19,687 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-02 18:09:19,702 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/templates HTTP/1.1" 200 -
2025-10-02 18:09:19,963 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-02 18:09:19,978 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:19] "GET /api/templates HTTP/1.1" 200 -
2025-10-02 18:09:36,814 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:36] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-02 18:09:48,010 - werkzeug - INFO - 127.0.0.1 - - [02/Oct/2025 18:09:48] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-03 09:02:29,573 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:02:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 09:02:29,659 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:02:29] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:02:29,980 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-03 09:02:29,993 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:02:29] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 09:02:30,013 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:02:30] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:02:30,318 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-03 09:02:30,327 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:02:30] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 09:11:03,009 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:11:03,102 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:11:15,422 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:11:15,480 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:11:15,551 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:11:15,608 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:11:15,674 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:11:16,427 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:11:16,427 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:11:16,428 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:11:16,428 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:11:16,428 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:11:16,428 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:11:16,428 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:11:16,429 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:11:16,461 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 09:11:16,461 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 09:11:16,464 - werkzeug - INFO -  * Restarting with stat
2025-10-03 09:11:17,848 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:11:17,885 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:11:18,797 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:11:18,820 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:11:18,841 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:11:18,881 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:11:18,939 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:11:19,685 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:11:19,686 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:11:19,686 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:11:19,686 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:11:19,686 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:11:19,687 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:11:19,687 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:11:19,687 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:11:19,721 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 09:11:19,734 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 09:13:56,135 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:13:56] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:13:56,314 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:13:56] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:14:01,654 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:01] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 09:14:01,976 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 09:14:02,025 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:02] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 09:14:02,464 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:02] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:14:02,503 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 09:14:02,510 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:02] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 09:14:02,654 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:02] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:14:02,808 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 09:14:02,815 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:02] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 09:14:25,967 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:14:25] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-03 09:39:28,677 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-03 09:39:29,476 - werkzeug - INFO -  * Restarting with stat
2025-10-03 09:39:30,938 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:39:31,047 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:39:38,059 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:39:38,148 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:39:38,239 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:39:38,294 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:39:38,355 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:39:39,057 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:39:39,057 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:39:39,057 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:39:39,058 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:39:39,058 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:39:39,058 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:39:39,058 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:39:39,058 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:39:39,068 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 09:39:39,074 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 09:39:47,218 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:39:47,237 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:39:48,475 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:39:48,517 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:39:48,558 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:39:48,636 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:39:48,684 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:39:49,351 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:39:49,352 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:39:49,352 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:39:49,352 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:39:49,352 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:39:49,352 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:39:49,353 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:39:49,353 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:39:49,409 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 09:39:49,410 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 09:39:49,413 - werkzeug - INFO -  * Restarting with stat
2025-10-03 09:39:50,141 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:39:50,161 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:39:51,096 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:39:51,119 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:39:51,144 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:39:51,185 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:39:51,225 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:39:51,885 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:39:51,885 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:39:51,885 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:39:51,886 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:39:51,886 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:39:51,886 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:39:51,886 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:39:51,886 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:39:51,893 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 09:39:51,897 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 09:48:03,871 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:03] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:48:04,090 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:04] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:48:13,839 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:48:13,919 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:48:15,462 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:48:15,485 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:48:15,559 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:48:15,598 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:48:15,657 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:48:16,322 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:48:16,322 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:48:16,322 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:48:16,323 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:48:16,323 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:48:16,323 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:48:16,323 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:48:16,323 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:48:16,342 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 09:48:16,342 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 09:48:16,344 - werkzeug - INFO -  * Restarting with stat
2025-10-03 09:48:16,963 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 09:48:16,981 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 09:48:17,919 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 09:48:17,941 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 09:48:17,964 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 09:48:18,004 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 09:48:18,044 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 09:48:18,721 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 09:48:18,721 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 09:48:18,721 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 09:48:18,721 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 09:48:18,721 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 09:48:18,721 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 09:48:18,721 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 09:48:18,722 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 09:48:18,729 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 09:48:18,734 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 09:48:27,074 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:27] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:48:27,323 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:27] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 09:48:40,401 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:40] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 09:48:41,009 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 09:48:41,040 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:41] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 09:48:41,133 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:48:41,477 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 09:48:41,492 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 09:48:41,500 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:41] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 09:48:41,842 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 09:48:41,849 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 09:48:41] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:28:58,618 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 10:28:58,721 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 10:29:00,755 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 10:29:00,843 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 10:29:00,937 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 10:29:00,992 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 10:29:01,033 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 10:29:01,036 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 10:29:01,686 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 10:29:01,687 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 10:29:01,687 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 10:29:01,687 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 10:29:01,687 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 10:29:01,687 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 10:29:01,687 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 10:29:01,687 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 10:29:01,706 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 10:29:01,706 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 10:29:01,708 - werkzeug - INFO -  * Restarting with stat
2025-10-03 10:29:02,341 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 10:29:02,363 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 10:29:03,375 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 10:29:03,397 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 10:29:03,418 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 10:29:03,456 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 10:29:03,500 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 10:29:03,503 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 10:29:04,166 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 10:29:04,166 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 10:29:04,166 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 10:29:04,166 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 10:29:04,166 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 10:29:04,167 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 10:29:04,167 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 10:29:04,167 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 10:29:04,173 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 10:29:04,187 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 10:29:36,553 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:36] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 10:29:36,800 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:36] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 10:29:45,844 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:45] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 10:29:46,456 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 10:29:46,491 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:46] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 10:29:46,610 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:29:46,951 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:29:46,972 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:29:46,979 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:46] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:29:47,319 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:29:47,329 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:29:47] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:30:29,117 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 10:30:29,130 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:30:29] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 10:30:38,390 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:30:38] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 10:30:38,719 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:30:38] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 10:39:51,255 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 10:39:51,463 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 10:39:51,602 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:39:51,641 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:39:51,663 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:39:51,676 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:51] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:39:52,019 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:39:52,027 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:52] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:39:58,499 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 10:39:58,509 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:39:58] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 10:40:03,110 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:40:03] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 10:40:03,131 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:40:03] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 10:51:36,000 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 10:51:36,235 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 10:51:36,320 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:51:36,338 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 10:51:36,376 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:51:36,383 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:51:36,679 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 10:51:36,687 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 10:51:42,503 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 10:51:42,516 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:42] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 10:51:48,985 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:48] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 10:51:49,322 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 10:51:49] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:00:25,432 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:00:25,681 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:00:25,756 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:00:25,788 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:00:25,803 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 11:00:25,813 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:25] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:00:26,156 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 11:00:26,164 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:26] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:00:30,821 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 11:00:30,831 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:30] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 11:00:33,356 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:33] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:00:33,377 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:00:33] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:07:11,408 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:07:11,673 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:07:11,737 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:07:11,760 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:07:11,773 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 11:07:11,783 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:11] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:07:12,129 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 11:07:12,135 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:07:16,759 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 11:07:16,769 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:16] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 11:07:18,925 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:18] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:07:18,956 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:07:18] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:49:05,577 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:49:05,772 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 11:49:05,911 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:05] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:49:05,950 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-03 11:49:05,957 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:05] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:49:06,071 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-03 11:49:06,080 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:06] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 11:49:06,380 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 11:49:11,370 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 11:49:11,382 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:11] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 11:49:14,064 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:14] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 11:49:14,389 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 11:49:14] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 12:01:01,502 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\services\\duckdb_service.py', reloading
2025-10-03 12:01:02,263 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:01:04,076 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:01:04,185 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:01:06,015 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:01:06,120 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:01:06,218 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:01:06,304 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:01:06,409 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:01:06,412 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:01:07,141 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:01:07,142 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:01:07,142 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:01:07,142 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:01:07,142 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:01:07,142 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:01:07,143 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:01:07,143 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:01:07,155 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:01:07,164 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:02:06,863 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-03 12:02:07,054 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:02:08,127 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:02:08,154 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:02:09,403 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:02:09,441 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:02:09,478 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:02:09,549 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:02:09,610 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:02:09,612 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:02:10,318 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:02:10,318 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:02:10,319 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:02:10,319 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:02:10,319 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:02:10,319 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:02:10,319 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:02:10,319 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:02:10,331 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:02:10,338 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:02:40,972 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:02:41,185 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:02:42,171 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:02:42,197 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:02:43,132 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:02:43,157 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:02:43,179 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:02:43,218 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:02:43,273 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:02:43,277 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:02:43,980 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:02:43,981 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:02:43,981 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:02:43,981 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:02:43,981 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:02:43,981 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:02:43,981 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:02:43,982 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:02:43,992 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:02:43,999 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:02:54,406 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:02:54,612 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:02:55,682 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:02:55,710 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:02:56,877 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:02:56,915 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:02:56,958 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:02:57,032 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:02:57,120 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:02:57,124 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:02:57,877 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:02:57,877 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:02:57,878 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:02:57,878 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:02:57,878 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:02:57,878 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:02:57,878 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:02:57,879 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:02:57,892 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:02:57,900 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:03:06,932 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:03:07,100 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:03:08,070 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:03:08,096 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:03:09,379 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:03:09,419 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:03:09,457 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:03:09,530 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:03:09,596 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:03:09,598 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:03:10,299 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:03:10,299 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:03:10,300 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:03:10,300 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:03:10,300 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:03:10,300 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:03:10,300 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:03:10,300 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:03:10,310 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:03:10,317 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:03:24,430 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:03:24,610 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:03:25,605 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:03:25,636 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:03:26,639 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:03:26,665 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:03:26,687 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:03:26,729 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:03:26,798 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:03:26,801 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:03:27,555 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:03:27,556 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:03:27,556 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:03:27,557 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:03:27,557 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:03:27,557 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:03:27,558 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:03:27,558 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:03:27,571 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:03:27,586 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:03:51,506 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:03:51,954 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:03:53,479 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:03:53,514 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:03:54,481 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:03:54,508 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:03:54,530 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:03:54,572 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:03:54,650 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:03:54,655 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:03:55,395 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:03:55,400 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:03:55,405 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:03:55,411 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:03:55,418 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:03:55,420 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:03:55,421 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:03:55,421 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:03:55,439 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:03:55,458 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:04:03,131 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:04:03,407 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:04:04,760 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:04:04,791 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:04:05,897 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:04:05,937 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:04:05,975 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:04:06,047 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:04:06,101 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:04:06,104 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:04:06,837 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:04:06,837 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:04:06,838 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:04:06,838 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:04:06,838 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:04:06,838 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:04:06,838 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:04:06,838 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:04:06,851 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:04:06,859 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:04:13,747 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:04:13,918 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:04:14,914 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:04:14,938 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:04:15,803 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:04:15,827 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:04:15,852 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:04:15,895 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:04:15,954 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:04:15,958 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:04:16,665 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:04:16,666 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:04:16,666 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:04:16,666 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:04:16,666 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:04:16,667 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:04:16,667 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:04:16,667 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:04:16,676 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:04:16,682 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:07:14,448 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-03 12:07:14,761 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:07:19,109 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:07:19,146 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:07:22,101 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:07:22,153 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:07:22,214 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:07:22,290 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:07:22,576 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:07:22,581 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:07:23,299 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:07:23,299 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:07:23,300 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:07:23,300 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:07:23,300 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:07:23,300 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:07:23,300 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:07:23,301 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:07:23,334 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:07:23,343 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:26:13,295 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:26:13,372 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:26:14,716 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:26:14,751 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:26:14,815 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:26:14,861 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:26:14,942 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:26:14,945 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:26:15,609 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:26:15,610 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:26:15,610 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:26:15,610 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:26:15,610 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:26:15,610 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:26:15,610 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:26:15,610 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:26:15,727 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 12:26:15,728 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 12:26:15,730 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:26:16,431 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:26:16,449 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:26:17,443 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:26:17,465 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:26:17,490 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:26:17,530 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:26:17,578 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:26:17,581 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:26:18,257 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:26:18,257 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:26:18,257 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:26:18,257 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:26:18,257 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:26:18,258 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:26:18,258 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:26:18,258 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:26:18,265 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:26:18,272 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:27:03,166 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:27:03,425 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:27:03,502 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:27:03,580 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:27:03,642 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 12:27:03,656 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:27:03,859 - __main__ - INFO - Fetched 4 templates from SQL Fabric
2025-10-03 12:27:03,868 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:03] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:27:10,091 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 12:27:10,107 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:10] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 12:27:14,593 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:14] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 12:27:14,930 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:14] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 12:27:27,379 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:27] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-03 12:27:27,488 - __main__ - INFO - Created new template: Book1.xlsx (ID: 5)
2025-10-03 12:27:27,549 - __main__ - INFO - Inserted column: name  (column_id: 15)
2025-10-03 12:27:27,633 - __main__ - INFO - Added rule Required to column name 
2025-10-03 12:27:27,713 - __main__ - INFO - Added rule Text to column name 
2025-10-03 12:27:27,776 - __main__ - INFO - Inserted column: cgst (column_id: 16)
2025-10-03 12:27:27,859 - __main__ - INFO - Added rule Required to column cgst
2025-10-03 12:27:27,939 - __main__ - INFO - Added rule Int to column cgst
2025-10-03 12:27:27,998 - __main__ - INFO - Inserted column: sgst (column_id: 17)
2025-10-03 12:27:28,082 - __main__ - INFO - Added rule Required to column sgst
2025-10-03 12:27:28,160 - __main__ - INFO - Added rule Int to column sgst
2025-10-03 12:27:28,223 - __main__ - INFO - Inserted column: gst (column_id: 18)
2025-10-03 12:27:28,303 - __main__ - INFO - Added rule Required to column gst
2025-10-03 12:27:28,384 - __main__ - INFO - Added rule Int to column gst
2025-10-03 12:27:28,465 - __main__ - INFO - Cleaned up session tables for: 95d35c38-984b-4d13-a121-d33a54940d49
2025-10-03 12:27:28,473 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:28] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-03 12:27:28,811 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:28] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:27:28,826 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:27:28,834 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:28] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:27:38,362 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 12:27:38,376 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:38] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 12:27:46,886 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-03 12:27:46,894 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-03 12:27:46,895 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template: Book1
2025-10-03 12:27:46,961 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:46] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-03 12:27:48,283 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-03 12:27:48,297 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-03 12:27:48,298 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template: Book1
2025-10-03 12:27:48,366 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:27:48] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-03 12:35:27,967 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-03 12:35:28,335 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:35:30,105 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:35:30,130 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:35:31,443 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:35:31,477 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:35:31,550 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:35:31,596 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:35:31,687 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:35:31,693 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:35:32,460 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:35:32,461 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:35:32,461 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:35:32,461 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:35:32,461 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:35:32,461 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:35:32,461 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:35:32,462 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:35:32,480 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:35:32,491 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:37:27,871 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:37:27,889 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:37:28,768 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:37:28,790 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:37:28,812 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:37:28,852 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:37:28,915 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:37:28,919 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:37:29,604 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:37:29,604 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:37:29,604 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:37:29,604 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:37:29,604 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:37:29,605 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:37:29,605 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:37:29,605 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:37:29,624 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 12:37:29,624 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 12:37:29,627 - werkzeug - INFO -  * Restarting with stat
2025-10-03 12:37:30,736 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 12:37:30,768 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 12:37:31,632 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 12:37:31,657 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 12:37:31,683 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 12:37:31,728 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 12:37:31,913 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 12:37:31,918 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 12:37:32,733 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 12:37:32,734 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 12:37:32,734 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 12:37:32,735 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 12:37:32,735 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 12:37:32,736 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 12:37:32,736 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 12:37:32,737 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 12:37:32,751 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 12:37:32,762 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 12:37:36,205 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:37:36,447 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:37:36,539 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:37:36,572 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:37:36,596 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:37:36,606 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:37:36,884 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:37:36,894 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:37:43,017 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 12:37:43,029 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:43] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 12:37:48,481 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:48] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 12:37:48,819 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:37:48] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 12:38:12,742 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:38:12] "OPTIONS /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-03 12:38:13,126 - __main__ - INFO - Updated existing template: Book1.xlsx (ID: 5)
2025-10-03 12:38:13,245 - __main__ - INFO - Inserted column: name  (column_id: 15)
2025-10-03 12:38:13,342 - __main__ - INFO - Added rule Text to column name 
2025-10-03 12:38:13,427 - __main__ - INFO - Added rule Required to column name 
2025-10-03 12:38:13,493 - __main__ - INFO - Inserted column: cgst (column_id: 16)
2025-10-03 12:38:13,580 - __main__ - INFO - Added rule Required to column cgst
2025-10-03 12:38:13,669 - __main__ - INFO - Added rule Int to column cgst
2025-10-03 12:38:13,731 - __main__ - INFO - Inserted column: sgst (column_id: 17)
2025-10-03 12:38:13,818 - __main__ - INFO - Added rule Required to column sgst
2025-10-03 12:38:13,901 - __main__ - INFO - Added rule Int to column sgst
2025-10-03 12:38:13,966 - __main__ - INFO - Inserted column: gst (column_id: 18)
2025-10-03 12:38:14,048 - __main__ - INFO - Added rule Required to column gst
2025-10-03 12:38:14,128 - __main__ - INFO - Added rule Int to column gst
2025-10-03 12:38:14,207 - __main__ - INFO - Cleaned up session tables for: 8fb5456c-56f9-41cb-a9d8-d96fa4d5feb3
2025-10-03 12:38:14,215 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:38:14] "POST /api/validation/configure-rules HTTP/1.1" 200 -
2025-10-03 12:38:14,244 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:38:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:38:14,562 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:38:14,571 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:38:14] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:38:26,232 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-03 12:38:26,242 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-03 12:38:26,242 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-03 12:38:26,242 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-03 12:38:26,265 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'Template_20251001_152928'
2025-10-03 12:38:26,266 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'Book1.xlsx'
2025-10-03 12:38:26,266 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=5, Name=Book1.xlsx
2025-10-03 12:38:26,266 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-03 12:38:26,266 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-03 12:38:29,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-03 12:38:29,514 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f729b10a-da25-43bd-90f3-542b22ee3d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:08:31 GMT'
    'Content-Length': '1753'
2025-10-03 12:38:29,533 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-03 12:38:29,677 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '957207f4-3edd-4006-b2ea-6feeb3461600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:08:32 GMT'
    'Content-Length': '1692'
2025-10-03 12:38:29,678 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-03 12:38:29,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fdbfc34d5-fd85-463e-ac09-4a405a1b97e9%2FBook1%2A_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c3832918-a027-11f0-a2af-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-03 12:38:30,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Fri, 03 Oct 2025 07:08:33 GMT'
    'ETag': '"0x8DE024BAA7CB540"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '93b29040-b01f-0072-7e34-347042000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c3832918-a027-11f0-a2af-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:08:33 GMT'
2025-10-03 12:38:30,745 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fdbfc34d5-fd85-463e-ac09-4a405a1b97e9%2FBook1%2A_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '15921'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c462915d-a027-11f0-8663-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-03 12:38:30,797 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '93b29068-b01f-0072-2634-347042000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c462915d-a027-11f0-8663-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:08:33 GMT'
2025-10-03 12:38:30,798 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fdbfc34d5-fd85-463e-ac09-4a405a1b97e9%2FBook1%2A_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE024BAA7CB540"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'c46ab695-a027-11f0-a6e7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-03 12:38:30,866 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Fri, 03 Oct 2025 07:08:34 GMT'
    'ETag': '"0x8DE024BAA91ED39"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '93b29074-b01f-0072-3234-347042000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'c46ab695-a027-11f0-a6e7-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:08:33 GMT'
2025-10-03 12:38:30,869 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/dbfc34d5-fd85-463e-ac09-4a405a1b97e9/Book1*_SL.xlsx
2025-10-03 12:38:30,886 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-03 12:38:30,906 - __main__ - INFO - File loaded for validation: Book1.xlsx (3 rows)
2025-10-03 12:38:30,935 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session dbfc34d5-fd85-463e-ac09-4a405a1b97e9 created with 3 rows ready for validation
2025-10-03 12:38:30,965 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:38:30] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-03 12:48:12,689 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:48:12,692 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:48:12,713 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:48:12,728 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:48:37,632 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:37] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:48:37,635 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:37] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 12:48:37,661 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:48:37,671 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:37] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 12:48:37,872 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:37] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 12:48:38,000 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 12:48:38,008 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 12:48:38] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 13:08:38,085 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 13:08:38,302 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 13:08:38,410 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 13:08:38,443 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 13:08:38,483 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 13:08:38,491 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 13:08:38,767 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 13:08:38,776 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:38] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 13:08:44,183 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 13:08:44,198 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:44] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 13:08:47,217 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:47] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 13:08:47,554 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 13:08:47] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 14:40:35,834 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 14:40:35,981 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 14:40:36,189 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 14:40:36,282 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 14:40:36,301 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-03 14:40:36,316 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 14:40:36,537 - __main__ - ERROR - Failed to get templates: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-03 14:40:36,555 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:36] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 14:40:42,149 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 14:40:42,163 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:42] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 14:40:51,571 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:51] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 14:40:51,611 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:40:51] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 14:59:38,231 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:59:38] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 14:59:38,461 - __main__ - ERROR - Database login error: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
2025-10-03 14:59:38,464 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 14:59:38] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-10-03 15:00:10,619 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 15:00:10,730 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 15:00:13,328 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 15:00:13,434 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 15:00:13,548 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 15:00:13,739 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 15:00:13,851 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 15:00:13,855 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 15:00:14,588 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 15:00:14,588 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 15:00:14,588 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 15:00:14,588 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 15:00:14,589 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 15:00:14,589 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 15:00:14,589 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 15:00:14,589 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 15:00:14,625 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-03 15:00:14,626 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-03 15:00:14,628 - werkzeug - INFO -  * Restarting with stat
2025-10-03 15:00:15,497 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 15:00:15,513 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 15:00:17,324 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 15:00:17,425 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 15:00:17,527 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 15:00:17,732 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 15:00:17,786 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 15:00:17,789 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 15:00:18,525 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 15:00:18,525 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 15:00:18,525 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 15:00:18,526 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 15:00:18,526 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 15:00:18,526 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 15:00:18,526 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 15:00:18,526 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 15:00:18,534 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 15:00:18,546 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 15:00:25,143 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:00:25] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:00:25,618 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:00:25] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-10-03 15:03:06,315 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:03:06] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:03:07,118 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:03:07,320 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:03:07] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:05:04,201 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:05:04] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:05:04,932 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:05:05,084 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:05:05] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:08:15,452 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:08:15] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-10-03 15:10:51,249 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:10:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:10:51,290 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:10:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:10:51,318 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:10:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:10:51,367 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:10:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:11:30,955 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:11:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:11:31,022 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:11:31] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:11:31,028 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:11:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:11:31,075 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:11:31] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:16:21,233 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:16:21,494 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:16:21,557 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:16:21,606 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:16:21,760 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 15:16:21,769 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 15:16:21,962 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 15:16:21,970 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:16:21] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 15:17:07,742 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 15:17:07,759 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:17:07] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 15:17:11,658 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:17:11] "OPTIONS /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 15:17:12,009 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:17:12] "POST /api/validation/configure-headers HTTP/1.1" 200 -
2025-10-03 15:23:33,802 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:23:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:23:34,060 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:23:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:23:34,135 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:23:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:23:34,154 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:23:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:33:46,645 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:33:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:33:46,825 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:33:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:34:27,515 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:34:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:34:27,776 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:34:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:34:32,140 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:34:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:34:32,406 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:34:32] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:37:22,427 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:37:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:37:22,686 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:37:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:37:22,766 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:37:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:37:22,804 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:37:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:39:55,208 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:39:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:39:55,457 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:39:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:39:55,536 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:39:55] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:39:55,554 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:39:55] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:43:54,285 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:43:54] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:43:54,930 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:43:54,961 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:43:54] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:47:00,536 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:47:00,803 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:47:00,864 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:47:00,882 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:47:32,791 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:32] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:47:33,038 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:47:33,118 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:33] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:47:33,135 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:47:33] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:48:50,782 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:50] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:48:51,345 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:51] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:48:53,036 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:53] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:48:53,664 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:48:53,696 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:53] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:48:53,959 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:48:54,304 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:48:54,306 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:48:54,565 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:48:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:06,232 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:06] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:06,567 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:06,569 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:06] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:06,822 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:06] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:17,893 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:18,229 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:18] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:18,244 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:18,494 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:25,666 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:25,915 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:49:25,997 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:26,016 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:49:54,658 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:54] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:49:54,921 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:49:54] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:52:44,596 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:52:44] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:52:44,597 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:52:44] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:52:44,808 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:52:44] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:52:44,920 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:52:44] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:11,864 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:11] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:54:12,495 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:54:12,527 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:12] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:54:13,014 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:13,337 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:13,367 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:54:13,597 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:13,659 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:54:13,689 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:42,519 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:42,783 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:42,856 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:42] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:54:42,863 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:54:43,107 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:54:43,185 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:54:43] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:55:57,338 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:55:57] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-03 15:55:57,686 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:55:57] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-03 15:55:57,922 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:55:57] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:55:58,226 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:55:58] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:56:08,663 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:08] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:56:09,026 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:09] "[31m[1mPOST /api/auth/login HTTP/1.1[0m" 401 -
2025-10-03 15:56:20,964 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:20] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:56:21,544 - __main__ - INFO - Login successful: admin@example.com (admin) - Demo mode
2025-10-03 15:56:21,576 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:21] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:56:21,742 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:56:22,074 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:56:22,230 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 0, 'total_validations': 8, 'total_templates': 5, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-03 15:56:22,236 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:56:22,402 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:56:22,652 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 1, 'pending_approvals': 0, 'total_validations': 8, 'total_templates': 5, 'role_distribution': {'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-03 15:56:22,659 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:56:22,731 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:56:32,914 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:32] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-03 15:56:33,243 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:33] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-03 15:56:33,490 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:33] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:56:33,693 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:33] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-03 15:56:55,557 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:55] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:56:55,559 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:56:55,803 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:55] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:56:55,882 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:56:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:57:35,011 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:35] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:57:35,582 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-03 15:57:35,618 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:35] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-03 15:57:35,824 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:57:36,149 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:57:36,166 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:57:36,474 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:57:36,492 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:57:36,803 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:57:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:58:52,537 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:58:52,801 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:58:52,862 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:58:52,878 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:58:53,138 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 15:58:53,191 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:58:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:59:02,235 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:59:02] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 15:59:02,539 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 15:59:02] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 16:01:23,972 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:23] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:01:24,237 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:24] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:01:24,298 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:24] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 16:01:24,317 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:24] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:01:24,562 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:24] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 16:01:24,626 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:01:24] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,095 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,333 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,441 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,460 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,664 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 16:06:00,714 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-03 16:06:00,716 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:06:00,788 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:06:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:16:57,252 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:16:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:16:57,320 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:16:57,328 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:16:57] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:16:57,456 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:16:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:16:57,595 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:16:57,601 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:16:57] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:19:07,569 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:19:07,576 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:19:07] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:20:54,626 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:20:54,634 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:20:54] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:21:25,575 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:21:25,583 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:21:25] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:24:55,783 - __main__ - INFO - File loaded for analysis: date.xlsx (3 rows)
2025-10-03 16:24:55,802 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:24:55] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 16:24:56,008 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:24:56] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:24:56,344 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:24:56] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-03 16:24:56,351 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:24:56] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:24:56,685 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:24:56] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-03 16:32:50,931 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-03 16:32:51,567 - werkzeug - INFO -  * Restarting with stat
2025-10-03 16:32:53,048 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-03 16:32:53,109 - __main__ - INFO - DuckDB memory tables initialized
2025-10-03 16:32:54,768 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-03 16:32:54,858 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-03 16:32:54,948 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-03 16:32:55,012 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-03 16:32:55,121 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-03 16:32:55,125 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-03 16:32:55,833 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-03 16:32:55,833 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-03 16:32:55,833 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-03 16:32:55,833 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-03 16:32:55,834 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-03 16:32:55,834 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-03 16:32:55,834 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-03 16:32:55,834 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-03 16:32:55,847 - werkzeug - WARNING -  * Debugger is active!
2025-10-03 16:32:55,857 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-03 16:36:10,907 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:36:11,163 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:36:11,239 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:11] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:36:11,254 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:11] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-03 16:36:11,262 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:11] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:36:11,579 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:11] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-03 16:36:12,273 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:36:12,327 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:36:12,336 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:36:12,532 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-03 16:36:12,622 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-03 16:36:12,632 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:12] "GET /api/templates HTTP/1.1" 200 -
2025-10-03 16:36:19,799 - __main__ - INFO - File loaded for analysis: Book1.xlsx (3 rows)
2025-10-03 16:36:19,816 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:19] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-03 16:36:19,989 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:19] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:36:20,290 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:20] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-03 16:36:20,316 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:20] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-03 16:36:20,615 - werkzeug - INFO - 127.0.0.1 - - [03/Oct/2025 16:36:20] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:24:05,282 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 20:24:05,367 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 20:24:20,526 - __main__ - ERROR - SQL Fabric connection failed: ('08001', '[08001] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Timeout error [258].  (258) (SQLDriverConnect); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Login timeout expired (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Invalid connection string attribute (0); [08001] [Microsoft][ODBC Driver 18 for SQL Server]Unable to complete login process due to delay in login response (258)')
2025-10-04 20:24:20,527 - __main__ - INFO - Continuing in fallback mode
2025-10-04 20:24:20,588 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 20:24:20,591 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 20:24:21,265 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 20:24:21,265 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 20:24:21,265 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 20:24:21,265 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 20:24:21,265 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 20:24:21,265 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 20:24:21,266 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 20:24:21,266 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 20:24:21,287 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 20:24:21,288 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 20:24:21,290 - werkzeug - INFO -  * Restarting with stat
2025-10-04 20:24:22,226 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 20:24:22,242 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 20:24:26,331 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 20:24:26,403 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 20:24:26,492 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 20:24:26,576 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 20:24:26,623 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 20:24:26,626 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 20:24:27,287 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 20:24:27,287 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 20:24:27,287 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 20:24:27,287 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 20:24:27,288 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 20:24:27,288 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 20:24:27,288 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 20:24:27,288 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 20:24:27,296 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 20:24:27,303 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 20:24:44,477 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:44] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-04 20:24:45,090 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-04 20:24:45,136 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:45] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-04 20:24:45,363 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:45,706 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:45,711 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 20:24:46,031 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:46,047 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 20:24:46,357 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:51,690 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:51,739 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-04 20:24:51,753 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:51] "GET /api/templates HTTP/1.1" 200 -
2025-10-04 20:24:53,383 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:24:53,709 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-04 20:24:53,719 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:24:53] "GET /api/templates HTTP/1.1" 200 -
2025-10-04 20:25:04,663 - __main__ - INFO - File loaded for analysis: 28-7.xlsx (5 rows)
2025-10-04 20:25:04,683 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:25:04] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-04 20:25:04,827 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:25:04] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-04 20:25:05,137 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:25:05] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:25:05,168 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:25:05] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-04 20:25:05,476 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:25:05] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:33:53,869 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:33:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:33:53,996 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-04 20:33:53,997 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:33:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:33:54,010 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:33:54] "GET /api/templates HTTP/1.1" 200 -
2025-10-04 20:33:54,250 - __main__ - INFO - Fetched 5 templates from SQL Fabric
2025-10-04 20:33:54,261 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:33:54] "GET /api/templates HTTP/1.1" 200 -
2025-10-04 20:34:04,400 - __main__ - INFO - File loaded for analysis: 28-7.xlsx (5 rows)
2025-10-04 20:34:04,423 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:34:04] "POST /api/files/upload HTTP/1.1" 200 -
2025-10-04 20:34:04,568 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:34:04] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-04 20:34:04,889 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:34:04] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:34:04,919 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:34:04] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-04 20:34:05,231 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:34:05] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:44:32,526 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:44:32] "[33mGET /api/validation/rules HTTP/1.1[0m" 404 -
2025-10-04 20:44:32,528 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:44:32] "[33mGET /api/templates/NaN?sheet=Sheet1 HTTP/1.1[0m" 404 -
2025-10-04 20:44:48,370 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:44:48] "[33mGET /api/rule-config/get-template/NaN HTTP/1.1[0m" 404 -
2025-10-04 20:44:48,567 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_custom'. (207) (SQLExecDirectW)")
2025-10-04 20:44:48,625 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:44:48] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 20:46:48,324 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 20:46:48,413 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 20:46:50,833 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 20:46:50,934 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 20:46:51,009 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 20:46:51,075 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 20:46:51,176 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 20:46:51,180 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 20:46:51,936 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 20:46:51,936 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 20:46:51,937 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 20:46:51,937 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 20:46:51,937 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 20:46:51,938 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 20:46:51,938 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 20:46:51,938 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 20:46:51,966 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 20:46:51,967 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 20:46:51,970 - werkzeug - INFO -  * Restarting with stat
2025-10-04 20:46:52,888 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 20:46:52,907 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 20:46:55,003 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 20:46:55,047 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 20:46:55,090 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 20:46:55,169 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 20:46:55,229 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 20:46:55,233 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 20:46:56,015 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 20:46:56,016 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 20:46:56,016 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 20:46:56,016 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 20:46:56,016 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 20:46:56,016 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 20:46:56,016 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 20:46:56,017 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 20:46:56,026 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 20:46:56,037 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 20:48:01,218 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:01,477 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:01,558 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "[33mGET /api/rule-config/get-template/NaN HTTP/1.1[0m" 404 -
2025-10-04 20:48:01,582 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "[33mGET /api/rule-config/get-template/NaN HTTP/1.1[0m" 404 -
2025-10-04 20:48:01,601 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_custom'. (207) (SQLExecDirectW)")
2025-10-04 20:48:01,612 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 20:48:01,975 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'is_custom'. (207) (SQLExecDirectW)")
2025-10-04 20:48:01,991 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:01] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 20:48:03,679 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 20:48:03,692 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:03] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:03,776 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:03] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 20:48:03,941 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:03] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:04,021 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 20:48:04,082 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:04] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 20:48:13,161 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:13] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-04 20:48:13,505 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:13] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-04 20:48:13,813 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:13] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-04 20:48:14,141 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:14] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-04 20:48:26,114 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:26] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-04 20:48:26,837 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-04 20:48:27,015 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-04 20:48:27,241 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:27,581 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:27,585 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 20:48:27,922 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 20:48:27,926 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:28,260 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:29,444 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 20:48:29,454 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:29,506 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:29] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 20:48:29,699 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 20:48:29,776 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 20:48:29,833 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:29] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 20:48:36,320 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-04 20:48:36,320 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for Book1.xlsx
2025-10-04 20:48:36,320 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: 'DuckDBService' object has no attribute 'analyze_file'
2025-10-04 20:48:36,340 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:36] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 20:48:57,939 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: 31-07.xlsx by user vamsi@gmail.com
2025-10-04 20:48:57,939 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for 31-07.xlsx
2025-10-04 20:48:57,940 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: 'DuckDBService' object has no attribute 'analyze_file'
2025-10-04 20:48:57,960 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 20:48:57] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:00:00,821 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:00:00,931 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:00:02,802 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:00:02,842 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:00:02,900 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:00:02,978 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:00:03,113 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:00:03,120 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:00:04,162 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:00:04,163 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:00:04,163 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:00:04,163 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:00:04,163 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:00:04,163 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:00:04,164 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:00:04,164 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:00:04,198 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:00:04,198 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:00:04,203 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:00:05,358 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:00:05,385 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:00:06,386 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:00:06,419 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:00:06,451 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:00:06,513 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:00:06,578 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:00:06,583 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:00:07,371 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:00:07,371 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:00:07,371 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:00:07,371 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:00:07,372 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:00:07,372 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:00:07,372 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:00:07,372 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:00:07,385 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:00:07,401 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:00:12,198 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:00:12,217 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 21:00:12,446 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:00:12,550 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 21:00:13,344 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:00:13,638 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:00:13,691 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:00:13,722 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:13] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 21:00:14,057 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:00:14,115 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:14] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-04 21:00:21,074 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-04 21:00:21,075 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for Book1.xlsx
2025-10-04 21:00:21,075 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: 'DuckDBService' object has no attribute 'analyze_file'
2025-10-04 21:00:21,109 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:00:21] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:03:24,756 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:03:25,115 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:03:26,168 - numexpr.utils - INFO - NumExpr defaulting to 12 threads.
2025-10-04 21:03:35,680 - numexpr.utils - INFO - NumExpr defaulting to 12 threads.
2025-10-04 21:05:16,360 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:05:16,468 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:05:18,621 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:05:18,727 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:05:18,827 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:05:19,023 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:05:19,107 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:05:19,110 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:05:19,871 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:05:19,871 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:05:19,871 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:05:19,872 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:05:19,872 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:05:19,872 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:05:19,872 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:05:19,872 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:05:19,899 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:05:19,899 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:05:19,902 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:05:20,695 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:05:20,712 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:05:22,411 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:05:22,515 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:05:22,615 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:05:22,821 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:05:22,891 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:05:22,896 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:05:23,712 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:05:23,712 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:05:23,713 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:05:23,713 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:05:23,713 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:05:23,713 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:05:23,713 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:05:23,713 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:05:23,728 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:05:23,741 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:05:26,450 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:05:26,691 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:05:26,774 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:05:26,839 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:05:26,847 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:05:26,848 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:05:26,848 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:05:26,848 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:05:26,848 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:05:26,924 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:26] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:05:27,025 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:05:27,156 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:05:27,325 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:05:27,325 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:05:27,325 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:05:27,325 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:05:27,326 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:05:27,445 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:27] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:05:37,787 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_14_07.xlsx by user vamsi@gmail.com
2025-10-04 21:05:37,787 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_14_07.xlsx
2025-10-04 21:05:37,788 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: 'DuckDBService' object has no attribute 'analyze_file'
2025-10-04 21:05:37,813 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:05:37] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:08:40,954 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:08:40,977 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:08:42,485 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:08:42,525 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:08:42,564 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:08:42,640 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:08:42,746 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:08:42,750 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:08:43,449 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:08:43,450 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:08:43,450 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:08:43,450 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:08:43,450 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:08:43,450 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:08:43,450 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:08:43,451 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:08:43,502 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:08:43,503 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:08:43,507 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:08:44,447 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:08:44,474 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:08:45,567 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:08:45,606 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:08:45,644 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:08:45,716 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:08:45,778 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:08:45,781 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:08:46,474 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:08:46,474 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:08:46,474 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:08:46,474 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:08:46,475 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:08:46,475 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:08:46,475 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:08:46,475 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:08:46,483 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:08:46,491 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:09:25,473 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:09:25,714 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:09:25,801 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:09:25,877 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:09:25,878 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:09:25,878 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:09:25,878 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:09:25,879 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:09:25,893 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:09:25,954 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:25] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:09:26,046 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:09:26,225 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:09:26,263 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:09:26,264 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:09:26,264 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:09:26,264 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:09:26,264 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:09:26,320 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:26] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:09:29,558 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_14_07.xlsx by user vamsi@gmail.com
2025-10-04 21:09:29,558 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_14_07.xlsx
2025-10-04 21:09:29,558 - __main__ - INFO - Starting DuckDB analysis for file: 1e53d379-a61d-4941-925a-36812b8beb03_test_14_07.xlsx
2025-10-04 21:09:30,753 - __main__ - INFO - File analysis completed: 4 rows, 7 columns
2025-10-04 21:09:30,771 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 4, Columns: 7
2025-10-04 21:09:30,772 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:09:30,815 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-04 21:09:30,842 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:09:30] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:11:51,882 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:11:51,919 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:11:53,131 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:11:53,163 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:11:53,196 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:11:53,257 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:11:53,331 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:11:53,334 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:11:54,009 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:11:54,010 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:11:54,010 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:11:54,010 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:11:54,010 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:11:54,011 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:11:54,011 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:11:54,011 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:11:54,031 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:11:54,032 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:11:54,034 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:11:54,726 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:11:54,741 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:11:55,700 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:11:55,741 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:11:55,783 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:11:55,861 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:11:55,916 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:11:55,919 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:11:56,584 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:11:56,584 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:11:56,585 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:11:56,585 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:11:56,585 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:11:56,585 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:11:56,585 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:11:56,585 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:11:56,592 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:11:56,598 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:12:21,175 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_04-07.xlsx by user vamsi@gmail.com
2025-10-04 21:12:21,175 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_04-07.xlsx
2025-10-04 21:12:21,175 - __main__ - INFO - Starting DuckDB analysis for file: 305e4e90-a4dc-427e-9931-6766ca9be0de_test_04-07.xlsx
2025-10-04 21:12:21,550 - __main__ - INFO - File analysis completed: 3 rows, 4 columns
2025-10-04 21:12:21,563 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 4
2025-10-04 21:12:21,563 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:12:21,611 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 21:12:21,651 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'file_path'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-04 21:12:21,681 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:12:21] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:16:27,130 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:16:27,373 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:16:28,573 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:16:28,593 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:16:29,573 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:16:29,606 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:16:29,654 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:16:29,718 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:16:29,790 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:16:29,794 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:16:30,508 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:16:30,508 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:16:30,508 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:16:30,509 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:16:30,509 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:16:30,509 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:16:30,509 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:16:30,509 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:16:30,522 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:16:30,529 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:16:37,599 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:16:37,614 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:16:38,760 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:16:38,800 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:16:38,837 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:16:38,910 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:16:38,966 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:16:38,969 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:16:39,634 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:16:39,635 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:16:39,635 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:16:39,635 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:16:39,635 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:16:39,635 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:16:39,635 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:16:39,636 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:16:39,654 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:16:39,655 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:16:39,657 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:16:40,332 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:16:40,348 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:16:41,417 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:16:41,460 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:16:41,503 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:16:41,587 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:16:41,644 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:16:41,648 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:16:42,365 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:16:42,366 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:16:42,366 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:16:42,366 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:16:42,366 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:16:42,366 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:16:42,367 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:16:42,367 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:16:42,375 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:16:42,380 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:16:47,357 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: 31-07.xlsx by user vamsi@gmail.com
2025-10-04 21:16:47,357 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for 31-07.xlsx
2025-10-04 21:16:47,358 - __main__ - INFO - Starting DuckDB analysis for file: c2580973-3afb-49db-85cf-b781dc1999ee_31-07.xlsx
2025-10-04 21:16:47,703 - __main__ - INFO - File analysis completed: 3 rows, 3 columns
2025-10-04 21:16:47,704 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 3
2025-10-04 21:16:47,704 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:16:47,750 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 21:16:47,795 - rule_configuration_endpoints - ERROR - [ERROR] File upload for rule configuration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'template_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.excel_templates'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-04 21:16:47,859 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:16:47] "[35m[1mPOST /api/rule-config/upload HTTP/1.1[0m" 500 -
2025-10-04 21:22:10,201 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:22:10,281 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:22:11,638 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:22:11,668 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:22:11,697 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:22:11,753 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:22:11,848 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:22:11,852 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:22:12,565 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:22:12,565 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:22:12,565 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:22:12,565 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:22:12,565 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:22:12,565 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:22:12,566 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:22:12,566 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:22:12,586 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:22:12,586 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:22:12,589 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:22:13,443 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:22:13,461 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:22:14,603 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:22:14,647 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:22:14,690 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:22:14,772 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:22:14,867 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:22:14,872 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:22:15,647 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:22:15,648 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:22:15,648 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:22:15,648 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:22:15,648 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:22:15,648 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:22:15,648 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:22:15,648 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:22:15,661 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:22:15,668 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:22:25,490 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_10-07.xlsx by user vamsi@gmail.com
2025-10-04 21:22:25,490 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_10-07.xlsx
2025-10-04 21:22:25,490 - __main__ - INFO - Starting DuckDB analysis for file: 655f4c8d-d45d-4594-af27-d5f2c46ffc73_test_10-07.xlsx
2025-10-04 21:22:25,864 - __main__ - INFO - File analysis completed: 4 rows, 6 columns
2025-10-04 21:22:25,875 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 4, Columns: 6
2025-10-04 21:22:25,876 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:22:25,920 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 21:22:26,103 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=6, Name=test_10-07
2025-10-04 21:22:26,156 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:22:26] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-04 21:22:26,451 - rule_configuration_endpoints - ERROR - Failed to get template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'file_path'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-04 21:22:26,465 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:22:26] "[35m[1mGET /api/rule-config/get-template/6 HTTP/1.1[0m" 500 -
2025-10-04 21:22:26,780 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:22:26] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:22:26,831 - rule_configuration_endpoints - ERROR - Failed to get template: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'file_path'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-04 21:22:26,843 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:22:26] "[35m[1mGET /api/rule-config/get-template/6 HTTP/1.1[0m" 500 -
2025-10-04 21:22:27,152 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:22:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:26:14,449 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:26:14,553 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:26:15,918 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:26:15,951 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:26:16,030 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:26:16,088 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:26:16,167 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:26:16,171 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:26:16,932 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:26:16,932 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:26:16,933 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:26:16,933 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:26:16,933 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:26:16,933 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:26:16,933 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:26:16,934 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:26:16,962 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:26:16,963 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:26:16,966 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:26:17,936 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:26:17,957 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:26:18,964 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:26:19,005 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:26:19,044 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:26:19,119 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:26:19,179 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:26:19,183 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:26:19,897 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:26:19,897 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:26:19,898 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:26:19,898 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:26:19,898 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:26:19,898 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:26:19,898 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:26:19,898 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:26:19,909 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:26:19,917 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:26:27,905 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:26:27,917 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:26:27,948 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:26:27,948 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:26:27,948 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:26:27,949 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:26:27,949 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:26:27,949 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 21:26:28,015 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:28] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:26:28,166 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:26:28,250 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:26:28,290 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:26:28,291 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:26:28,291 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:26:28,291 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:26:28,291 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:26:28,292 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 21:26:28,343 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:28] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:26:31,561 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test24-7.xlsx by user vamsi@gmail.com
2025-10-04 21:26:31,561 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test24-7.xlsx
2025-10-04 21:26:31,561 - __main__ - INFO - Starting DuckDB analysis for file: 76fcf226-261b-4c12-9d17-e1a192685cd1_test24-7.xlsx
2025-10-04 21:26:31,926 - __main__ - INFO - File analysis completed: 5 rows, 5 columns
2025-10-04 21:26:31,938 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 5, Columns: 5
2025-10-04 21:26:31,939 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:26:31,978 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 21:26:32,137 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=7, Name=test24-7
2025-10-04 21:26:32,188 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:32] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-04 21:26:32,371 - rule_configuration_endpoints - ERROR - Failed to get template: Expecting value: line 1 column 1 (char 0)
2025-10-04 21:26:32,434 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:32] "[35m[1mGET /api/rule-config/get-template/7 HTTP/1.1[0m" 500 -
2025-10-04 21:26:32,696 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:32] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:26:32,793 - rule_configuration_endpoints - ERROR - Failed to get template: Expecting value: line 1 column 1 (char 0)
2025-10-04 21:26:32,844 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:32] "[35m[1mGET /api/rule-config/get-template/7 HTTP/1.1[0m" 500 -
2025-10-04 21:26:33,069 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:26:33] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:33:36,206 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:33:36,676 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:33:38,161 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:33:38,258 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:33:42,024 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:33:42,085 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:33:42,117 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:33:42,181 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:33:42,279 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:33:42,282 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:33:43,092 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:33:43,093 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:33:43,093 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:33:43,093 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:33:43,093 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:33:43,093 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:33:43,094 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:33:43,094 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:33:43,118 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:33:43,142 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:34:26,614 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:34:26,836 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:34:27,875 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:34:27,895 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:34:29,195 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:34:29,234 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:34:29,272 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:34:29,345 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:34:29,408 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:34:29,411 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:34:30,151 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:34:30,152 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:34:30,152 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:34:30,152 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:34:30,152 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:34:30,153 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:34:30,153 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:34:30,153 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:34:30,162 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:34:30,167 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:35:26,359 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:35:26,376 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:35:27,381 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:35:27,415 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:35:27,489 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:35:27,549 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:35:27,607 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:35:27,611 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:35:28,279 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:35:28,279 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:35:28,279 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:35:28,279 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:35:28,280 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:35:28,280 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:35:28,280 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:35:28,280 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:35:28,294 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:35:28,294 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:35:28,296 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:35:28,972 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:35:28,989 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:35:30,087 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:35:30,123 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:35:30,157 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:35:30,223 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:35:30,275 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:35:30,279 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:35:30,950 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:35:30,950 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:35:30,950 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:35:30,951 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:35:30,951 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:35:30,951 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:35:30,951 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:35:30,951 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:35:30,959 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:35:30,964 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:35:33,733 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:35:33,745 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:35:33,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:35:33,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:35:33,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:35:33,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:35:33,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:35:33,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 21:35:33,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=7, Name=test24-7, File=test24-7.xlsx, Columns=0, Rules=0
2025-10-04 21:35:33,777 - rule_configuration_endpoints - INFO - [HISTORY] Found 7 configured templates
2025-10-04 21:35:33,822 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:33] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:35:33,990 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:35:34,081 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 21:35:34,120 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:35:34,120 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 21:35:34,120 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 21:35:34,120 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 21:35:34,120 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 21:35:34,121 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 21:35:34,121 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=7, Name=test24-7, File=test24-7.xlsx, Columns=0, Rules=0
2025-10-04 21:35:34,121 - rule_configuration_endpoints - INFO - [HISTORY] Found 7 configured templates
2025-10-04 21:35:34,165 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:34] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 21:35:37,525 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test24-7.xlsx by user vamsi@gmail.com
2025-10-04 21:35:37,525 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test24-7.xlsx
2025-10-04 21:35:37,526 - __main__ - INFO - Starting DuckDB analysis for file: 94d385b9-b86d-403a-b180-00d02a8c676c_test24-7.xlsx
2025-10-04 21:35:37,940 - __main__ - INFO - File analysis completed: 5 rows, 5 columns
2025-10-04 21:35:37,952 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 5, Columns: 5
2025-10-04 21:35:37,953 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 21:35:37,988 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 21:35:38,134 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=8, Name=test24-7
2025-10-04 21:35:38,183 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:38] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-04 21:35:38,446 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:38] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:35:38,683 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:38] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:35:38,886 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:38] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:35:39,045 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:39] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:35:39,316 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:39] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:35:46,613 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:46] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:35:47,033 - rule_configuration_endpoints - ERROR - Header selection failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'column_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.template_columns'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-04 21:35:47,082 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:35:47] "[35m[1mPOST /api/rule-config/select-headers HTTP/1.1[0m" 500 -
2025-10-04 21:38:22,996 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:38:23,206 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:38:24,741 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:38:24,769 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:38:26,282 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:38:26,322 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:38:26,363 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:38:26,442 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:38:26,510 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:38:26,513 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:38:27,223 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:38:27,224 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:38:27,224 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:38:27,225 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:38:27,225 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:38:27,225 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:38:27,225 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:38:27,225 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:38:27,236 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:38:27,242 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:39:36,607 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:39:36,707 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:39:38,049 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:39:38,092 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:39:38,132 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:39:38,210 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:39:38,270 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:39:38,274 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:39:39,062 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:39:39,063 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:39:39,063 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:39:39,063 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:39:39,063 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:39:39,063 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:39:39,064 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:39:39,064 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:39:39,088 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 21:39:39,088 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 21:39:39,094 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:39:40,164 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:39:40,186 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:39:41,111 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:39:41,149 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:39:41,182 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:39:41,244 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:39:41,483 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:39:41,495 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:39:42,454 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:39:42,456 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:39:42,456 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:39:42,456 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:39:42,457 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:39:42,457 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:39:42,457 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:39:42,457 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:39:42,471 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:39:42,482 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 21:39:44,363 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:39:44] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:39:45,030 - rule_configuration_endpoints - INFO - Headers selected for template 8: ['Name ', 'Date', 'num1']
2025-10-04 21:39:45,072 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:39:45] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:39:45,307 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:39:45] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:48:10,228 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:48:10,415 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:48:10,592 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 21:48:10,616 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:10] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 21:48:10,663 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:10] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:48:10,694 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:10] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:48:11,087 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:11] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:48:11,520 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:11] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:48:16,882 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:16] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:48:19,978 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:19] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:48:20,263 - rule_configuration_endpoints - INFO - Headers selected for template 8: ['Name ', 'Date']
2025-10-04 21:48:20,303 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:20] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:48:20,769 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:48:20] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:50:00,490 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:50:00,740 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:50:00,871 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 21:50:00,911 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:00] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 21:50:00,914 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:00] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:50:00,968 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:00] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 21:50:01,326 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:01] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:50:01,742 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:01] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:50:18,399 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 21:50:18,414 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:18] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 21:50:18,471 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:50:18] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:51:13,973 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:51:14,234 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:14] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 21:51:14,316 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 21:51:14,328 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:14] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 21:51:14,346 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 21:51:14,391 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:14] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 21:51:14,395 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:14] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:51:14,825 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:14] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:51:15,255 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:15] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:51:18,600 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:18] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:51:22,646 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:22] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:51:22,943 - rule_configuration_endpoints - INFO - Headers selected for template 8: ['Name ', 'Date']
2025-10-04 21:51:22,984 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:22] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 21:51:23,428 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 21:51:23] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 21:56:38,630 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 21:56:39,415 - werkzeug - INFO -  * Restarting with stat
2025-10-04 21:56:41,080 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 21:56:41,179 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 21:56:42,712 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 21:56:42,754 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 21:56:42,838 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 21:56:42,920 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 21:56:43,036 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 21:56:43,040 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 21:56:43,841 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 21:56:43,841 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 21:56:43,842 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 21:56:43,842 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 21:56:43,843 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 21:56:43,843 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 21:56:43,843 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 21:56:43,843 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 21:56:43,859 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 21:56:43,870 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:00:36,517 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 22:00:36,798 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:00:38,170 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:00:38,191 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:00:39,595 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:00:39,635 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:00:39,673 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:00:39,750 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:00:39,822 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:00:39,826 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:00:40,566 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:00:40,567 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:00:40,567 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:00:40,567 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:00:40,567 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:00:40,567 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:00:40,568 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:00:40,568 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:00:40,586 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:00:40,598 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:00:51,939 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 22:00:52,134 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:00:53,289 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:00:53,317 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:00:54,525 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:00:54,567 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:00:54,606 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:00:54,680 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:00:54,760 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:00:54,763 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:00:55,636 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:00:55,636 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:00:55,636 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:00:55,636 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:00:55,637 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:00:55,637 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:00:55,637 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:00:55,637 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:00:55,650 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:00:55,657 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:01:22,627 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:01:22,643 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:01:23,870 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:01:23,909 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:01:23,947 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:01:24,018 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:01:24,079 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:01:24,083 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:01:24,787 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:01:24,788 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:01:24,788 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:01:24,788 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:01:24,788 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:01:24,788 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:01:24,788 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:01:24,788 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:01:24,806 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-04 22:01:24,806 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-04 22:01:24,809 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:01:25,703 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:01:25,718 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:01:26,704 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:01:26,736 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:01:26,767 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:01:26,825 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:01:26,892 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:01:26,895 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:01:27,600 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:01:27,600 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:01:27,600 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:01:27,601 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:01:27,601 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:01:27,601 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:01:27,601 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:01:27,601 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:01:27,611 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:01:27,620 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:01:51,830 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:01:52,074 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:01:52,191 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 22:01:52,206 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:52] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 22:01:52,227 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('HY000', '[HY000] [Microsoft][ODBC Driver 18 for SQL Server]Connection is busy with results for another command (0) (SQLExecDirectW)')
2025-10-04 22:01:52,273 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:52] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-04 22:01:52,279 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:52] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:01:52,705 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:52] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:01:53,132 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:53] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:01:55,175 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:55] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:01:58,427 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:58] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 22:01:58,707 - rule_configuration_endpoints - INFO - Headers selected for template 8: ['Name ', 'Date']
2025-10-04 22:01:58,749 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:58] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 22:01:59,181 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:01:59] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:04:45,032 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:04:45] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:04:45,251 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:04:45] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-10-04 22:04:50,274 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:04:50] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:06:26,490 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-04 22:06:26,914 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:06:28,647 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:06:28,680 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:06:30,725 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:06:30,771 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:06:30,861 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:06:30,948 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:06:31,016 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:06:31,019 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:06:31,719 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:06:31,719 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:06:31,719 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:06:31,719 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:06:31,720 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:06:31,720 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:06:31,720 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:06:31,720 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:06:31,733 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:06:31,739 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:06:47,758 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-04 22:06:48,021 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:06:49,124 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:06:49,143 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:06:50,340 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:06:50,382 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:06:50,425 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:06:50,540 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:06:50,609 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:06:50,613 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:06:51,424 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:06:51,424 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:06:51,425 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:06:51,425 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:06:51,425 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:06:51,425 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:06:51,425 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:06:51,426 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:06:51,436 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:06:51,442 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:06:59,172 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:06:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:06:59,439 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:06:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:06:59,624 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:06:59] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:06:59,628 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:06:59] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:06:59,773 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:06:59] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:07:00,009 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:00] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:07:00,225 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:00] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:07:02,657 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:02] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:07:08,390 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:08] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 22:07:09,392 - rule_configuration_endpoints - INFO - Headers selected for template 8: ['Name ', 'Date', 'num1', 'num2', 'sum']
2025-10-04 22:07:09,442 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:09] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-04 22:07:09,605 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:09] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:07:31,821 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:31] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:07:32,154 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:32] "[31m[1mPOST /api/rule-config/configure-rules HTTP/1.1[0m" 400 -
2025-10-04 22:07:41,363 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:41] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:07:41,696 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:07:41] "[31m[1mPOST /api/rule-config/configure-rules HTTP/1.1[0m" 400 -
2025-10-04 22:09:53,419 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:09:53] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:09:53,504 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:09:53] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:10:19,828 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:10:19] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:10:20,024 - rule_configuration_endpoints - ERROR - Rule configuration failed: ('23000', "[23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Cannot insert the value NULL into column 'column_validation_id', table 'Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7.dbo.column_validation_rules'; column does not allow nulls. INSERT fails. (515) (SQLExecDirectW); [23000] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]The statement has been terminated. (3621)")
2025-10-04 22:10:20,119 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:10:20] "[35m[1mPOST /api/rule-config/configure-rules HTTP/1.1[0m" 500 -
2025-10-04 22:11:26,906 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-04 22:11:27,197 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:11:28,591 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:11:28,706 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:11:30,216 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:11:30,257 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:11:30,297 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:11:30,375 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:11:30,453 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:11:30,456 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:11:31,174 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:11:31,174 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:11:31,174 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:11:31,174 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:11:31,175 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:11:31,175 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:11:31,175 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:11:31,175 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:11:31,191 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:11:31,201 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:11:48,226 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-04 22:11:48,358 - werkzeug - INFO -  * Restarting with stat
2025-10-04 22:11:49,169 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-04 22:11:49,187 - __main__ - INFO - DuckDB memory tables initialized
2025-10-04 22:11:50,538 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-04 22:11:50,574 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-04 22:11:50,607 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-04 22:11:50,670 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-04 22:11:50,732 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-04 22:11:50,736 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-04 22:11:51,416 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-04 22:11:51,416 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-04 22:11:51,416 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-04 22:11:51,417 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-04 22:11:51,417 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-04 22:11:51,417 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-04 22:11:51,417 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-04 22:11:51,417 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-04 22:11:51,425 - werkzeug - WARNING -  * Debugger is active!
2025-10-04 22:11:51,430 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-04 22:11:56,801 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:11:56] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:11:58,513 - rule_configuration_endpoints - INFO - Rules configured for template 8: {'Name ': ['Required', 'Text'], 'Date': ['Required', 'Alphanumeric'], 'num1': ['Required', 'Int'], 'num2': ['Required', 'Int'], 'sum': ['Required', 'Int']}
2025-10-04 22:11:58,554 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:11:58] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:11:59,001 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:11:59] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:11:59,266 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:11:59] "GET /api/rule-config/get-template-rules/8 HTTP/1.1" 200 -
2025-10-04 22:12:02,860 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:02] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:12:04,240 - rule_configuration_endpoints - INFO - Rules configured for template 8: {'Date': ['Alphanumeric', 'Required'], 'Name ': ['Required', 'Text'], 'num1': ['Int', 'Required'], 'num2': ['Int', 'Required'], 'sum': ['Int', 'Required']}
2025-10-04 22:12:04,281 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:04] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:12:04,618 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:04,629 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:04] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:12:04,652 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:04,653 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:04,653 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:04,653 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:04,653 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:04,654 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 22:12:04,654 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 22:12:04,654 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=7, Name=test24-7, File=test24-7.xlsx, Columns=0, Rules=0
2025-10-04 22:12:04,654 - rule_configuration_endpoints - INFO - [HISTORY] Found 8 configured templates
2025-10-04 22:12:04,698 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:04] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:04,891 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:04] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:12:04,957 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:04,988 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 22:12:04,989 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 22:12:04,990 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=7, Name=test24-7, File=test24-7.xlsx, Columns=0, Rules=0
2025-10-04 22:12:04,990 - rule_configuration_endpoints - INFO - [HISTORY] Found 8 configured templates
2025-10-04 22:12:05,029 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:05] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:16,024 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:16] "OPTIONS /api/rule-config/delete/7 HTTP/1.1" 200 -
2025-10-04 22:12:16,349 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 7 for user vamsi@gmail.com
2025-10-04 22:12:16,496 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:16] "DELETE /api/rule-config/delete/7 HTTP/1.1" 200 -
2025-10-04 22:12:16,596 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:16,630 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:16,631 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:16,631 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:16,631 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:16,632 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:16,632 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 22:12:16,632 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=6, Name=test_10-07, File=test_10-07.xlsx, Columns=0, Rules=0
2025-10-04 22:12:16,632 - rule_configuration_endpoints - INFO - [HISTORY] Found 7 configured templates
2025-10-04 22:12:16,673 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:16] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:19,869 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:19] "OPTIONS /api/rule-config/delete/6 HTTP/1.1" 200 -
2025-10-04 22:12:19,888 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 6 for user vamsi@gmail.com
2025-10-04 22:12:20,031 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:20] "DELETE /api/rule-config/delete/6 HTTP/1.1" 200 -
2025-10-04 22:12:20,355 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:20,388 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:20,388 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:20,388 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:20,388 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:20,389 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=2, Name=Template_20251001_152928, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:20,389 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 22:12:20,389 - rule_configuration_endpoints - INFO - [HISTORY] Found 6 configured templates
2025-10-04 22:12:20,430 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:20] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:25,299 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:25] "OPTIONS /api/rule-config/delete/2 HTTP/1.1" 200 -
2025-10-04 22:12:25,656 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 2 for user vamsi@gmail.com
2025-10-04 22:12:25,798 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:25] "DELETE /api/rule-config/delete/2 HTTP/1.1" 200 -
2025-10-04 22:12:25,919 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:25,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:25,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:25,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:25,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:25,952 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=Template_20251001_150321, File=Unknown File, Columns=0, Rules=0
2025-10-04 22:12:25,952 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-04 22:12:25,995 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:25] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:29,305 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:29] "OPTIONS /api/rule-config/delete/1 HTTP/1.1" 200 -
2025-10-04 22:12:29,322 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 1 for user vamsi@gmail.com
2025-10-04 22:12:29,467 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:29] "DELETE /api/rule-config/delete/1 HTTP/1.1" 200 -
2025-10-04 22:12:29,795 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:29,826 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:29,826 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:29,826 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:29,826 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:29,826 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-04 22:12:29,868 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:29] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:36,252 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-04 22:12:36,253 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for Book1.xlsx
2025-10-04 22:12:36,253 - __main__ - INFO - Starting DuckDB analysis for file: c1a3ba37-cc97-4a8a-9441-19f389f63c0f_Book1.xlsx
2025-10-04 22:12:36,692 - __main__ - INFO - File analysis completed: 3 rows, 4 columns
2025-10-04 22:12:36,704 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 4
2025-10-04 22:12:36,704 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 22:12:36,737 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-04 22:12:36,867 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=9, Name=Book1
2025-10-04 22:12:36,911 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:36] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-04 22:12:37,162 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:37] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-04 22:12:37,404 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:37] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:12:37,591 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:37] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-04 22:12:37,761 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:37] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:12:38,007 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:38] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-04 22:12:42,052 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:42,062 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:12:42,085 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:42,085 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:42,085 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:42,086 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:42,086 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Book1, File=Book1.xlsx, Columns=0, Rules=0
2025-10-04 22:12:42,086 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-04 22:12:42,131 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:42] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:12:42,326 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:42] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:12:42,377 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:12:42,409 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:12:42,409 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:12:42,410 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:12:42,410 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:12:42,410 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Book1, File=Book1.xlsx, Columns=0, Rules=0
2025-10-04 22:12:42,410 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-04 22:12:42,452 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:12:42] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:17:32,566 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test24-7.xlsx by user vamsi@gmail.com
2025-10-04 22:17:32,566 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test24-7.xlsx
2025-10-04 22:17:32,566 - __main__ - INFO - Starting DuckDB analysis for file: 4bce9417-fbb8-427c-9120-2804645b6a87_test24-7.xlsx
2025-10-04 22:17:32,580 - __main__ - INFO - File analysis completed: 5 rows, 5 columns
2025-10-04 22:17:32,581 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 5, Columns: 5
2025-10-04 22:17:32,581 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-04 22:17:32,656 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Redirecting to Step 3 - 4 rules already configured
2025-10-04 22:17:32,700 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:32] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-04 22:17:32,923 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:32] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:17:33,187 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:17:33,354 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:17:33,385 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-template-rules/8 HTTP/1.1" 200 -
2025-10-04 22:17:33,560 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-04 22:17:33,770 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-template/8 HTTP/1.1" 200 -
2025-10-04 22:17:33,803 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:33] "GET /api/rule-config/get-template-rules/8 HTTP/1.1" 200 -
2025-10-04 22:17:34,227 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:34] "GET /api/rule-config/get-template-rules/8 HTTP/1.1" 200 -
2025-10-04 22:17:36,376 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:36] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:17:38,045 - rule_configuration_endpoints - INFO - Rules configured for template 8: {'Date': ['Alphanumeric', 'Required'], 'Name ': ['Required', 'Text'], 'num1': ['Int', 'Required'], 'num2': ['Int', 'Required'], 'sum': ['Int', 'Required']}
2025-10-04 22:17:38,084 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:38] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-04 22:17:38,419 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:17:38,430 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:17:38,451 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:17:38,451 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:17:38,451 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:17:38,451 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:17:38,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Book1, File=Book1.xlsx, Columns=0, Rules=0
2025-10-04 22:17:38,452 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-04 22:17:38,493 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:38] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:17:38,691 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:17:38,746 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:17:38,778 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:17:38,779 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=5, Name=Book1.xlsx, File=Unknown File, Columns=4, Rules=3
2025-10-04 22:17:38,779 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:17:38,779 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:17:38,779 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Book1, File=Book1.xlsx, Columns=0, Rules=0
2025-10-04 22:17:38,779 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-04 22:17:38,821 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:38] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:17:42,150 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:42] "OPTIONS /api/rule-config/delete/5 HTTP/1.1" 200 -
2025-10-04 22:17:42,162 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 5 for user vamsi@gmail.com
2025-10-04 22:17:42,305 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:42] "DELETE /api/rule-config/delete/5 HTTP/1.1" 200 -
2025-10-04 22:17:42,636 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:17:42,668 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:17:42,668 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:17:42,668 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:17:42,668 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Book1, File=Book1.xlsx, Columns=0, Rules=0
2025-10-04 22:17:42,669 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-04 22:17:42,712 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:42] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:17:47,434 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:47] "OPTIONS /api/rule-config/delete/9 HTTP/1.1" 200 -
2025-10-04 22:17:47,455 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 9 for user vamsi@gmail.com
2025-10-04 22:17:47,599 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:47] "DELETE /api/rule-config/delete/9 HTTP/1.1" 200 -
2025-10-04 22:17:47,920 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-04 22:17:47,953 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-04 22:17:47,954 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-04 22:17:47,954 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-04 22:17:47,954 - rule_configuration_endpoints - INFO - [HISTORY] Found 3 configured templates
2025-10-04 22:17:47,997 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:47] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-04 22:17:54,603 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:17:54,912 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-04 22:17:54,931 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-04 22:17:55,240 - werkzeug - INFO - 127.0.0.1 - - [04/Oct/2025 22:17:55] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 17:45:46,309 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 17:45:46,483 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 17:45:46,654 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 17:45:46,687 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 17:45:46,809 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 17:45:46,996 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 17:45:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:10:03,615 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:10:03,699 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:10:18,059 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:10:18,162 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:10:18,263 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:10:18,471 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:10:18,559 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:10:18,563 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:10:19,355 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:10:19,355 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:10:19,355 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:10:19,356 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:10:19,356 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:10:19,356 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:10:19,356 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:10:19,356 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:10:19,384 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 18:10:19,385 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 18:10:19,387 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:10:20,332 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:10:20,352 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:10:22,566 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:10:22,667 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:10:22,770 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:10:22,974 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:10:23,034 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:10:23,039 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:10:23,835 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:10:23,835 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:10:23,836 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:10:23,836 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:10:23,836 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:10:23,836 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:10:23,837 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:10:23,837 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:10:23,848 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:10:23,860 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:13:34,637 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:13:34,898 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:13:34,974 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:13:34,990 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:13:35,222 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:35] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:13:35,323 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:13:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:15:46,427 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:15:46,690 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:15:46,755 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:46] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:15:46,774 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:15:47,018 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:47] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:15:47,082 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:15:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:21:34,346 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:21:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:21:34,578 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:21:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:21:43,396 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:21:43,890 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:21:45,912 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:21:46,024 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:21:47,753 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:21:47,799 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:21:47,891 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:21:47,976 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:21:48,059 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:21:48,063 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:21:48,777 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:21:48,778 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:21:48,778 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:21:48,778 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:21:48,778 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:21:48,778 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:21:48,778 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:21:48,779 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:21:48,797 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:21:48,804 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:24:15,483 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:24:15,693 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:24:16,726 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:24:16,744 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:24:18,212 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:24:18,264 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:24:18,315 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:24:18,414 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:24:18,476 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:24:18,479 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:24:19,199 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:24:19,199 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:24:19,199 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:24:19,199 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:24:19,200 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:24:19,200 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:24:19,200 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:24:19,200 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:24:19,210 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:24:19,216 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:24:32,879 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:24:33,033 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:24:33,952 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:24:33,975 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:24:35,141 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:24:35,186 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:24:35,229 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:24:35,313 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:24:35,374 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:24:35,379 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:24:36,087 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:24:36,087 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:24:36,088 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:24:36,088 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:24:36,088 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:24:36,088 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:24:36,088 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:24:36,088 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:24:36,098 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:24:36,104 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:24:50,306 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:24:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:26:48,958 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:26:49,107 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:26:50,041 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:26:50,063 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:26:53,732 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:26:53,769 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:26:53,806 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:26:53,876 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:26:53,935 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:26:53,939 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:26:54,633 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:26:54,633 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:26:54,634 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:26:54,634 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:26:54,634 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:26:54,634 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:26:54,634 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:26:54,634 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:26:54,643 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:26:54,649 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:26:59,404 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:26:59,573 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:27:00,509 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:27:00,529 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:27:01,658 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:27:01,695 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:27:01,730 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:27:01,797 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:27:01,849 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:27:01,853 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:27:02,553 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:27:02,553 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:27:02,553 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:27:02,554 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:27:02,554 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:27:02,554 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:27:02,554 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:27:02,554 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:27:02,561 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:27:02,567 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:28:24,214 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:28:24,368 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:28:25,326 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:28:25,344 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:28:26,670 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:28:26,725 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:28:26,809 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:28:26,912 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:28:26,971 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:28:26,976 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:28:27,672 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:28:27,673 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:28:27,673 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:28:27,673 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:28:27,673 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:28:27,673 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:28:27,674 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:28:27,674 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:28:27,683 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:28:27,689 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:28:53,597 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:28:53,748 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:28:54,676 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:28:54,696 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:28:55,785 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:28:55,820 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:28:55,856 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:28:55,924 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:28:55,982 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:28:55,987 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:28:56,702 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:28:56,702 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:28:56,702 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:28:56,702 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:28:56,703 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:28:56,703 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:28:56,703 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:28:56,703 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:28:56,710 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:28:56,715 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:28:59,705 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 18:28:59,880 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:29:00,771 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:29:00,790 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:29:01,782 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:29:01,817 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:29:01,851 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:29:01,916 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:29:01,967 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:29:01,971 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:29:02,677 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:29:02,678 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:29:02,678 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:29:02,678 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:29:02,678 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:29:02,678 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:29:02,678 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:29:02,679 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:29:02,688 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:29:02,693 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:32:17,691 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:32:17,802 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:32:18,502 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:32:18,517 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:32:19,845 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:32:19,913 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:32:19,946 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:32:20,014 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:32:20,061 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:32:20,064 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:32:20,727 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:32:20,728 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:32:20,728 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:32:20,728 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:32:20,728 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:32:20,728 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:32:20,729 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:32:20,729 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:32:20,736 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:32:20,741 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:37:35,704 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:35,951 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:35] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:36,029 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:37:36,055 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:36,277 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:37:36,355 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:43,295 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:43] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:43,598 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:37:43,625 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:43] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:37:43,933 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:37:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:38:36,581 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:38:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:38:36,586 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:38:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:38:36,825 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:38:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:38:36,904 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:38:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:39:14,299 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:39:14,337 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:39:14,376 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:39:14] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:39:14,554 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:39:14,587 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:39:14,603 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:39:14] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:39:23,994 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:39:23] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:39:24,330 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:39:24] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:41:07,823 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:41:07] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:41:08,086 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:41:08] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:41:08,139 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:41:08,172 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:41:08,184 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:41:08] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:41:08,200 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:41:08,234 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:41:08,249 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:41:08] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:51:25,289 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:51:25,863 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:51:27,538 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:51:27,620 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:51:29,288 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:51:29,327 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:51:29,400 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:51:29,471 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:51:29,547 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:51:29,552 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:51:30,279 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:51:30,279 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:51:30,279 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:51:30,279 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:51:30,279 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:51:30,280 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:51:30,280 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:51:30,280 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:51:30,292 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:51:30,303 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:51:48,769 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:51:48,927 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:51:49,694 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:51:49,709 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:51:50,877 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:51:50,917 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:51:50,956 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:51:51,030 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:51:51,087 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:51:51,090 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:51:51,762 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:51:51,762 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:51:51,763 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:51:51,763 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:51:51,763 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:51:51,763 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:51:51,763 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:51:51,763 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:51:51,770 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:51:51,775 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:51:57,942 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:51:58,209 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:51:58,269 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:51:58,284 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:51:58,533 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:58] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:51:58,597 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:51:59,385 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:51:59,426 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:51:59,439 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:59] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:51:59,753 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:51:59,793 - data_validation_endpoints - ERROR - Failed to fetch validation history: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_original_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'lakehouse_corrected_path'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'total_rows'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'status'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-05 18:51:59,804 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:51:59] "[35m[1mGET /api/data-validation/history HTTP/1.1[0m" 500 -
2025-10-05 18:54:20,457 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:54:20,688 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:54:21,864 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:54:21,888 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:54:23,387 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:54:23,430 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:54:23,470 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:54:23,526 - __main__ - INFO - Updating validation_history table schema...
2025-10-05 18:54:23,610 - __main__ - INFO - Added lakehouse_original_path column
2025-10-05 18:54:23,653 - __main__ - INFO - Added lakehouse_corrected_path column
2025-10-05 18:54:23,696 - __main__ - INFO - Added status column
2025-10-05 18:54:23,783 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:54:23,848 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:54:23,853 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:54:24,593 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:54:24,593 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:54:24,593 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:54:24,594 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:54:24,594 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:54:24,594 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:54:24,594 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:54:24,594 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:54:24,610 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:54:24,621 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:54:42,388 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:54:42,561 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:54:43,558 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:54:43,577 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:54:44,708 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:54:44,743 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_history', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-05 18:54:44,777 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:54:44,811 - __main__ - INFO - Dropping old validation_history table...
2025-10-05 18:54:44,996 - __main__ - INFO - Dropped old validation_history table
2025-10-05 18:54:45,071 - __main__ - INFO - Created validation_history table
2025-10-05 18:54:45,231 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:54:45,299 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:54:45,302 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:54:46,006 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:54:46,007 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:54:46,007 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:54:46,007 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:54:46,007 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:54:46,007 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:54:46,008 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:54:46,008 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:54:46,019 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:54:46,027 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:55:09,792 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:55:09,811 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:55:10,973 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:55:11,013 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 18:55:11,053 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:55:11,286 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:55:11,334 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:55:11,338 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:55:12,008 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:55:12,008 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:55:12,008 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:55:12,009 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:55:12,009 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:55:12,009 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:55:12,009 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:55:12,009 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:55:12,023 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 18:55:12,024 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 18:55:12,025 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:55:12,728 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:55:12,745 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:55:13,835 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:55:13,874 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 18:55:13,911 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:55:14,131 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:55:14,180 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:55:14,183 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:55:14,856 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:55:14,857 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:55:14,857 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:55:14,857 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:55:14,857 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:55:14,857 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:55:14,857 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:55:14,858 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:55:14,866 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:55:14,871 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:55:22,279 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:22,537 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:22,603 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:55:22,627 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:22,869 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 18:55:22,925 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:31,766 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:55:31,807 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:55:31,847 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:31] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 18:55:32,030 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:55:32,067 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:55:32,112 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:32] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 18:55:48,830 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-05 18:55:49,297 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 18:55:49,298 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 18:55:49,298 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 18:55:49,351 - data_validation_endpoints - WARNING - [TEMPLATE LOOKUP] [NOT FOUND] No template matches the file structure
2025-10-05 18:55:49,351 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded headers: ['name ', 'cgst', 'sgst', 'gst']
2025-10-05 18:55:49,398 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:49] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-05 18:55:55,962 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Book1.xlsx by user vamsi@gmail.com
2025-10-05 18:55:55,972 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 18:55:55,973 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 18:55:55,973 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 18:55:56,014 - data_validation_endpoints - WARNING - [TEMPLATE LOOKUP] [NOT FOUND] No template matches the file structure
2025-10-05 18:55:56,014 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded headers: ['name ', 'cgst', 'sgst', 'gst']
2025-10-05 18:55:56,062 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:56] "[33mPOST /api/data-validation/upload HTTP/1.1[0m" 404 -
2025-10-05 18:55:57,459 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-05 18:55:57,471 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:57,533 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-05 18:55:57,533 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-05 18:55:57,534 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-05 18:55:57,534 - rule_configuration_endpoints - INFO - [HISTORY] Found 3 configured templates
2025-10-05 18:55:57,581 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:57] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-05 18:55:57,714 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:55:57,798 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-05 18:55:57,836 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-05 18:55:57,836 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-05 18:55:57,837 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-05 18:55:57,837 - rule_configuration_endpoints - INFO - [HISTORY] Found 3 configured templates
2025-10-05 18:55:57,883 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:55:57] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-05 18:56:00,145 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:56:00,184 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:56:00,229 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:56:00] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 18:56:00,544 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:56:00,580 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:56:00,627 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:56:00] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 18:56:10,674 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 18:56:10,682 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 18:56:10,683 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 18:56:10,683 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 18:56:10,720 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 18:56:10,720 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 18:56:10,720 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 18:56:10,720 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 18:56:12,080 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 18:56:12,384 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8ef54d14-0bd0-4a50-88fc-14cc90fc6900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:26:14 GMT'
    'Content-Length': '1753'
2025-10-05 18:56:12,402 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 18:56:12,567 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '10ab6221-64cf-4a53-9032-81ef69983200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:26:15 GMT'
    'Content-Length': '1693'
2025-10-05 18:56:12,567 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 18:56:12,568 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F659a9cf0-90c6-4e33-863a-2a5ae2c3ce3a%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dc6b72df-a1ee-11f0-b402-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 18:56:14,027 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:26:16 GMT'
    'ETag': '"0x8DE0412C37733D0"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8f708a44-f01f-0063-6bfb-35eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'dc6b72df-a1ee-11f0-b402-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:26:16 GMT'
2025-10-05 18:56:14,028 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F659a9cf0-90c6-4e33-863a-2a5ae2c3ce3a%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dd94c0da-a1ee-11f0-9de0-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 18:56:14,113 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8f708a4c-f01f-0063-73fb-35eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'dd94c0da-a1ee-11f0-9de0-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:26:16 GMT'
2025-10-05 18:56:14,114 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F659a9cf0-90c6-4e33-863a-2a5ae2c3ce3a%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0412C37733D0"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'dda1d1e0-a1ee-11f0-a7d7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 18:56:14,209 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:26:17 GMT'
    'ETag': '"0x8DE0412C393DFF9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '8f708a54-f01f-0063-7bfb-35eaf6000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'dda1d1e0-a1ee-11f0-a7d7-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:26:16 GMT'
2025-10-05 18:56:14,210 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/659a9cf0-90c6-4e33-863a-2a5ae2c3ce3a/date_SL.xlsx
2025-10-05 18:56:14,227 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 18:56:14,255 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 18:56:14,266 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 659a9cf0-90c6-4e33-863a-2a5ae2c3ce3a created with 3 rows ready for validation
2025-10-05 18:56:14,310 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:56:14] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 18:59:14,960 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:59:15,304 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:59:16,543 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:59:16,571 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:59:17,980 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:59:18,026 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 18:59:18,104 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:59:18,216 - __main__ - INFO - validation_history table ready
2025-10-05 18:59:18,270 - __main__ - INFO - validation_corrections table ready
2025-10-05 18:59:18,356 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:59:18,422 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:59:18,427 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:59:19,174 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:59:19,174 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:59:19,174 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:59:19,175 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:59:19,175 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:59:19,175 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:59:19,175 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:59:19,175 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:59:19,186 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:59:19,199 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:59:45,586 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-05 18:59:45,757 - werkzeug - INFO -  * Restarting with stat
2025-10-05 18:59:46,488 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 18:59:46,503 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 18:59:47,829 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 18:59:47,867 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 18:59:47,904 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 18:59:47,975 - __main__ - INFO - validation_history table ready
2025-10-05 18:59:48,011 - __main__ - INFO - validation_corrections table ready
2025-10-05 18:59:48,082 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 18:59:48,192 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 18:59:48,198 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 18:59:48,901 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 18:59:48,902 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 18:59:48,902 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 18:59:48,902 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 18:59:48,902 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 18:59:48,902 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 18:59:48,903 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 18:59:48,903 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 18:59:48,911 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 18:59:48,916 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 18:59:54,054 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:59:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:59:54,321 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:59:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 18:59:54,373 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:59:54,409 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:59:54,455 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:59:54] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 18:59:54,470 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 18:59:54,506 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 18:59:54,552 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 18:59:54] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:00:00,962 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:00:01,253 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:00:01,254 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:00:01,254 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:00:01,289 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:00:01,289 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:00:01,289 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:00:01,289 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:00:02,254 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:00:02,473 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '35905f1d-037a-4fb2-918b-94cd39573900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:30:04 GMT'
    'Content-Length': '1753'
2025-10-05 19:00:02,479 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:00:02,746 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '70d428ad-9bd0-4b20-b67f-4d95539c2f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:30:05 GMT'
    'Content-Length': '1687'
2025-10-05 19:00:02,746 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:00:02,747 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa8c29858-d321-4af0-83f5-1d94daf6bb32%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '659d1a2f-a1ef-11f0-ba99-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:00:03,868 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:30:06 GMT'
    'ETag': '"0x8DE04134C73A86C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6008eee3-601f-0045-34fc-355224000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '659d1a2f-a1ef-11f0-ba99-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:30:05 GMT'
2025-10-05 19:00:03,869 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa8c29858-d321-4af0-83f5-1d94daf6bb32%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6693ae2e-a1ef-11f0-b718-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:00:03,946 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6008eee5-601f-0045-36fc-355224000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6693ae2e-a1ef-11f0-b718-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:30:05 GMT'
2025-10-05 19:00:03,947 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa8c29858-d321-4af0-83f5-1d94daf6bb32%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04134C73A86C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '669f9a7f-a1ef-11f0-9eb8-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:00:04,038 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:30:06 GMT'
    'ETag': '"0x8DE04134C9018C9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6008eeed-601f-0045-3efc-355224000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '669f9a7f-a1ef-11f0-9eb8-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:30:05 GMT'
2025-10-05 19:00:04,038 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/a8c29858-d321-4af0-83f5-1d94daf6bb32/date_SL.xlsx
2025-10-05 19:00:04,051 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:00:04,062 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:00:04,072 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session a8c29858-d321-4af0-83f5-1d94daf6bb32 created with 3 rows ready for validation
2025-10-05 19:00:04,119 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:00:04] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:10:10,297 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:10:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:10:10,569 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:10:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:14:07,136 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:07] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:14:07,401 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:07] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:14:07,544 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:07] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:14:07,578 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:07] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:14:07,616 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:07] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:14:07,959 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:14:07,982 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 19:14:08,018 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:08] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:14:08,055 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:08] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:14:08,453 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:14:08] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:16:17,298 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 19:16:17,774 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:16:19,262 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:16:19,290 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:16:22,828 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:16:22,861 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:16:22,935 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:16:23,011 - __main__ - INFO - validation_history table ready
2025-10-05 19:16:23,043 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:16:23,104 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:16:23,262 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:16:23,266 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:16:24,044 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:16:24,044 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:16:24,045 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:16:24,045 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:16:24,045 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:16:24,045 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:16:24,046 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:16:24,046 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:16:24,070 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:16:24,078 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:18:29,530 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:18:29,778 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:18:29,955 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:29] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:18:29,961 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:29] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:18:30,015 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:30] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:18:30,337 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:18:30,379 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:30] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:18:30,389 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_a8c29858_d321_4af0_83f5_1d94daf6bb32 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_a8c29858_d321_4af0_83f5_1d94daf6bb32
                      ^
2025-10-05 19:18:30,389 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_a8c29858_d321_4af0_83f5_1d94daf6bb32 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_a8c29858_d321_4af0_83f5_1d94daf6bb32
                      ^
2025-10-05 19:18:30,435 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:30] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:18:30,803 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:18:30] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:19:41,379 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:19:41,412 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:19:41,453 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:19:41] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:19:41,633 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:19:41,664 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:19:41,705 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:19:41] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:19:47,580 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:19:47,905 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:19:47,906 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:19:47,906 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:19:47,938 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:19:47,938 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:19:47,938 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:19:47,938 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:19:49,053 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:19:49,282 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '959e5ccf-7c1b-4285-b83c-cee8d0f33b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:49:51 GMT'
    'Content-Length': '1753'
2025-10-05 19:19:49,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:19:49,461 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '21d5e70f-173c-40c3-ba92-bed1e8697000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:49:51 GMT'
    'Content-Length': '1688'
2025-10-05 19:19:49,462 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:19:49,462 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F827a4d36-b127-4fb8-982b-125a100c8c65%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '29004fb1-a1f2-11f0-89ba-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:19:50,496 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:49:53 GMT'
    'ETag': '"0x8DE04160FBBEB68"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e43f8f8d-501f-0061-18fe-35a484000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '29004fb1-a1f2-11f0-89ba-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:49:52 GMT'
2025-10-05 19:19:50,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F827a4d36-b127-4fb8-982b-125a100c8c65%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '29dcbc80-a1f2-11f0-bda4-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:19:50,574 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e43f8fa5-501f-0061-30fe-35a484000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '29dcbc80-a1f2-11f0-bda4-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:49:52 GMT'
2025-10-05 19:19:50,575 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F827a4d36-b127-4fb8-982b-125a100c8c65%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04160FBBEB68"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '29e8aaaf-a1f2-11f0-8c22-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:19:50,662 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:49:53 GMT'
    'ETag': '"0x8DE04160FD68D05"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e43f8fab-501f-0061-36fe-35a484000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '29e8aaaf-a1f2-11f0-8c22-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:49:52 GMT'
2025-10-05 19:19:50,662 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/827a4d36-b127-4fb8-982b-125a100c8c65/date_SL.xlsx
2025-10-05 19:19:50,676 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:19:50,698 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:19:50,711 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 827a4d36-b127-4fb8-982b-125a100c8c65 created with 3 rows ready for validation
2025-10-05 19:19:50,755 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:19:50] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:24:16,650 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\services\\duckdb_service.py', reloading
2025-10-05 19:24:16,913 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:24:18,090 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:24:18,112 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:24:19,592 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:24:19,628 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:24:19,702 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:24:19,780 - __main__ - INFO - validation_history table ready
2025-10-05 19:24:19,814 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:24:19,879 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:24:19,942 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:24:19,946 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:24:20,652 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:24:20,653 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:24:20,653 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:24:20,653 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:24:20,653 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:24:20,653 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:24:20,653 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:24:20,654 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:24:20,669 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:24:20,686 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:26:16,341 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 19:26:16,523 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:26:17,531 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:26:17,550 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:26:18,908 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:26:18,945 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:26:18,981 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:26:19,054 - __main__ - INFO - validation_history table ready
2025-10-05 19:26:19,094 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:26:19,169 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:26:19,229 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:26:19,233 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:26:19,955 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:26:19,955 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:26:19,956 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:26:19,956 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:26:19,956 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:26:19,956 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:26:19,956 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:26:19,956 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:26:19,964 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:26:19,970 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:27:38,011 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 19:27:38,178 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:27:39,130 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:27:39,152 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:27:40,538 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:27:40,579 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:27:40,620 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:27:40,699 - __main__ - INFO - validation_history table ready
2025-10-05 19:27:40,741 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:27:40,819 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:27:40,879 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:27:40,884 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:27:41,624 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:27:41,625 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:27:41,625 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:27:41,625 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:27:41,625 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:27:41,626 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:27:41,626 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:27:41,626 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:27:41,634 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:27:41,640 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:28:52,645 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:28:52,664 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:28:54,052 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:28:54,097 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:28:54,140 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:28:54,225 - __main__ - INFO - validation_history table ready
2025-10-05 19:28:54,268 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:28:54,351 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:28:54,417 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:28:54,422 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:28:55,174 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:28:55,174 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:28:55,174 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:28:55,175 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:28:55,175 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:28:55,175 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:28:55,175 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:28:55,175 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:28:55,196 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 19:28:55,196 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 19:28:55,199 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:28:56,257 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:28:56,278 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:28:57,556 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:28:57,601 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:28:57,646 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:28:57,732 - __main__ - INFO - validation_history table ready
2025-10-05 19:28:57,777 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:28:57,863 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:28:57,924 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:28:57,928 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:28:58,627 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:28:58,627 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:28:58,628 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:28:58,628 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:28:58,628 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:28:58,628 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:28:58,628 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:28:58,628 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:28:58,638 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:28:58,645 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:29:30,227 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:29:30,481 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:29:30,690 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:30] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:29:30,696 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:30] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:29:30,846 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:30] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:29:31,065 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:31] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:29:31,092 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:29:31,104 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_827a4d36_b127_4fb8_982b_125a100c8c65 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_827a4d36_b127_4fb8_982b_125a100c8c65
                      ^
2025-10-05 19:29:31,104 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_827a4d36_b127_4fb8_982b_125a100c8c65 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_827a4d36_b127_4fb8_982b_125a100c8c65
                      ^
2025-10-05 19:29:31,157 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:31] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:29:31,305 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:31] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:29:33,734 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:29:33,777 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:29:33,832 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:33] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:29:33,991 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:29:34,034 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:29:34,088 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:34] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:29:39,085 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:29:39,377 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:29:39,378 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:29:39,378 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:29:39,422 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:29:39,422 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:29:39,422 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:29:39,422 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:29:40,394 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:29:40,694 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a9e9993b-c2ee-401e-ad32-c2d4dfba5700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:59:42 GMT'
    'Content-Length': '1753'
2025-10-05 19:29:40,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:29:40,969 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9e82618d-d86b-4ec0-a5c4-130cd5194700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:59:43 GMT'
    'Content-Length': '1692'
2025-10-05 19:29:40,970 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:29:40,970 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F56834dce-3caf-4352-9cad-0ce69ad7b7ed%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8977b390-a1f3-11f0-b52d-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:29:42,076 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:59:44 GMT'
    'ETag': '"0x8DE0417705538B4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '977e40be-801f-0024-4b00-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8977b390-a1f3-11f0-b52d-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:59:44 GMT'
2025-10-05 19:29:42,077 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F56834dce-3caf-4352-9cad-0ce69ad7b7ed%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8a78a0e3-a1f3-11f0-bf81-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:29:42,150 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '977e40c7-801f-0024-5400-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8a78a0e3-a1f3-11f0-bf81-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:59:44 GMT'
2025-10-05 19:29:42,151 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F56834dce-3caf-4352-9cad-0ce69ad7b7ed%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0417705538B4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '8a83f1da-a1f3-11f0-a557-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:29:42,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 13:59:45 GMT'
    'ETag': '"0x8DE041770701611"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '977e40cb-801f-0024-5800-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '8a83f1da-a1f3-11f0-a557-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 13:59:44 GMT'
2025-10-05 19:29:42,239 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/56834dce-3caf-4352-9cad-0ce69ad7b7ed/date_SL.xlsx
2025-10-05 19:29:42,239 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/56834dce-3caf-4352-9cad-0ce69ad7b7ed/date_SL.xlsx
2025-10-05 19:29:42,240 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:29:42,249 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:29:42,249 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_56834dce_3caf_4352_9cad_0ce69ad7b7ed
2025-10-05 19:29:42,253 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:29:42,253 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 56834dce-3caf-4352-9cad-0ce69ad7b7ed created with 3 rows ready for validation
2025-10-05 19:29:42,309 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:29:42] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:31:45,109 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:31:45,368 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:31:45,503 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:45] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:31:45,584 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:45] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:31:45,587 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:45] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:31:45,971 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:31:45,982 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 19:31:46,038 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:46] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:31:46,078 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:46] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:31:46,532 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:31:46] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:32:41,862 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:32:41,877 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:32:43,231 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:32:43,275 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:32:43,320 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:32:43,402 - __main__ - INFO - validation_history table ready
2025-10-05 19:32:43,446 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:32:43,531 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:32:43,585 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:32:43,588 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:32:44,255 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:32:44,255 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:32:44,255 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:32:44,256 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:32:44,256 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:32:44,256 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:32:44,256 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:32:44,256 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:32:44,269 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 19:32:44,270 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 19:32:44,272 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:32:44,948 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:32:44,962 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:32:46,137 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:32:46,179 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:32:46,220 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:32:46,299 - __main__ - INFO - validation_history table ready
2025-10-05 19:32:46,340 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:32:46,418 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:32:46,464 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:32:46,467 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:32:47,133 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:32:47,134 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:32:47,134 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:32:47,134 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:32:47,134 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:32:47,134 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:32:47,134 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:32:47,135 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:32:47,142 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:32:47,146 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:33:27,253 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:33:27,522 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:27] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:33:27,665 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:33:27,700 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:27] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:33:27,742 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:33:28,073 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:33:28,084 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_56834dce_3caf_4352_9cad_0ce69ad7b7ed does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_56834dce_3caf_4352_9cad_0ce69ad7b7ed
                      ^
2025-10-05 19:33:28,084 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_56834dce_3caf_4352_9cad_0ce69ad7b7ed does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_56834dce_3caf_4352_9cad_0ce69ad7b7ed
                      ^
2025-10-05 19:33:28,137 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:28] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:33:28,175 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:28] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:33:28,618 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:28] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:33:30,616 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:30] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:33:30,621 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:33:30,865 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:30] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:33:30,942 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:33:31,572 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:33:31,613 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:33:31,663 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:31] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:33:31,976 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:33:32,016 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:33:32,064 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:32] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:33:38,004 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:33:38,259 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:33:38,260 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:33:38,260 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:33:38,300 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:33:38,301 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:33:38,301 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:33:38,301 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:33:39,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:33:39,447 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '603a9a73-bd13-4447-8a1f-1e6329a15a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:03:41 GMT'
    'Content-Length': '1753'
2025-10-05 19:33:39,452 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:33:39,622 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '87d48627-272b-4edb-903d-24bbd4823c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:03:41 GMT'
    'Content-Length': '1693'
2025-10-05 19:33:39,623 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:33:39,624 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd9890524-604e-45b9-ae5f-40cecb70ecb3%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '17c748bf-a1f4-11f0-aedf-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:33:40,802 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:03:43 GMT'
    'ETag': '"0x8DE0417FE9E8A8C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1da612ee-501f-002c-4c00-366b68000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '17c748bf-a1f4-11f0-aedf-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:03:43 GMT'
2025-10-05 19:33:40,803 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd9890524-604e-45b9-ae5f-40cecb70ecb3%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '18c3589d-a1f4-11f0-ae38-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:33:40,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1da612f5-501f-002c-5300-366b68000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '18c3589d-a1f4-11f0-ae38-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:03:43 GMT'
2025-10-05 19:33:40,873 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd9890524-604e-45b9-ae5f-40cecb70ecb3%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0417FE9E8A8C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '18ce1974-a1f4-11f0-9dc0-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:33:41,002 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:03:43 GMT'
    'ETag': '"0x8DE0417FEB95245"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1da612f7-501f-002c-5500-366b68000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '18ce1974-a1f4-11f0-9dc0-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:03:43 GMT'
2025-10-05 19:33:41,003 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/d9890524-604e-45b9-ae5f-40cecb70ecb3/date_SL.xlsx
2025-10-05 19:33:41,003 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/d9890524-604e-45b9-ae5f-40cecb70ecb3/date_SL.xlsx
2025-10-05 19:33:41,004 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:33:41,013 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:33:41,014 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_d9890524_604e_45b9_ae5f_40cecb70ecb3
2025-10-05 19:33:41,018 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:33:41,018 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session d9890524-604e-45b9-ae5f-40cecb70ecb3 created with 3 rows ready for validation
2025-10-05 19:33:41,068 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:33:41] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:35:56,322 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:35:56,570 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:35:56,651 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:35:56,668 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:35:56,899 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:35:56,977 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:35:58,040 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:35:58,080 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:35:58,134 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:58] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:35:58,451 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:35:58,490 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:35:58,540 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:35:58] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:36:05,653 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:36:05,663 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:36:05,664 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:36:05,664 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:36:05,706 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:36:05,707 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:36:05,707 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:36:05,707 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:36:05,710 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:36:05,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '38aad36d-bd86-4eee-945b-b83b757d6c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:08 GMT'
    'Content-Length': '1753'
2025-10-05 19:36:05,906 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:36:06,115 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5d1be1b2-dbed-496d-a75b-f29a69044600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:08 GMT'
    'Content-Length': '1692'
2025-10-05 19:36:06,116 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:36:06,116 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0e4402a9-fd14-4f9d-929f-007b6f8b19ff%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6f225cf9-a1f4-11f0-b762-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:36:07,234 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:06:09 GMT'
    'ETag': '"0x8DE041855E51710"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ff2fe4ae-001f-003a-4501-366d75000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6f225cf9-a1f4-11f0-b762-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:10 GMT'
2025-10-05 19:36:07,235 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0e4402a9-fd14-4f9d-929f-007b6f8b19ff%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '700b27f5-a1f4-11f0-8bca-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:36:07,318 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ff2fe4af-001f-003a-4601-366d75000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '700b27f5-a1f4-11f0-8bca-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:10 GMT'
2025-10-05 19:36:07,320 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0e4402a9-fd14-4f9d-929f-007b6f8b19ff%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041855E51710"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7017ff83-a1f4-11f0-bd19-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:36:07,415 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:06:10 GMT'
    'ETag': '"0x8DE04185602C6E1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ff2fe4b0-001f-003a-4701-366d75000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7017ff83-a1f4-11f0-bd19-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:10 GMT'
2025-10-05 19:36:07,416 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/0e4402a9-fd14-4f9d-929f-007b6f8b19ff/date_SL.xlsx
2025-10-05 19:36:07,417 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/0e4402a9-fd14-4f9d-929f-007b6f8b19ff/date_SL.xlsx
2025-10-05 19:36:07,417 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:36:07,425 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:36:07,426 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_0e4402a9_fd14_4f9d_929f_007b6f8b19ff
2025-10-05 19:36:07,429 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:36:07,429 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 0e4402a9-fd14-4f9d-929f-007b6f8b19ff created with 3 rows ready for validation
2025-10-05 19:36:07,479 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:07] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:36:21,656 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:36:21,913 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:36:21,973 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:36:22,013 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:36:22,063 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:22] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:36:22,075 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:36:22,117 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:36:22,169 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:22] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:36:31,034 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:36:31,042 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:36:31,043 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:36:31,043 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:36:31,082 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:36:31,083 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:36:31,083 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:36:31,083 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:36:31,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:36:31,313 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3d83eb17-0cb6-4533-b122-2a896d713d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:33 GMT'
    'Content-Length': '1753'
2025-10-05 19:36:31,314 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:36:31,454 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8e7f704b-85d3-4301-8154-bce1d2cd3a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:34 GMT'
    'Content-Length': '1693'
2025-10-05 19:36:31,455 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:36:31,455 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7dce5d71-0163-4040-8e84-a24ce4676abf%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7e42736c-a1f4-11f0-89ad-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:36:32,266 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:06:35 GMT'
    'ETag': '"0x8DE041864CFF294"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e6dc87a9-001f-0071-4801-36cd9d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7e42736c-a1f4-11f0-89ad-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:34 GMT'
2025-10-05 19:36:32,267 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7dce5d71-0163-4040-8e84-a24ce4676abf%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7ef6b44f-a1f4-11f0-b512-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:36:32,350 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e6dc87aa-001f-0071-4901-36cd9d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7ef6b44f-a1f4-11f0-b512-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:34 GMT'
2025-10-05 19:36:32,351 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7dce5d71-0163-4040-8e84-a24ce4676abf%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041864CFF294"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7f038cab-a1f4-11f0-a0a5-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:36:32,448 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:06:35 GMT'
    'ETag': '"0x8DE041864EE8DD1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e6dc87ab-001f-0071-4a01-36cd9d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7f038cab-a1f4-11f0-a0a5-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:06:34 GMT'
2025-10-05 19:36:32,449 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/7dce5d71-0163-4040-8e84-a24ce4676abf/date_SL.xlsx
2025-10-05 19:36:32,450 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/7dce5d71-0163-4040-8e84-a24ce4676abf/date_SL.xlsx
2025-10-05 19:36:32,450 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:36:32,457 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:36:32,457 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_7dce5d71_0163_4040_8e84_a24ce4676abf
2025-10-05 19:36:32,461 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:36:32,461 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 7dce5d71-0163-4040-8e84-a24ce4676abf created with 3 rows ready for validation
2025-10-05 19:36:32,512 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:36:32] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:38:32,314 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:38:32] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:38:32,577 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:38:32] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:11,435 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:11,700 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:11,828 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:11] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:39:11,882 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:11] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:39:11,921 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:11] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 19:39:12,276 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 19:39:12,279 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 19:39:12,333 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:12] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 19:39:12,370 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:12] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:39:12,822 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:12] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 19:39:15,978 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:15,983 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:16,240 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:16] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:16,304 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:16] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:16,751 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:39:16,791 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:39:16,844 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:16] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:39:17,164 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:39:17,204 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:39:17,256 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:17] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:39:24,243 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:39:24,252 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:39:24,252 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:39:24,252 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:39:24,293 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:39:24,293 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:39:24,294 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:39:24,294 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:39:24,298 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:39:24,499 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3546b3f4-e0e5-4f1e-9a00-0ea8df776300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:27 GMT'
    'Content-Length': '1753'
2025-10-05 19:39:24,500 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:39:24,639 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c1781604-ed10-4b4b-be46-720847e24000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:27 GMT'
    'Content-Length': '1693'
2025-10-05 19:39:24,640 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:39:24,640 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F08b513fe-6b0b-4a69-a1a3-950e0381fc0c%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e580782f-a1f4-11f0-9793-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:39:25,777 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:09:28 GMT'
    'ETag': '"0x8DE0418CC372D9C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f639f5a7-801f-001d-1101-36260a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e580782f-a1f4-11f0-9793-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:28 GMT'
2025-10-05 19:39:25,778 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F08b513fe-6b0b-4a69-a1a3-950e0381fc0c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e6626421-a1f4-11f0-acd9-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:39:25,856 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f639f5a9-801f-001d-1301-36260a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e6626421-a1f4-11f0-acd9-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:28 GMT'
2025-10-05 19:39:25,857 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F08b513fe-6b0b-4a69-a1a3-950e0381fc0c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0418CC372D9C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'e66e6499-a1f4-11f0-b788-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:39:25,945 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:09:28 GMT'
    'ETag': '"0x8DE0418CC585119"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f639f5ab-801f-001d-1501-36260a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'e66e6499-a1f4-11f0-b788-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:28 GMT'
2025-10-05 19:39:25,945 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/08b513fe-6b0b-4a69-a1a3-950e0381fc0c/date_SL.xlsx
2025-10-05 19:39:25,946 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/08b513fe-6b0b-4a69-a1a3-950e0381fc0c/date_SL.xlsx
2025-10-05 19:39:25,946 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:39:25,954 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:39:25,954 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_08b513fe_6b0b_4a69_a1a3_950e0381fc0c
2025-10-05 19:39:25,957 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:39:25,957 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 08b513fe-6b0b-4a69-a1a3-950e0381fc0c created with 3 rows ready for validation
2025-10-05 19:39:26,008 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:26] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:39:39,820 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:39] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:40,084 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:40,145 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:40,179 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:40,410 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:40,475 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:43,353 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:39:43,394 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:39:43,491 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:43] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:39:43,883 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:39:43,925 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:39:43,984 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:43] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:39:50,035 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:39:50,043 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:39:50,043 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:39:50,043 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:39:50,083 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:39:50,083 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:39:50,083 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:39:50,083 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:39:50,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:39:50,225 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '80419b1d-baf5-4851-8d9e-b34365203200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:52 GMT'
    'Content-Length': '1753'
2025-10-05 19:39:50,226 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:39:50,472 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7cf0a618-1c2c-4d71-9cbe-c1400b394b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:52 GMT'
    'Content-Length': '1687'
2025-10-05 19:39:50,473 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:39:50,473 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fae7cd428-2e0d-4659-b02b-646aa6f60777%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f4df6274-a1f4-11f0-8ee6-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:39:51,230 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:09:53 GMT'
    'ETag': '"0x8DE0418DB68E2CC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '83bb3352-e01f-000b-5f01-36d0dd000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f4df6274-a1f4-11f0-8ee6-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:54 GMT'
2025-10-05 19:39:51,231 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fae7cd428-2e0d-4659-b02b-646aa6f60777%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f58e28f1-a1f4-11f0-9dbd-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:39:51,308 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '83bb3353-e01f-000b-6001-36d0dd000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f58e28f1-a1f4-11f0-9dbd-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:54 GMT'
2025-10-05 19:39:51,309 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fae7cd428-2e0d-4659-b02b-646aa6f60777%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0418DB68E2CC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f59a0d8e-a1f4-11f0-8d98-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:39:51,395 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:09:54 GMT'
    'ETag': '"0x8DE0418DB83E439"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '83bb3354-e01f-000b-6101-36d0dd000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f59a0d8e-a1f4-11f0-8d98-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:09:54 GMT'
2025-10-05 19:39:51,395 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/ae7cd428-2e0d-4659-b02b-646aa6f60777/date_SL.xlsx
2025-10-05 19:39:51,396 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/ae7cd428-2e0d-4659-b02b-646aa6f60777/date_SL.xlsx
2025-10-05 19:39:51,396 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:39:51,405 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:39:51,405 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_ae7cd428_2e0d_4659_b02b_646aa6f60777
2025-10-05 19:39:51,409 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:39:51,409 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session ae7cd428-2e0d-4659-b02b-646aa6f60777 created with 3 rows ready for validation
2025-10-05 19:39:51,461 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:51] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:39:58,791 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:59,119 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:59,149 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:59,456 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:39:59,479 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:59] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 19:39:59,781 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:39:59] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:42:24,525 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:42:24,541 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:42:25,945 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:42:25,989 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:42:26,080 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:42:26,176 - __main__ - INFO - validation_history table ready
2025-10-05 19:42:26,218 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:42:26,298 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:42:26,365 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:42:26,369 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:42:27,121 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:42:27,121 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:42:27,121 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:42:27,121 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:42:27,122 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:42:27,122 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:42:27,122 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:42:27,122 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:42:27,138 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 19:42:27,138 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 19:42:27,140 - werkzeug - INFO -  * Restarting with stat
2025-10-05 19:42:27,873 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 19:42:27,888 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 19:42:29,018 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 19:42:29,055 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 19:42:29,088 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 19:42:29,154 - __main__ - INFO - validation_history table ready
2025-10-05 19:42:29,187 - __main__ - INFO - validation_corrections table ready
2025-10-05 19:42:29,251 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 19:42:29,304 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 19:42:29,308 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 19:42:30,020 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 19:42:30,020 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 19:42:30,020 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 19:42:30,020 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 19:42:30,021 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 19:42:30,021 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 19:42:30,021 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 19:42:30,021 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 19:42:30,029 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 19:42:30,035 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 19:42:31,457 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:42:31,489 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:42:31,532 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:42:31] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:42:31,721 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 19:42:31,753 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 19:42:31,796 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:42:31] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 19:42:38,019 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 19:42:38,427 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 19:42:38,428 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 19:42:38,428 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 19:42:38,461 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 19:42:38,461 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 19:42:38,461 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 19:42:38,461 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 19:42:39,585 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 19:42:39,898 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c14c1460-6a58-4563-9164-50b20d196200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:12:42 GMT'
    'Content-Length': '1753'
2025-10-05 19:42:39,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 19:42:40,155 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '186ad64a-0847-4d9e-8aab-25c529414900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:12:42 GMT'
    'Content-Length': '1692'
2025-10-05 19:42:40,155 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 19:42:40,156 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F94bacefb-a53a-40e9-8f24-32a4754b8420%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '59e6e90e-a1f5-11f0-bbfe-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:42:40,900 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:12:43 GMT'
    'ETag': '"0x8DE0419408A0F78"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '34c9916f-601f-0067-2102-363b4a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '59e6e90e-a1f5-11f0-bbfe-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:12:43 GMT'
2025-10-05 19:42:40,901 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F94bacefb-a53a-40e9-8f24-32a4754b8420%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5aafc91e-a1f5-11f0-a955-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 19:42:40,974 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '34c99170-601f-0067-2202-363b4a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5aafc91e-a1f5-11f0-a955-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:12:43 GMT'
2025-10-05 19:42:40,975 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F94bacefb-a53a-40e9-8f24-32a4754b8420%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE0419408A0F78"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5abb0b4d-a1f5-11f0-af06-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 19:42:41,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:12:43 GMT'
    'ETag': '"0x8DE041940A46F4D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '34c99171-601f-0067-2302-363b4a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5abb0b4d-a1f5-11f0-af06-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:12:43 GMT'
2025-10-05 19:42:41,060 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/94bacefb-a53a-40e9-8f24-32a4754b8420/date_SL.xlsx
2025-10-05 19:42:41,060 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/94bacefb-a53a-40e9-8f24-32a4754b8420/date_SL.xlsx
2025-10-05 19:42:41,060 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 19:42:41,069 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 19:42:41,069 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_94bacefb_a53a_40e9_8f24_32a4754b8420
2025-10-05 19:42:41,072 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 19:42:41,073 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 94bacefb-a53a-40e9-8f24-32a4754b8420 created with 3 rows ready for validation
2025-10-05 19:42:41,116 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:42:41] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 19:46:04,312 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:46:04] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 19:46:04,579 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 19:46:04] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:05:25,783 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:05:25,816 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:05:27,392 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:05:27,437 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:05:27,537 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:05:27,633 - __main__ - INFO - validation_history table ready
2025-10-05 20:05:27,678 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:05:27,749 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:05:27,830 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:05:27,835 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:05:28,539 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:05:28,539 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:05:28,539 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:05:28,539 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:05:28,539 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:05:28,539 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:05:28,540 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:05:28,540 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:05:28,558 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 20:05:28,558 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 20:05:28,560 - werkzeug - INFO -  * Restarting with stat
2025-10-05 20:05:29,489 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:05:29,510 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:05:30,529 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:05:30,567 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:05:30,604 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:05:30,677 - __main__ - INFO - validation_history table ready
2025-10-05 20:05:30,715 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:05:30,787 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:05:30,837 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:05:30,840 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:05:31,507 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:05:31,507 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:05:31,507 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:05:31,507 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:05:31,508 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:05:31,508 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:05:31,508 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:05:31,508 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:05:31,515 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 20:05:31,520 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 20:05:42,259 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:42] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-05 20:05:42,517 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:42] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-05 20:05:54,916 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:54] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-05 20:05:55,544 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-05 20:05:55,593 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:55] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-05 20:05:55,794 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:05:56,132 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:05:56,135 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:05:56,462 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:05:56,466 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:56] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:05:56,791 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:56] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:05:57,637 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:05:57,678 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:05:57,723 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:57] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:05:57,901 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:05:57,937 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:05:57,983 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:05:57] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:06:09,779 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 20:06:10,080 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 20:06:10,080 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 20:06:10,081 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 20:06:10,118 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 20:06:10,118 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 20:06:10,119 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 20:06:10,119 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 20:06:11,226 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 20:06:11,461 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b5943f7e-38f4-4fda-961d-bed586f96b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:36:13 GMT'
    'Content-Length': '1753'
2025-10-05 20:06:11,468 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 20:06:11,718 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b5c91ceb-c7ea-4a4f-afbe-6cece7543e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:36:13 GMT'
    'Content-Length': '1685'
2025-10-05 20:06:11,719 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 20:06:11,719 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2beac9d0-d9b1-4fcb-99a8-7647788ee17c%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a34e2fe8-a1f8-11f0-b7b0-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:06:13,087 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:36:15 GMT'
    'ETag': '"0x8DE041C8A3F42DC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd1a90882-801f-001b-5605-36490e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a34e2fe8-a1f8-11f0-b7b0-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:36:15 GMT'
2025-10-05 20:06:13,088 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2beac9d0-d9b1-4fcb-99a8-7647788ee17c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a46a58ef-a1f8-11f0-9eeb-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 20:06:13,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd1a90899-801f-001b-6d05-36490e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a46a58ef-a1f8-11f0-9eeb-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:36:15 GMT'
2025-10-05 20:06:13,176 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2beac9d0-d9b1-4fcb-99a8-7647788ee17c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041C8A3F42DC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a477e382-a1f8-11f0-8525-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:06:13,276 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:36:16 GMT'
    'ETag': '"0x8DE041C8A5E7639"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd1a908a0-801f-001b-7405-36490e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a477e382-a1f8-11f0-8525-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:36:15 GMT'
2025-10-05 20:06:13,277 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2beac9d0-d9b1-4fcb-99a8-7647788ee17c/date_SL.xlsx
2025-10-05 20:06:13,278 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2beac9d0-d9b1-4fcb-99a8-7647788ee17c/date_SL.xlsx
2025-10-05 20:06:13,278 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 20:06:13,300 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 20:06:13,300 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_2beac9d0_d9b1_4fcb_99a8_7647788ee17c
2025-10-05 20:06:13,304 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 20:06:13,304 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 2beac9d0-d9b1-4fcb-99a8-7647788ee17c created with 3 rows ready for validation
2025-10-05 20:06:13,353 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:06:13] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 20:07:28,311 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:07:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:07:28,574 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:07:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:08:55,122 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:08:55,381 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:08:55,532 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:55] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:08:55,572 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:55] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:08:55,611 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:55] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:08:55,952 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 20:08:55,966 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 20:08:56,011 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:56] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:08:56,049 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:56] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 20:08:56,446 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:08:56] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:09:00,231 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:09:00,272 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:09:00,320 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:00] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:09:00,488 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:09:00,526 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:09:00,574 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:00] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:09:06,601 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 20:09:06,613 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 20:09:06,613 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 20:09:06,613 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 20:09:06,651 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 20:09:06,652 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 20:09:06,652 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 20:09:06,652 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 20:09:06,655 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 20:09:06,938 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ccf9ea3d-1e6e-40a9-a8c5-a36dfa546800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:39:08 GMT'
    'Content-Length': '1753'
2025-10-05 20:09:06,939 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 20:09:07,242 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6a6ef973-b84e-40dc-8276-e2dccf214400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:39:09 GMT'
    'Content-Length': '1687'
2025-10-05 20:09:07,243 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 20:09:07,243 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa00b0784-8b71-472c-a167-183c4bd85752%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0bde95e3-a1f9-11f0-b9a0-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:09:08,082 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:39:10 GMT'
    'ETag': '"0x8DE041CF28EE850"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd9823f63-501f-0043-1305-36cdea000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0bde95e3-a1f9-11f0-b9a0-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:39:10 GMT'
2025-10-05 20:09:08,083 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa00b0784-8b71-472c-a167-183c4bd85752%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0cb889eb-a1f9-11f0-88c4-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 20:09:08,151 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd9823f70-501f-0043-2005-36cdea000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0cb889eb-a1f9-11f0-88c4-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:39:10 GMT'
2025-10-05 20:09:08,152 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fa00b0784-8b71-472c-a167-183c4bd85752%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041CF28EE850"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0cc3116b-a1f9-11f0-8c6f-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:09:08,252 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:39:11 GMT'
    'ETag': '"0x8DE041CF2AA6E39"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd9823f71-501f-0043-2105-36cdea000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0cc3116b-a1f9-11f0-8c6f-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:39:10 GMT'
2025-10-05 20:09:08,253 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/a00b0784-8b71-472c-a167-183c4bd85752/date_SL.xlsx
2025-10-05 20:09:08,253 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/a00b0784-8b71-472c-a167-183c4bd85752/date_SL.xlsx
2025-10-05 20:09:08,253 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 20:09:08,264 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 20:09:08,264 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_a00b0784_8b71_472c_a167_183c4bd85752
2025-10-05 20:09:08,265 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 20:09:08,266 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session a00b0784-8b71-472c-a167-183c4bd85752 created with 3 rows ready for validation
2025-10-05 20:09:08,305 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:08] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 20:09:08,773 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:08] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:09:08,849 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:08] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:09:09,037 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:09] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:09:09,217 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:09] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:09:09,245 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 20:09:09,247 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 20:09:09,294 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:09] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 20:09:09,346 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:09:09] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:10:38,687 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 20:10:39,043 - werkzeug - INFO -  * Restarting with stat
2025-10-05 20:10:40,392 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:10:40,409 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:10:42,117 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:10:42,170 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:10:42,232 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:10:42,343 - __main__ - INFO - validation_history table ready
2025-10-05 20:10:42,395 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:10:42,478 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:10:42,550 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:10:42,554 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:10:43,319 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:10:43,319 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:10:43,319 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:10:43,319 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:10:43,319 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:10:43,320 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:10:43,320 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:10:43,320 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:10:43,333 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 20:10:43,341 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 20:11:50,596 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:11:50,610 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:11:51,873 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:11:51,917 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:11:51,961 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:11:52,042 - __main__ - INFO - validation_history table ready
2025-10-05 20:11:52,083 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:11:52,164 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:11:52,213 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:11:52,216 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:11:52,879 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:11:52,879 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:11:52,879 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:11:52,879 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:11:52,879 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:11:52,880 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:11:52,880 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:11:52,880 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:11:52,892 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 20:11:52,892 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 20:11:52,894 - werkzeug - INFO -  * Restarting with stat
2025-10-05 20:11:53,567 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:11:53,585 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:11:54,639 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:11:54,680 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:11:54,720 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:11:54,798 - __main__ - INFO - validation_history table ready
2025-10-05 20:11:54,839 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:11:54,917 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:11:54,970 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:11:54,973 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:11:55,635 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:11:55,635 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:11:55,636 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:11:55,636 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:11:55,636 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:11:55,636 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:11:55,636 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:11:55,636 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:11:55,643 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 20:11:55,648 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 20:12:00,308 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:12:00,312 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:12:00,555 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:00] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:12:00,650 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:12:01,159 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:12:01,199 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:12:01,251 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:01] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:12:01,568 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:12:01,607 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:12:01,657 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:01] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:12:08,479 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 20:12:08,811 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 20:12:08,811 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 20:12:08,811 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 20:12:08,852 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 20:12:08,852 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 20:12:08,852 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 20:12:08,853 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 20:12:09,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 20:12:10,128 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'dd50c1bb-38c6-4820-9733-77e0cd154700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:42:12 GMT'
    'Content-Length': '1753'
2025-10-05 20:12:10,134 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 20:12:10,414 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '56119acd-09d6-4eec-bc69-79c9ab9f4200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:42:12 GMT'
    'Content-Length': '1687'
2025-10-05 20:12:10,415 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 20:12:10,415 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2b24c560-cb94-4945-afca-79198024d0e7%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '790d42d0-a1f9-11f0-88c6-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:12:11,485 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:42:14 GMT'
    'ETag': '"0x8DE041D5FD8070C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '90ce6923-b01f-001b-7206-36b9c4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '790d42d0-a1f9-11f0-88c6-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:42:13 GMT'
2025-10-05 20:12:11,487 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2b24c560-cb94-4945-afca-79198024d0e7%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7a09b318-a1f9-11f0-8db2-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 20:12:11,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '90ce6929-b01f-001b-7706-36b9c4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7a09b318-a1f9-11f0-8db2-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:42:13 GMT'
2025-10-05 20:12:11,566 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2b24c560-cb94-4945-afca-79198024d0e7%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041D5FD8070C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '7a15dd08-a1f9-11f0-99b7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:12:11,659 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:42:14 GMT'
    'ETag': '"0x8DE041D5FFC6751"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '90ce692b-b01f-001b-7906-36b9c4000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '7a15dd08-a1f9-11f0-99b7-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:42:14 GMT'
2025-10-05 20:12:11,659 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2b24c560-cb94-4945-afca-79198024d0e7/date_SL.xlsx
2025-10-05 20:12:11,660 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2b24c560-cb94-4945-afca-79198024d0e7/date_SL.xlsx
2025-10-05 20:12:11,660 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 20:12:11,670 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 20:12:11,670 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_2b24c560_cb94_4945_afca_79198024d0e7
2025-10-05 20:12:11,674 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 20:12:11,674 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 2b24c560-cb94-4945-afca-79198024d0e7 created with 3 rows ready for validation
2025-10-05 20:12:11,723 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:11] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 20:12:11,965 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:11] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:12:12,196 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:12] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:12:12,358 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 20:12:12,362 - data_validation_endpoints - ERROR - Error detection failed: 'error_count'
2025-10-05 20:12:12,408 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:12] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:12:12,448 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:12] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 20:12:12,565 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:12] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:12:12,849 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:12:12] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:13:18,717 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-05 20:13:18,972 - werkzeug - INFO -  * Restarting with stat
2025-10-05 20:13:19,853 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:13:19,875 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:13:23,365 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:13:23,423 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:13:23,490 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:13:23,606 - __main__ - INFO - validation_history table ready
2025-10-05 20:13:23,663 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:13:23,756 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:13:23,811 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:13:23,815 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:13:24,523 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:13:24,523 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:13:24,523 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:13:24,524 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:13:24,524 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:13:24,524 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:13:24,524 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:13:24,524 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:13:24,534 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 20:13:24,541 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 20:15:16,790 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:15:16,805 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:15:18,049 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:15:18,082 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:15:18,149 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:15:18,228 - __main__ - INFO - validation_history table ready
2025-10-05 20:15:18,261 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:15:18,323 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:15:18,372 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:15:18,375 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:15:19,038 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:15:19,039 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:15:19,039 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:15:19,039 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:15:19,039 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:15:19,039 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:15:19,040 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:15:19,040 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:15:19,052 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 20:15:19,052 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 20:15:19,054 - werkzeug - INFO -  * Restarting with stat
2025-10-05 20:15:19,702 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 20:15:19,716 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 20:15:20,768 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 20:15:20,813 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 20:15:20,853 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 20:15:20,931 - __main__ - INFO - validation_history table ready
2025-10-05 20:15:20,971 - __main__ - INFO - validation_corrections table ready
2025-10-05 20:15:21,048 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 20:15:21,117 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 20:15:21,120 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 20:15:21,788 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 20:15:21,788 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 20:15:21,789 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 20:15:21,789 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 20:15:21,789 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 20:15:21,789 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 20:15:21,789 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 20:15:21,789 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 20:15:21,796 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 20:15:21,801 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 20:15:25,714 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:15:25,718 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:25] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:15:25,969 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:25] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 20:15:26,044 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 20:15:26,544 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:15:26,588 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:15:26,638 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:26] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:15:26,954 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 20:15:26,993 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 20:15:27,042 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:27] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 20:15:32,541 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 20:15:32,778 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 20:15:32,778 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 20:15:32,779 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 20:15:32,819 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 20:15:32,820 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 20:15:32,820 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 20:15:32,820 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 20:15:33,720 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 20:15:33,989 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '610c1ebc-93ab-4d3d-b0a9-d2badfa94200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:45:36 GMT'
    'Content-Length': '1753'
2025-10-05 20:15:33,994 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 20:15:34,188 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'efb6067f-a11d-4a0e-a252-bf2d10da7000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:45:36 GMT'
    'Content-Length': '1688'
2025-10-05 20:15:34,189 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 20:15:34,190 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F44b24e84-e911-400f-8d2f-f996245bb34d%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f29405c6-a1f9-11f0-a6fe-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:15:35,376 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:45:38 GMT'
    'ETag': '"0x8DE041DD96694BC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e9b2a0ce-c01f-000c-5006-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f29405c6-a1f9-11f0-a6fe-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:45:37 GMT'
2025-10-05 20:15:35,377 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F44b24e84-e911-400f-8d2f-f996245bb34d%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f390f637-a1f9-11f0-9634-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 20:15:35,443 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e9b2a0cf-c01f-000c-5106-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f390f637-a1f9-11f0-9634-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:45:37 GMT'
2025-10-05 20:15:35,444 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F44b24e84-e911-400f-8d2f-f996245bb34d%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE041DD96694BC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'f39b284a-a1f9-11f0-ae65-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 20:15:35,528 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 14:45:38 GMT'
    'ETag': '"0x8DE041DD97F6C7D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'e9b2a0d0-c01f-000c-5206-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'f39b284a-a1f9-11f0-ae65-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 14:45:38 GMT'
2025-10-05 20:15:35,528 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/44b24e84-e911-400f-8d2f-f996245bb34d/date_SL.xlsx
2025-10-05 20:15:35,529 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/44b24e84-e911-400f-8d2f-f996245bb34d/date_SL.xlsx
2025-10-05 20:15:35,529 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 20:15:35,538 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 20:15:35,538 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_44b24e84_e911_400f_8d2f_f996245bb34d
2025-10-05 20:15:35,542 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 20:15:35,542 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 44b24e84-e911-400f-8d2f-f996245bb34d created with 3 rows ready for validation
2025-10-05 20:15:35,593 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:35] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 20:15:36,073 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:15:36,194 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:15:36,333 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 20:15:36,524 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 20:15:36,569 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 20:15:36,572 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 20:15:36,625 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 20:15:36,663 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 20:15:36] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:10,660 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 22:10:10,749 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 22:10:12,940 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 22:10:13,038 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 22:10:13,150 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 22:10:13,259 - __main__ - INFO - validation_history table ready
2025-10-05 22:10:13,304 - __main__ - INFO - validation_corrections table ready
2025-10-05 22:10:13,386 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 22:10:13,461 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 22:10:13,465 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 22:10:14,138 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 22:10:14,139 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 22:10:14,139 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 22:10:14,139 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 22:10:14,139 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 22:10:14,139 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 22:10:14,139 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 22:10:14,140 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 22:10:14,159 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 22:10:14,160 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 22:10:14,163 - werkzeug - INFO -  * Restarting with stat
2025-10-05 22:10:14,951 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 22:10:14,970 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 22:10:15,953 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 22:10:15,990 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 22:10:16,025 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 22:10:16,093 - __main__ - INFO - validation_history table ready
2025-10-05 22:10:16,128 - __main__ - INFO - validation_corrections table ready
2025-10-05 22:10:16,196 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 22:10:16,263 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 22:10:16,267 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 22:10:17,005 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 22:10:17,005 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 22:10:17,005 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 22:10:17,006 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 22:10:17,006 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 22:10:17,006 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 22:10:17,006 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 22:10:17,006 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 22:10:17,016 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 22:10:17,024 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 22:10:17,885 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:10:17,915 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:10:18,307 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:10:18,402 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:18,567 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:10:18,740 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:18,766 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 22:10:18,817 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_44b24e84_e911_400f_8d2f_f996245bb34d does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_44b24e84_e911_400f_8d2f_f996245bb34d
                      ^
2025-10-05 22:10:18,817 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_44b24e84_e911_400f_8d2f_f996245bb34d does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_44b24e84_e911_400f_8d2f_f996245bb34d
                      ^
2025-10-05 22:10:18,860 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 22:10:18,895 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:18] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:21,304 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:10:21,611 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 22:10:21,633 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:10:21,949 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:21] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 22:10:23,339 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 22:10:23,376 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 22:10:23,423 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:23] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 22:10:23,603 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 22:10:23,638 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 22:10:23,683 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:23] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 22:10:30,243 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 22:10:30,635 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 22:10:30,635 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 22:10:30,635 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 22:10:30,670 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 22:10:30,671 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 22:10:30,671 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 22:10:30,671 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 22:10:31,846 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 22:10:31,996 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9abb4156-7c62-4980-a63a-26fc511d4600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:40:34 GMT'
    'Content-Length': '1753'
2025-10-05 22:10:32,003 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 22:10:32,194 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a22c5663-aab4-4d6a-9408-4f60031d4a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:40:34 GMT'
    'Content-Length': '1692'
2025-10-05 22:10:32,195 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 22:10:32,196 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '022e7c63-a20a-11f0-b667-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 22:10:33,475 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 16:40:36 GMT'
    'ETag': '"0x8DE042DE91E9040"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'cfd0a410-001f-0003-6016-36cad2000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '022e7c63-a20a-11f0-b667-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:40:36 GMT'
2025-10-05 22:10:33,476 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '03274744-a20a-11f0-b24a-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 22:10:33,561 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'cfd0a41c-001f-0003-6c16-36cad2000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '03274744-a20a-11f0-b24a-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:40:36 GMT'
2025-10-05 22:10:33,562 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE042DE91E9040"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '03346f6e-a20a-11f0-b422-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 22:10:33,652 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 16:40:36 GMT'
    'ETag': '"0x8DE042DE93B823D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'cfd0a421-001f-0003-7116-36cad2000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '03346f6e-a20a-11f0-b422-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:40:36 GMT'
2025-10-05 22:10:33,653 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3/date_SL.xlsx
2025-10-05 22:10:33,653 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3/date_SL.xlsx
2025-10-05 22:10:33,653 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 22:10:33,672 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 22:10:33,672 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_19353d23_43f0_4dcc_b2bc_1f7c4dd65cd3
2025-10-05 22:10:33,674 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 22:10:33,675 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 19353d23-43f0-4dcc-b2bc-1f7c4dd65cd3 created with 3 rows ready for validation
2025-10-05 22:10:33,718 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:33] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 22:10:34,171 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:10:34,236 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:34,429 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:10:34,611 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:10:34,639 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 22:10:34,648 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 22:10:34,696 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 22:10:34,733 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:10:34] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:12:21,646 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 22:12:21,661 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 22:12:23,093 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 22:12:23,128 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 22:12:23,160 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 22:12:23,221 - __main__ - INFO - validation_history table ready
2025-10-05 22:12:23,253 - __main__ - INFO - validation_corrections table ready
2025-10-05 22:12:23,314 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 22:12:23,371 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 22:12:23,374 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 22:12:24,045 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 22:12:24,045 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 22:12:24,045 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 22:12:24,046 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 22:12:24,046 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 22:12:24,046 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 22:12:24,046 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 22:12:24,046 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 22:12:24,063 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.1.5:5000
2025-10-05 22:12:24,063 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-05 22:12:24,065 - werkzeug - INFO -  * Restarting with stat
2025-10-05 22:12:24,802 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-05 22:12:24,818 - __main__ - INFO - DuckDB memory tables initialized
2025-10-05 22:12:25,786 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-05 22:12:25,818 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-05 22:12:25,852 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-05 22:12:25,912 - __main__ - INFO - validation_history table ready
2025-10-05 22:12:25,944 - __main__ - INFO - validation_corrections table ready
2025-10-05 22:12:26,003 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-05 22:12:26,051 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-05 22:12:26,055 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-05 22:12:26,720 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-05 22:12:26,720 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-05 22:12:26,720 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-05 22:12:26,721 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-05 22:12:26,721 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-05 22:12:26,721 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-05 22:12:26,721 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-05 22:12:26,721 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-05 22:12:26,728 - werkzeug - WARNING -  * Debugger is active!
2025-10-05 22:12:26,733 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-05 22:12:38,737 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:12:38,742 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 22:12:38,949 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-05 22:12:39,059 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:39] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-05 22:12:39,770 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 22:12:39,802 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 22:12:39,843 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:39] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 22:12:40,168 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-05 22:12:40,199 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-05 22:12:40,240 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:40] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-05 22:12:56,555 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-05 22:12:56,861 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-05 22:12:56,861 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-05 22:12:56,861 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-05 22:12:56,892 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-05 22:12:56,892 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-05 22:12:56,892 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-05 22:12:56,892 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-05 22:12:57,829 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-05 22:12:58,176 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ffb537b1-2fc4-4ae9-ae6e-8e29d9743e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:43:00 GMT'
    'Content-Length': '1753'
2025-10-05 22:12:58,182 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-05 22:12:58,486 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b5ab7a7f-7af6-4f30-935d-ed2788a34100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:43:01 GMT'
    'Content-Length': '1687'
2025-10-05 22:12:58,487 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-05 22:12:58,487 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fc901aff3-6ebe-4f28-9a21-d42cfd5923ef%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5931c34d-a20a-11f0-b545-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 22:12:59,576 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 16:43:02 GMT'
    'ETag': '"0x8DE042E403253DC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f3035260-901f-0007-4e17-361b6e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5931c34d-a20a-11f0-b545-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:43:01 GMT'
2025-10-05 22:12:59,577 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fc901aff3-6ebe-4f28-9a21-d42cfd5923ef%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a3c78d8-a20a-11f0-9b7a-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-05 22:12:59,646 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f3035271-901f-0007-5f17-361b6e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5a3c78d8-a20a-11f0-9b7a-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:43:01 GMT'
2025-10-05 22:12:59,647 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fc901aff3-6ebe-4f28-9a21-d42cfd5923ef%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE042E403253DC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5a4734ed-a20a-11f0-a202-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-05 22:12:59,750 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Sun, 05 Oct 2025 16:43:02 GMT'
    'ETag': '"0x8DE042E404F03E5"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f3035277-901f-0007-6517-361b6e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5a4734ed-a20a-11f0-a202-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Sun, 05 Oct 2025 16:43:02 GMT'
2025-10-05 22:12:59,751 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/c901aff3-6ebe-4f28-9a21-d42cfd5923ef/date_SL.xlsx
2025-10-05 22:12:59,751 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/c901aff3-6ebe-4f28-9a21-d42cfd5923ef/date_SL.xlsx
2025-10-05 22:12:59,751 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-05 22:12:59,760 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-05 22:12:59,760 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_c901aff3_6ebe_4f28_9a21_d42cfd5923ef
2025-10-05 22:12:59,764 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-05 22:12:59,765 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session c901aff3-6ebe-4f28-9a21-d42cfd5923ef created with 3 rows ready for validation
2025-10-05 22:12:59,804 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:12:59] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-05 22:13:00,001 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:13:00,256 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:13:00,382 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-05 22:13:00,384 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-05 22:13:00,423 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-05 22:13:00,454 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-05 22:13:00,609 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-05 22:13:00,842 - werkzeug - INFO - 127.0.0.1 - - [05/Oct/2025 22:13:00] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 11:36:36,042 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 11:36:36,140 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 11:36:36,426 - rule_configuration_endpoints - ERROR - Failed to get template: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-06 11:36:36,469 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10054)')
2025-10-06 11:36:36,480 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "[35m[1mGET /api/rule-config/get-template/3 HTTP/1.1[0m" 500 -
2025-10-06 11:36:36,490 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-06 11:36:36,508 - rule_configuration_endpoints - ERROR - Failed to get template: ('08S02', '[08S02] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLPrepare); [08S02] [Microsoft][ODBC Driver 18 for SQL Server]Unable to open a logical session (10054)')
2025-10-06 11:36:36,537 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "[35m[1mGET /api/rule-config/get-template/3 HTTP/1.1[0m" 500 -
2025-10-06 11:36:36,837 - rule_configuration_endpoints - ERROR - Failed to get validation rules: ('08S02', '[08S02] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: An existing connection was forcibly closed by the remote host.\r\n (10054) (SQLExecDirectW); [08S02] [Microsoft][ODBC Driver 18 for SQL Server]Unable to open a logical session (10054)')
2025-10-06 11:36:36,856 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:36:36] "[35m[1mGET /api/rule-config/get-all-rules HTTP/1.1[0m" 500 -
2025-10-06 11:38:15,012 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 11:38:15,114 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 11:38:18,113 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 11:38:18,193 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 11:38:18,281 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 11:38:18,353 - __main__ - INFO - validation_history table ready
2025-10-06 11:38:18,384 - __main__ - INFO - validation_corrections table ready
2025-10-06 11:38:18,454 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 11:38:18,543 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 11:38:18,547 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 11:38:19,258 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 11:38:19,258 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 11:38:19,258 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 11:38:19,259 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 11:38:19,259 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 11:38:19,259 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 11:38:19,259 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 11:38:19,259 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 11:38:19,294 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 11:38:19,294 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 11:38:19,297 - werkzeug - INFO -  * Restarting with stat
2025-10-06 11:38:20,245 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 11:38:20,265 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 11:38:20,926 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 11:38:20,951 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 11:38:20,983 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 11:38:21,035 - __main__ - INFO - validation_history table ready
2025-10-06 11:38:21,063 - __main__ - INFO - validation_corrections table ready
2025-10-06 11:38:21,109 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 11:38:21,222 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 11:38:21,227 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 11:38:21,937 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 11:38:21,938 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 11:38:21,938 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 11:38:21,938 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 11:38:21,938 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 11:38:21,938 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 11:38:21,938 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 11:38:21,939 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 11:38:21,947 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 11:38:21,957 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 11:39:36,807 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 11:39:36,816 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:36] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 11:39:37,066 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:37] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 11:39:37,157 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:37] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 11:39:37,876 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 11:39:37,908 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 11:39:37,936 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:37] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 11:39:38,265 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 11:39:38,290 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 11:39:38,316 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:38] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 11:39:45,258 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 11:39:45,689 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 11:39:45,689 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 11:39:45,690 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 11:39:45,729 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 11:39:45,729 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 11:39:45,729 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 11:39:45,730 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 11:39:47,071 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 11:39:47,281 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '783b9221-358c-490b-a2c2-fe75fa0e8300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:09:49 GMT'
    'Content-Length': '1753'
2025-10-06 11:39:47,289 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 11:39:47,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'bf2137b4-fb88-46be-a1c7-b5fda4ab5c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:09:49 GMT'
    'Content-Length': '1692'
2025-10-06 11:39:47,526 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 11:39:47,527 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5185c5e6-8578-4152-80cb-2432a1d435ae%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '0f59d5fa-a27b-11f0-9ef6-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 11:39:48,816 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:09:51 GMT'
    'ETag': '"0x8DE049EF65FF020"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '76af2464-801f-0000-5187-3687c7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '0f59d5fa-a27b-11f0-9ef6-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:09:51 GMT'
2025-10-06 11:39:48,817 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5185c5e6-8578-4152-80cb-2432a1d435ae%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '10646117-a27b-11f0-a3b5-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 11:39:48,878 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '76af2477-801f-0000-6387-3687c7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '10646117-a27b-11f0-a3b5-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:09:51 GMT'
2025-10-06 11:39:48,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F5185c5e6-8578-4152-80cb-2432a1d435ae%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE049EF65FF020"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '106de543-a27b-11f0-a378-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 11:39:48,961 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:09:51 GMT'
    'ETag': '"0x8DE049EF677FE15"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '76af2479-801f-0000-6587-3687c7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '106de543-a27b-11f0-a378-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:09:51 GMT'
2025-10-06 11:39:48,962 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/5185c5e6-8578-4152-80cb-2432a1d435ae/date_SL.xlsx
2025-10-06 11:39:48,963 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/5185c5e6-8578-4152-80cb-2432a1d435ae/date_SL.xlsx
2025-10-06 11:39:48,963 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 11:39:48,990 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 11:39:48,990 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_5185c5e6_8578_4152_80cb_2432a1d435ae
2025-10-06 11:39:48,992 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 11:39:48,992 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 5185c5e6-8578-4152-80cb-2432a1d435ae created with 3 rows ready for validation
2025-10-06 11:39:49,021 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 11:39:49,254 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 11:39:49,497 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 11:39:49,622 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 11:39:49,634 - data_validation_endpoints - ERROR - Error detection failed: 'DuckDBService' object has no attribute 'conn'
2025-10-06 11:39:49,649 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 11:39:49,672 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-06 11:39:49,843 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 11:39:50,035 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 11:39:50] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 11:54:31,322 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 11:54:32,436 - werkzeug - INFO -  * Restarting with stat
2025-10-06 11:54:34,859 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 11:54:34,959 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 11:54:36,449 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 11:54:36,479 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 11:54:36,557 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 11:54:36,627 - __main__ - INFO - validation_history table ready
2025-10-06 11:54:36,659 - __main__ - INFO - validation_corrections table ready
2025-10-06 11:54:36,705 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 11:54:36,904 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 11:54:36,909 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 11:54:37,753 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 11:54:37,754 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 11:54:37,754 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 11:54:37,754 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 11:54:37,754 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 11:54:37,755 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 11:54:37,755 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 11:54:37,755 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 11:54:37,779 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 11:54:37,789 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:02:23,897 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:23] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:02:24,070 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:02:24,278 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:02:24,301 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:02:24,322 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:02:24,654 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:02:24,698 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:02:24,760 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_5185c5e6_8578_4152_80cb_2432a1d435ae does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_5185c5e6_8578_4152_80cb_2432a1d435ae
                      ^
2025-10-06 12:02:24,761 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_5185c5e6_8578_4152_80cb_2432a1d435ae does not exist!
Did you mean "pg_database"?

LINE 1: SELECT * FROM validation_data_5185c5e6_8578_4152_80cb_2432a1d435ae
                      ^
2025-10-06 12:02:24,786 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:24] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-06 12:02:25,076 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:25] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:02:34,201 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:02:34,201 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:02:34,465 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:34] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:02:34,518 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:02:34,799 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:02:34,823 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:02:34,846 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:34] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:02:35,163 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:02:35,184 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:02:35,207 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:35] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:02:42,362 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:02:43,076 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:02:43,076 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:02:43,077 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:02:43,098 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 12:02:43,098 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 12:02:43,098 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 12:02:43,098 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 12:02:44,690 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:02:45,012 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f5e241d5-7130-4200-bf46-8441cc7d7d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:32:47 GMT'
    'Content-Length': '1753'
2025-10-06 12:02:45,024 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:02:45,200 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '251376dc-6ccd-472c-9bf4-c187184b5900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:32:47 GMT'
    'Content-Length': '1692'
2025-10-06 12:02:45,201 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:02:45,202 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd01e622f-eb3a-430d-924d-051c2618ba85%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '4479c5a3-a27e-11f0-89e1-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:02:46,583 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:32:49 GMT'
    'ETag': '"0x8DE04A22B8A6690"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '832585a7-401f-0002-5c8b-36950e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '4479c5a3-a27e-11f0-89e1-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:32:49 GMT'
2025-10-06 12:02:46,584 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd01e622f-eb3a-430d-924d-051c2618ba85%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '459ae3d8-a27e-11f0-bf8e-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:02:46,653 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '832585b4-401f-0002-678b-36950e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '459ae3d8-a27e-11f0-bf8e-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:32:49 GMT'
2025-10-06 12:02:46,654 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Fd01e622f-eb3a-430d-924d-051c2618ba85%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A22B8A6690"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '45a595c3-a27e-11f0-8206-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:02:46,735 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:32:49 GMT'
    'ETag': '"0x8DE04A22BAB6CE9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '832585b9-401f-0002-6b8b-36950e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '45a595c3-a27e-11f0-8206-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:32:49 GMT'
2025-10-06 12:02:46,736 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/d01e622f-eb3a-430d-924d-051c2618ba85/date_SL.xlsx
2025-10-06 12:02:46,737 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/d01e622f-eb3a-430d-924d-051c2618ba85/date_SL.xlsx
2025-10-06 12:02:46,737 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 12:02:46,774 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 12:02:46,775 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_d01e622f_eb3a_430d_924d_051c2618ba85
2025-10-06 12:02:46,775 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 12:02:46,776 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session d01e622f-eb3a-430d-924d-051c2618ba85 created with 3 rows ready for validation
2025-10-06 12:02:46,800 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:46] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 12:02:47,274 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:02:47,313 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:02:47,539 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:02:47,653 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:02:47,670 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:02:47,680 - data_validation_endpoints - ERROR - Error detection failed: 'error_count'
2025-10-06 12:02:47,705 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-06 12:02:47,724 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:02:47] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:04:29,670 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:04:30,412 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:04:31,852 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:04:31,959 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:04:32,897 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:04:32,934 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:04:33,018 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:04:33,106 - __main__ - INFO - validation_history table ready
2025-10-06 12:04:33,142 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:04:33,210 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:04:33,287 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:04:33,292 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:04:34,065 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:04:34,065 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:04:34,065 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:04:34,065 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:04:34,066 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:04:34,066 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:04:34,066 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:04:34,066 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:04:34,080 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:04:34,090 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:05:05,669 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:05:05,917 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:05] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:05:06,083 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:05:06,087 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:05:06,198 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:05:06,442 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:05:06,458 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:05:06,493 - __main__ - ERROR - Validation failed: Catalog Error: Table with name validation_data_d01e622f_eb3a_430d_924d_051c2618ba85 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_d01e622f_eb3a_430d_924d_051c2618ba85
                      ^
2025-10-06 12:05:06,493 - data_validation_endpoints - ERROR - [VALIDATION] Validation failed: Catalog Error: Table with name validation_data_d01e622f_eb3a_430d_924d_051c2618ba85 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_d01e622f_eb3a_430d_924d_051c2618ba85
                      ^
2025-10-06 12:05:06,533 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "[35m[1mPOST /api/data-validation/detect-errors HTTP/1.1[0m" 500 -
2025-10-06 12:05:06,646 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:06] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:05:08,946 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:08] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:05:08,947 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:08] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:05:09,211 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:09] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:05:09,276 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:09] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:05:10,044 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:05:10,079 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:05:10,116 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:10] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:05:10,428 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:05:10,465 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:05:10,500 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:10] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:05:33,480 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:05:33,789 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:05:33,790 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:05:33,790 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:05:50,589 - data_validation_endpoints - ERROR - File upload for validation failed: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.\r\n (10060) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10060)')
2025-10-06 12:05:50,593 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:50] "[35m[1mPOST /api/data-validation/upload HTTP/1.1[0m" 500 -
2025-10-06 12:05:56,332 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:05:56,342 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:05:56,342 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:05:56,342 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:05:56,343 - data_validation_endpoints - ERROR - File upload for validation failed: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Session Provider: Physical connection is not usable [xFFFFFFFF].  (-1) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (-1)')
2025-10-06 12:05:56,346 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:05:56] "[35m[1mPOST /api/data-validation/upload HTTP/1.1[0m" 500 -
2025-10-06 12:06:41,530 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:06:41,553 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:06:43,602 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:06:43,627 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:06:43,651 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:06:43,691 - __main__ - INFO - validation_history table ready
2025-10-06 12:06:43,712 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:06:43,754 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:06:43,817 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:06:43,821 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:06:44,608 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:06:44,608 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:06:44,608 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:06:44,608 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:06:44,609 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:06:44,609 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:06:44,609 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:06:44,609 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:06:44,630 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 12:06:44,631 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 12:06:44,632 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:06:45,462 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:06:45,481 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:06:47,387 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:06:47,431 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:06:47,475 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:06:47,562 - __main__ - INFO - validation_history table ready
2025-10-06 12:06:47,605 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:06:47,691 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:06:47,731 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:06:47,735 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:06:48,422 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:06:48,422 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:06:48,422 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:06:48,422 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:06:48,423 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:06:48,423 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:06:48,423 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:06:48,423 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:06:48,434 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:06:48,445 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:07:06,494 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:07:06,851 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:07:06,851 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:07:06,851 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:07:26,063 - data_validation_endpoints - ERROR - File upload for validation failed: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: A connection attempt failed because the connected party did not properly respond after a period of time, or established connection failed because connected host has failed to respond.\r\n (10060) (SQLExecDirectW); [08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (10060)')
2025-10-06 12:07:26,068 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:07:26] "[35m[1mPOST /api/data-validation/upload HTTP/1.1[0m" 500 -
2025-10-06 12:09:02,279 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:09:02,548 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:09:03,950 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:09:03,982 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:09:04,824 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:09:04,850 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:09:04,876 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:09:04,924 - __main__ - INFO - validation_history table ready
2025-10-06 12:09:04,950 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:09:04,998 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:09:05,066 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:09:05,071 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:09:05,798 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:09:05,799 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:09:05,799 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:09:05,799 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:09:05,800 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:09:05,800 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:09:05,800 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:09:05,800 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:09:05,812 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:09:05,820 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:10:29,580 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:10:29,829 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:10:29,890 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:10:29,916 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:10:29,944 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:29] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:10:29,954 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:10:29,985 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:10:30,013 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:30] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:10:37,113 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:10:37,472 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:10:37,473 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:10:37,473 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:10:37,500 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 12:10:37,500 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 12:10:37,500 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 12:10:37,500 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 12:10:38,706 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:10:38,842 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '3551ba54-4124-4d45-bc41-9d9fef4f4b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:40:41 GMT'
    'Content-Length': '1753'
2025-10-06 12:10:38,851 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:10:39,056 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '2560705b-6642-45b0-88ce-221f1d495d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:40:41 GMT'
    'Content-Length': '1692'
2025-10-06 12:10:39,056 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:10:39,057 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5f02c1be-a27f-11f0-9a3d-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:10:39,806 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:40:42 GMT'
    'ETag': '"0x8DE04A3459DF464"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a4d8f1b2-801f-0024-698c-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5f02c1be-a27f-11f0-9a3d-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:40:42 GMT'
2025-10-06 12:10:39,808 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fab2053-a27f-11f0-8106-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:10:39,896 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a4d8f1ba-801f-0024-718c-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5fab2053-a27f-11f0-8106-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:40:42 GMT'
2025-10-06 12:10:39,897 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A3459DF464"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '5fb8cadc-a27f-11f0-bd5c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:10:39,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:40:42 GMT'
    'ETag': '"0x8DE04A345BD3F61"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'a4d8f1c4-801f-0024-7b8c-3681ad000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '5fb8cadc-a27f-11f0-bd5c-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:40:42 GMT'
2025-10-06 12:10:39,985 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_SL.xlsx
2025-10-06 12:10:39,986 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_SL.xlsx
2025-10-06 12:10:39,986 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 12:10:40,011 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 12:10:40,012 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_aeb1aa48_5a89_4041_9d4b_3cdffd55f293
2025-10-06 12:10:40,012 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 12:10:40,013 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session aeb1aa48-5a89-4041-9d4b-3cdffd55f293 created with 3 rows ready for validation
2025-10-06 12:10:40,039 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 12:10:40,241 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:10:40,501 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:10:40,616 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:10:40,626 - data_validation_endpoints - INFO - [VALIDATION] Found 4 errors in 3 rows
2025-10-06 12:10:40,630 - data_validation_endpoints - INFO - Error detection complete: 4 errors found
2025-10-06 12:10:40,645 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:10:40,667 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 12:10:40,839 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:40] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:10:41,031 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:41] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:10:47,804 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:47] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:10:57,129 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:57] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:10:57,146 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 12:10:57,147 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 12:10:57,180 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:10:57,378 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e9a07474-a2fb-4a1a-a169-74e4897a8a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:41:00 GMT'
    'Content-Length': '1753'
2025-10-06 12:10:57,379 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:10:57,565 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'dabdcafe-ff5e-43a2-84d4-d4b3c5248000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:41:00 GMT'
    'Content-Length': '1688'
2025-10-06 12:10:57,565 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:10:57,566 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a05eac6-a27f-11f0-8074-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:10:58,167 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:41:01 GMT'
    'ETag': '"0x8DE04A3508E8E18"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ea7e0d21-a01f-001c-708c-36256d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6a05eac6-a27f-11f0-8074-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:41:00 GMT'
2025-10-06 12:10:58,168 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5049'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6a9cb76c-a27f-11f0-89ea-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:10:58,207 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ea7e0d34-a01f-001c-038c-36256d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6a9cb76c-a27f-11f0-89ea-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:41:00 GMT'
2025-10-06 12:10:58,208 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A3508E8E18"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6aa2c683-a27f-11f0-8081-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:10:58,270 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:41:01 GMT'
    'ETag': '"0x8DE04A350A5D83D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ea7e0d40-a01f-001c-0f8c-36256d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6aa2c683-a27f-11f0-8081-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:41:00 GMT'
2025-10-06 12:10:58,270 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:10:58,271 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:10:58,272 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 12:10:58,376 - data_validation_endpoints - ERROR - Failed to save corrections: ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'row_number'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_type'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-06 12:10:58,381 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:10:58] "[35m[1mPOST /api/data-validation/save-corrections HTTP/1.1[0m" 500 -
2025-10-06 12:12:14,181 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:12:14,579 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:12:15,997 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:12:16,020 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:12:16,765 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:12:16,788 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:12:16,810 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:12:16,850 - __main__ - INFO - validation_history table ready
2025-10-06 12:12:16,871 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:12:16,912 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:12:16,975 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:12:16,979 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:12:17,841 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:12:17,841 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:12:17,841 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:12:17,841 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:12:17,841 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:12:17,842 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:12:17,842 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:12:17,842 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:12:17,854 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:12:17,862 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:12:37,814 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:12:37,998 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:12:39,010 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:12:39,032 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:12:39,624 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:12:39,646 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:12:39,701 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:12:39,755 - __main__ - INFO - validation_history table ready
2025-10-06 12:12:39,776 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:12:39,815 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:12:39,867 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:12:39,872 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:12:40,616 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:12:40,616 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:12:40,616 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:12:40,616 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:12:40,616 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:12:40,617 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:12:40,617 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:12:40,617 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:12:40,627 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:12:40,634 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:13:07,862 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:13:07] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:13:08,233 - data_validation_endpoints - ERROR - Failed to save corrections: Catalog Error: Table with name validation_data_aeb1aa48_5a89_4041_9d4b_3cdffd55f293 does not exist!
Did you mean "pragma_database_list"?

LINE 1: SELECT * FROM validation_data_aeb1aa48_5a89_4041_9d4b_3cdffd55f293
                      ^
2025-10-06 12:13:08,238 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:13:08] "[35m[1mPOST /api/data-validation/save-corrections HTTP/1.1[0m" 500 -
2025-10-06 12:14:03,378 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:14:03,553 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:14:04,796 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:14:04,820 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:14:05,504 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:14:05,526 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:14:05,547 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:14:05,588 - __main__ - INFO - validation_history table ready
2025-10-06 12:14:05,609 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:14:05,656 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:14:05,702 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:14:05,707 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:14:06,446 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:14:06,447 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:14:06,447 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:14:06,447 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:14:06,448 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:14:06,448 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:14:06,448 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:14:06,448 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:14:06,461 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:14:06,470 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:14:31,414 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:31] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:14:31,734 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 12:14:31,735 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 12:14:33,202 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:14:33,338 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'fe0c68bd-50ad-4b9d-8db8-eeb868966400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:35 GMT'
    'Content-Length': '1753'
2025-10-06 12:14:33,346 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:14:33,481 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8fc5a7dc-f4a4-4e24-8da1-286bcc7a5900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
    'Content-Length': '1693'
2025-10-06 12:14:33,482 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:14:33,483 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eac8233e-a27f-11f0-8d17-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:14:33,656 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 12:14:33,657 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 12:14:33,671 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:14:33,859 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b1d8677a-0702-48d6-a0aa-bdd6110a6000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
    'Content-Length': '1753'
2025-10-06 12:14:33,860 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:14:34,061 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '62fe1f56-7b2b-490d-8238-702604415d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
    'Content-Length': '1692'
2025-10-06 12:14:34,062 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:14:34,062 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eb0fc457-a27f-11f0-92a7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:14:34,484 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:44:37 GMT'
    'ETag': '"0x8DE04A3D1815CB4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7b292ca7-401f-005f-408c-369f8a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'eac8233e-a27f-11f0-8d17-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
2025-10-06 12:14:34,486 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5048'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eb8c22e2-a27f-11f0-bcf2-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:14:34,542 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7b292cab-401f-005f-448c-369f8a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'eb8c22e2-a27f-11f0-bcf2-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
2025-10-06 12:14:34,543 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A3D1815CB4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'eb94ed18-a27f-11f0-a75d-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:14:34,630 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:44:37 GMT'
    'ETag': '"0x8DE04A3D199569D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7b292cac-401f-005f-458c-369f8a000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'eb94ed18-a27f-11f0-a75d-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:36 GMT'
2025-10-06 12:14:34,631 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:34,631 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:34,634 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 12:14:34,728 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'row_number'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_type'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-06 12:14:34,728 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 12:14:34,728 - data_validation_endpoints - INFO - Corrections saved: 1 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:34,732 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:34] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:14:35,028 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:44:37 GMT'
    'ETag': '"0x8DE04A3D1D4198C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7132afac-e01f-0040-358c-367035000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'eb0fc457-a27f-11f0-92a7-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:37 GMT'
2025-10-06 12:14:35,030 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5048'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ebdf3573-a27f-11f0-a7aa-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:14:35,086 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7132afad-e01f-0040-368c-367035000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ebdf3573-a27f-11f0-a7aa-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:37 GMT'
2025-10-06 12:14:35,088 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2Faeb1aa48-5a89-4041-9d4b-3cdffd55f293%2Fdate_corrected_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A3D1D4198C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ebe8057c-a27f-11f0-a8d9-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:14:35,154 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:35] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:14:35,170 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 06:44:38 GMT'
    'ETag': '"0x8DE04A3D1EC37B5"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7132afae-e01f-0040-378c-367035000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ebe8057c-a27f-11f0-a8d9-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 06:44:37 GMT'
2025-10-06 12:14:35,171 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:35,171 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:35,172 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 12:14:35,258 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'row_number'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_type'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-06 12:14:35,259 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 12:14:35,259 - data_validation_endpoints - INFO - Corrections saved: 1 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/aeb1aa48-5a89-4041-9d4b-3cdffd55f293/date_corrected_SL_corrected.xlsx
2025-10-06 12:14:35,262 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:35] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:14:38,332 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:14:38,332 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:38] "[33mGET /api/data-validation/download-corrected HTTP/1.1[0m" 404 -
2025-10-06 12:14:38,333 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:14:38,585 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:14:38,647 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:14:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:28:23,942 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:28:24,779 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:28:26,225 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:28:26,311 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:28:27,718 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:28:27,743 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:28:27,830 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:28:27,889 - __main__ - INFO - validation_history table ready
2025-10-06 12:28:27,913 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:28:27,960 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:28:28,037 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:28:28,042 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:28:28,832 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:28:28,832 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:28:28,833 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:28:28,833 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:28:28,833 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:28:28,833 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:28:28,833 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:28:28,834 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:28:28,845 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:28:28,853 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:28:39,931 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-06 12:28:40,160 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:28:41,616 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:28:41,643 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:28:42,269 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:28:42,292 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:28:42,314 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:28:42,355 - __main__ - INFO - validation_history table ready
2025-10-06 12:28:42,377 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:28:42,417 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:28:42,472 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:28:42,477 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:28:43,368 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:28:43,369 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:28:43,369 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:28:43,369 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:28:43,369 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:28:43,370 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:28:43,370 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:28:43,370 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:28:43,381 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:28:43,389 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:30:07,954 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:30:07,971 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:30:08,691 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:30:08,750 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:30:08,794 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:30:08,865 - __main__ - INFO - validation_history table ready
2025-10-06 12:30:08,897 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:30:08,949 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:30:08,991 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:30:08,994 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:30:09,721 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:30:09,722 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:30:09,722 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:30:09,722 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:30:09,722 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:30:09,722 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:30:09,723 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:30:09,723 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:30:09,739 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 12:30:09,739 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 12:30:09,741 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:30:10,453 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:30:10,468 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:30:11,036 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:30:11,063 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:30:11,087 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:30:11,135 - __main__ - INFO - validation_history table ready
2025-10-06 12:30:11,160 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:30:11,207 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:30:11,256 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:30:11,260 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:30:11,987 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:30:11,987 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:30:11,987 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:30:11,987 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:30:11,987 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:30:11,987 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:30:11,988 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:30:11,988 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:30:11,998 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:30:12,006 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:30:15,716 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:30:15,746 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:30:15,774 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:15] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:30:15,966 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:30:15,990 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:30:16,018 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:16] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:30:22,467 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:30:22,919 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:30:22,919 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:30:22,920 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:30:22,945 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 12:30:22,946 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 12:30:22,946 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 12:30:22,946 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 12:30:24,295 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:30:24,437 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '957207f4-3edd-4006-b2ea-6fee0b706000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:26 GMT'
    'Content-Length': '1753'
2025-10-06 12:30:24,444 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:30:24,721 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '960ea090-2c47-4230-a5db-9f7f407b6400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:26 GMT'
    'Content-Length': '1687'
2025-10-06 12:30:24,722 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:30:24,722 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '21ad657d-a282-11f0-8850-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:30:26,330 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:00:29 GMT'
    'ETag': '"0x8DE04A608D8344C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ae2c4ac0-401f-0020-548e-36fc60000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '21ad657d-a282-11f0-8850-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:29 GMT'
2025-10-06 12:30:26,332 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '22e45c80-a282-11f0-bb9f-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:30:26,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ae2c4ac5-401f-0020-598e-36fc60000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '22e45c80-a282-11f0-bb9f-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:29 GMT'
2025-10-06 12:30:26,399 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A608D8344C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '22ee981e-a282-11f0-a7e7-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:30:26,490 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:00:29 GMT'
    'ETag': '"0x8DE04A608F1A8FD"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'ae2c4ac8-401f-0020-5c8e-36fc60000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '22ee981e-a282-11f0-a7e7-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:29 GMT'
2025-10-06 12:30:26,492 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL.xlsx
2025-10-06 12:30:26,495 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL.xlsx
2025-10-06 12:30:26,496 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 12:30:26,532 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 12:30:26,532 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_8817e504_17b9_4cc8_adef_12a7bb1c28ad
2025-10-06 12:30:26,533 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 12:30:26,533 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 8817e504-17b9-4cc8-adef-12a7bb1c28ad created with 3 rows ready for validation
2025-10-06 12:30:26,572 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:26] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 12:30:26,916 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:26] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:30:27,189 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:30:27,294 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:30:27,312 - data_validation_endpoints - INFO - [VALIDATION] Found 4 errors in 3 rows
2025-10-06 12:30:27,329 - data_validation_endpoints - INFO - Error detection complete: 4 errors found
2025-10-06 12:30:27,333 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:27] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:30:27,360 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:27] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 12:30:27,547 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:30:27,727 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:27] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:30:29,093 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:29] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:30:34,076 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:34] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:30:34,406 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 12:30:34,407 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 12:30:34,426 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:30:34,615 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '52b1914c-ee9f-4635-874d-4460b9ce6600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:36 GMT'
    'Content-Length': '1753'
2025-10-06 12:30:34,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:30:34,902 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '24918211-be9f-4c02-bb58-dab6e1266100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:36 GMT'
    'Content-Length': '1687'
2025-10-06 12:30:34,903 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:30:34,903 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL_corrected_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '27b762d0-a282-11f0-8149-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:30:35,780 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:00:38 GMT'
    'ETag': '"0x8DE04A60E773568"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2109a01b-c01f-004c-5f8e-3617f7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '27b762d0-a282-11f0-8149-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:38 GMT'
2025-10-06 12:30:35,782 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL_corrected_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5046'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '2886367b-a282-11f0-b263-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:30:35,838 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2109a03f-c01f-004c-038e-3617f7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '2886367b-a282-11f0-b263-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:38 GMT'
2025-10-06 12:30:35,839 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F8817e504-17b9-4cc8-adef-12a7bb1c28ad%2Fdate_SL_corrected_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A60E773568"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '288f06d1-a282-11f0-b69c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:30:35,916 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:00:38 GMT'
    'ETag': '"0x8DE04A60E9015FD"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '2109a04b-c01f-004c-0f8e-3617f7000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '288f06d1-a282-11f0-b69c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:38 GMT'
2025-10-06 12:30:35,916 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL_corrected_corrected.xlsx
2025-10-06 12:30:35,917 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL_corrected_corrected.xlsx
2025-10-06 12:30:35,918 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 12:30:36,015 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): ('42S22', "[42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'validation_id'. (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'row_number'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'rule_type'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Invalid column name 'created_at'. (207); [42S22] [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)")
2025-10-06 12:30:36,015 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 12:30:36,015 - data_validation_endpoints - INFO - Corrections saved: 1 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL_corrected_corrected.xlsx
2025-10-06 12:30:36,019 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:36] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:30:36,129 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:36] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:30:38,001 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:30:38,007 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:30:38,007 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:30:38,216 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd51f262d-dcbc-4092-bffb-081e107a3700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:40 GMT'
    'Content-Length': '1753'
2025-10-06 12:30:38,217 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:30:38,256 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:30:38,326 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:38] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:30:38,398 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7b982ed1-40f7-42e3-a481-0a2460ae4e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:40 GMT'
    'Content-Length': '1688'
2025-10-06 12:30:38,399 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:30:38,399 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.blob.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL_corrected_corrected.xlsx'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '29d8dd2a-a282-11f0-8ebc-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:30:39,294 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '5046'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 06 Oct 2025 07:00:38 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE04A60E9015FD"'
    'Server': 'Windows-Azure-Blob/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '7fd09191-101e-001f-398e-3698b2000000'
    'x-ms-client-request-id': '29d8dd2a-a282-11f0-8ebc-3003c8abdcf2'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:00:41 GMT'
2025-10-06 12:30:39,297 - __main__ - INFO - Downloaded file from OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/8817e504-17b9-4cc8-adef-12a7bb1c28ad/date_SL_corrected_corrected.xlsx
2025-10-06 12:30:39,298 - data_validation_endpoints - INFO - [DOWNLOAD] Downloading corrected file: date_SL_corrected.xlsx
2025-10-06 12:30:39,302 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:30:39] "GET /api/data-validation/download-corrected HTTP/1.1" 200 -
2025-10-06 12:32:26,119 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-06 12:32:26,478 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:32:28,105 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:32:28,140 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:32:29,069 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:32:29,114 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:32:29,157 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:32:29,242 - __main__ - INFO - validation_history table ready
2025-10-06 12:32:29,286 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:32:29,370 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:32:29,422 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:32:29,427 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:32:30,341 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:32:30,342 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:32:30,342 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:32:30,343 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:32:30,343 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:32:30,343 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:32:30,343 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:32:30,343 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:32:30,358 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:32:30,366 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:32:35,895 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints.py', reloading
2025-10-06 12:32:36,052 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:32:37,106 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:32:37,133 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:32:38,138 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:32:38,192 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:32:38,243 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:32:38,346 - __main__ - INFO - validation_history table ready
2025-10-06 12:32:38,398 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:32:38,498 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:32:38,546 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:32:38,551 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:32:39,382 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:32:39,383 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:32:39,383 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:32:39,383 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:32:39,383 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:32:39,384 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:32:39,384 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:32:39,384 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:32:39,396 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:32:39,406 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:42:50,646 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\app_complete.py', reloading
2025-10-06 12:42:51,134 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:42:52,959 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:42:53,021 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:42:54,652 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:42:54,678 - __main__ - INFO - Existing tables: ['validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'validation_corrections', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'validation_history', 'ProductCategory']
2025-10-06 12:42:54,731 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:42:54,798 - __main__ - INFO - validation_corrections has wrong schema - has: ['correction_id', 'history_id', 'row_index', 'column_name', 'original_value', 'corrected_value', 'rule_failed']
2025-10-06 12:42:54,799 - __main__ - INFO - Dropping and recreating validation tables with correct schema...
2025-10-06 12:42:55,052 - __main__ - INFO - Old validation tables dropped successfully
2025-10-06 12:42:55,086 - __main__ - INFO - validation_history table ready
2025-10-06 12:42:55,110 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:42:55,156 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:42:55,250 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:42:55,259 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:42:56,066 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:42:56,066 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:42:56,066 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:42:56,067 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:42:56,067 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:42:56,067 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:42:56,067 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:42:56,067 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:42:56,083 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:42:56,094 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:47:56,602 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:47:56,631 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:47:57,345 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:47:57,369 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 12:47:57,396 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:47:57,456 - __main__ - INFO - validation_history table ready
2025-10-06 12:47:57,479 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:47:57,518 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:47:57,562 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:47:57,565 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:47:58,293 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:47:58,294 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:47:58,294 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:47:58,294 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:47:58,294 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:47:58,294 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:47:58,295 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:47:58,295 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:47:58,311 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 12:47:58,311 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 12:47:58,313 - werkzeug - INFO -  * Restarting with stat
2025-10-06 12:47:59,022 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 12:47:59,037 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 12:47:59,642 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 12:47:59,668 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 12:47:59,691 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 12:47:59,761 - __main__ - INFO - validation_history table ready
2025-10-06 12:47:59,786 - __main__ - INFO - validation_corrections table ready
2025-10-06 12:47:59,833 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 12:47:59,880 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 12:47:59,883 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 12:48:00,600 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 12:48:00,600 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 12:48:00,600 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 12:48:00,600 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 12:48:00,601 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 12:48:00,601 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 12:48:00,601 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 12:48:00,601 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 12:48:00,609 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 12:48:00,614 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 12:48:15,927 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:48:15,958 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:48:15,985 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:15] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:48:16,165 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 12:48:16,189 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 0 validation sessions
2025-10-06 12:48:16,217 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:16] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 12:48:24,381 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 12:48:24,821 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 12:48:24,821 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 12:48:24,821 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 12:48:24,847 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 12:48:24,848 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 12:48:24,848 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 12:48:24,848 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 12:48:26,091 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:48:26,354 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7d4102d6-ae39-49a7-bc25-5faf70ce5e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:28 GMT'
    'Content-Length': '1753'
2025-10-06 12:48:26,362 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:48:26,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '52adeef8-4c05-4254-a113-1ec265358e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:28 GMT'
    'Content-Length': '1687'
2025-10-06 12:48:26,596 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:48:26,597 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a67a4b67-a284-11f0-86b2-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:48:27,750 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:18:30 GMT'
    'ETag': '"0x8DE04A88D644FB0"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'bfddee09-501f-0008-5191-366d02000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a67a4b67-a284-11f0-86b2-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:29 GMT'
2025-10-06 12:48:27,752 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a777dd1a-a284-11f0-889d-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:48:27,832 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'bfddee0d-501f-0008-5291-366d02000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a777dd1a-a284-11f0-889d-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:29 GMT'
2025-10-06 12:48:27,833 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A88D644FB0"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'a784443a-a284-11f0-ba9f-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:48:27,924 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:18:30 GMT'
    'ETag': '"0x8DE04A88D830C3D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'bfddee0f-501f-0008-5491-366d02000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'a784443a-a284-11f0-ba9f-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:29 GMT'
2025-10-06 12:48:27,925 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL.xlsx
2025-10-06 12:48:27,926 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL.xlsx
2025-10-06 12:48:27,926 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 12:48:27,951 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 12:48:27,951 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_7e36e913_8cfb_4d9e_9b40_1964cbc8309e
2025-10-06 12:48:27,952 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 12:48:27,952 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 7e36e913-8cfb-4d9e-9b40-1964cbc8309e created with 3 rows ready for validation
2025-10-06 12:48:27,979 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:27] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 12:48:28,450 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:48:28,496 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:48:28,688 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 12:48:28,838 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:48:28,867 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 12:48:28,879 - data_validation_endpoints - INFO - [VALIDATION] Found 4 errors in 3 rows
2025-10-06 12:48:28,886 - data_validation_endpoints - INFO - Error detection complete: 4 errors found
2025-10-06 12:48:28,916 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 12:48:28,940 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:28] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:48:32,510 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:32] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:48:38,118 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:38] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:48:38,132 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 12:48:38,132 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 12:48:38,155 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:48:38,375 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '1f7081be-3a76-4e7f-82a1-34e170996100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:40 GMT'
    'Content-Length': '1753'
2025-10-06 12:48:38,376 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:48:38,697 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '08ff97d8-5622-40c5-b8d7-119de88c5f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:40 GMT'
    'Content-Length': '1687'
2025-10-06 12:48:38,698 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:48:38,698 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'adab431e-a284-11f0-9337-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:48:39,262 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:18:42 GMT'
    'ETag': '"0x8DE04A89444E2F4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5008a6e5-c01f-000c-3591-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'adab431e-a284-11f0-9337-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:41 GMT'
2025-10-06 12:48:39,264 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5043'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ae548481-a284-11f0-930c-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 12:48:39,447 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5008a6e6-c01f-000c-3691-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ae548481-a284-11f0-930c-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:41 GMT'
2025-10-06 12:48:39,449 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F7e36e913-8cfb-4d9e-9b40-1964cbc8309e%2Fdate_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04A89444E2F4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'ae70b166-a284-11f0-a7d1-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:48:39,509 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 07:18:42 GMT'
    'ETag': '"0x8DE04A8946DF049"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5008a6e7-c01f-000c-3791-36bcbe000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'ae70b166-a284-11f0-a7d1-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:18:42 GMT'
2025-10-06 12:48:39,510 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL_corrected.xlsx
2025-10-06 12:48:39,510 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL_corrected.xlsx
2025-10-06 12:48:39,511 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 12:48:39,673 - data_validation_endpoints - INFO - [DATABASE] [OK] Validation history stored with ID: 1
2025-10-06 12:48:39,673 - data_validation_endpoints - INFO - Corrections saved: 1 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL_corrected.xlsx
2025-10-06 12:48:39,699 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:39] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 12:48:40,110 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:48:40] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 12:49:45,470 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 12:49:45,475 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:49:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:49:45,475 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:49:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:49:45,716 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:49:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 12:49:45,742 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '06c166bd-9a9e-4c35-ba8e-7d04c7676c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:19:47 GMT'
    'Content-Length': '1753'
2025-10-06 12:49:45,743 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 12:49:45,794 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:49:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 12:49:45,981 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '64e22689-d346-443e-8201-248f333f7b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:19:48 GMT'
    'Content-Length': '1688'
2025-10-06 12:49:45,982 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 12:49:45,982 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.blob.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL_corrected.xlsx'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd5cacfe5-a284-11f0-9895-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 12:49:46,872 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '5043'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 06 Oct 2025 07:18:42 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE04A8946DF049"'
    'Server': 'Windows-Azure-Blob/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'e2ebb98c-a01e-0041-5a91-362fe9000000'
    'x-ms-client-request-id': 'd5cacfe5-a284-11f0-9895-3003c8abdcf2'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 07:19:49 GMT'
2025-10-06 12:49:46,875 - __main__ - INFO - Downloaded file from OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/7e36e913-8cfb-4d9e-9b40-1964cbc8309e/date_SL_corrected.xlsx
2025-10-06 12:49:46,876 - data_validation_endpoints - INFO - [DOWNLOAD] Downloading corrected file: date_corrected.xlsx
2025-10-06 12:49:46,880 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 12:49:46] "GET /api/data-validation/download-corrected HTTP/1.1" 200 -
2025-10-06 14:28:48,918 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:48] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 14:28:49,066 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 14:28:49,344 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 14:28:49,410 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:49] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 14:28:49,411 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:49] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 14:28:49,673 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 14:28:49] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 15:51:05,055 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 15:51:05,132 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 15:51:06,647 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 15:51:06,708 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 15:51:06,786 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 15:51:06,902 - __main__ - INFO - validation_history table ready
2025-10-06 15:51:06,936 - __main__ - INFO - validation_corrections table ready
2025-10-06 15:51:06,997 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 15:51:07,053 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 15:51:07,056 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 15:51:07,735 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 15:51:07,736 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 15:51:07,736 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 15:51:07,736 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 15:51:07,736 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 15:51:07,736 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 15:51:07,736 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 15:51:07,736 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 15:51:07,757 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 15:51:07,757 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 15:51:07,759 - werkzeug - INFO -  * Restarting with stat
2025-10-06 15:51:08,490 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 15:51:08,510 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 15:51:09,313 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 15:51:09,358 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 15:51:09,403 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 15:51:09,534 - __main__ - INFO - validation_history table ready
2025-10-06 15:51:09,579 - __main__ - INFO - validation_corrections table ready
2025-10-06 15:51:09,667 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 15:51:09,714 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 15:51:09,717 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 15:51:10,413 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 15:51:10,414 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 15:51:10,414 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 15:51:10,414 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 15:51:10,414 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 15:51:10,414 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 15:51:10,414 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 15:51:10,414 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 15:51:10,421 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 15:51:10,429 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 15:51:14,520 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:14] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:14,766 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:14] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:14,834 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:14] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 15:51:14,862 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:14] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:15,083 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:15] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 15:51:15,146 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:15,524 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 15:51:15,628 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 1 validation sessions
2025-10-06 15:51:15,674 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:15] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 15:51:15,992 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 15:51:16,036 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 1 validation sessions
2025-10-06 15:51:16,082 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:16] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 15:51:28,030 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 15:51:28,423 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 15:51:28,423 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 15:51:28,423 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 15:51:28,469 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 15:51:28,470 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 15:51:28,470 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 15:51:28,470 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 15:51:29,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 15:51:29,958 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'd5f941d9-957b-4f92-95d9-03bb27cd8300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:33 GMT'
    'Content-Length': '1753'
2025-10-06 15:51:29,967 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 15:51:30,169 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '01a8d261-f764-4a31-a3de-e2bb14c96300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:33 GMT'
    'Content-Length': '1692'
2025-10-06 15:51:30,170 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 15:51:30,171 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3941c1e4-a29e-11f0-83a9-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 15:51:31,644 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 10:21:34 GMT'
    'ETag': '"0x8DE04C22083F3D4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '82cbe88d-601f-0071-73aa-369126000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3941c1e4-a29e-11f0-83a9-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:34 GMT'
2025-10-06 15:51:31,645 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3a610188-a29e-11f0-8e34-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 15:51:31,712 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '82cbe896-601f-0071-7caa-369126000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3a610188-a29e-11f0-8e34-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:34 GMT'
2025-10-06 15:51:31,713 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04C22083F3D4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3a6b6a91-a29e-11f0-8c0b-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 15:51:31,797 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 10:21:35 GMT'
    'ETag': '"0x8DE04C2209D8D7D"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '82cbe89d-601f-0071-01aa-369126000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3a6b6a91-a29e-11f0-8c0b-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:34 GMT'
2025-10-06 15:51:31,798 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL.xlsx
2025-10-06 15:51:31,798 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL.xlsx
2025-10-06 15:51:31,799 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 15:51:31,825 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 15:51:31,825 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_230d3a25_f2b5_4f1b_8a7a_4d367b89d62c
2025-10-06 15:51:31,826 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 15:51:31,826 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 230d3a25-f2b5-4f1b-8a7a-4d367b89d62c created with 3 rows ready for validation
2025-10-06 15:51:31,873 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:31] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 15:51:32,348 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 15:51:32,449 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 15:51:32,608 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 15:51:32,808 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 15:51:32,854 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 15:51:32,866 - data_validation_endpoints - INFO - [VALIDATION] Found 4 errors in 3 rows
2025-10-06 15:51:32,869 - data_validation_endpoints - INFO - Error detection complete: 4 errors found
2025-10-06 15:51:32,915 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 15:51:32,959 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:32] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 15:51:34,615 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:34] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 15:51:40,601 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:40] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 15:51:40,933 - data_validation_endpoints - INFO - [CORRECTION] Applying 1 column corrections
2025-10-06 15:51:40,934 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 15:51:40,954 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 15:51:41,162 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '068489c8-9b36-4180-855d-be259ee85a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:44 GMT'
    'Content-Length': '1753'
2025-10-06 15:51:41,163 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 15:51:41,358 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ad32a1ad-3086-474d-8371-80fc27a48100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:44 GMT'
    'Content-Length': '1688'
2025-10-06 15:51:41,359 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 15:51:41,359 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3fed6a04-a29e-11f0-accb-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 15:51:42,585 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 10:21:45 GMT'
    'ETag': '"0x8DE04C22708AE48"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6d396fa5-e01f-0034-0aab-36187e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3fed6a04-a29e-11f0-accb-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:45 GMT'
2025-10-06 15:51:42,586 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '5048'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '40e6862c-a29e-11f0-96c8-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 15:51:42,656 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6d396fb8-e01f-0034-1dab-36187e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '40e6862c-a29e-11f0-96c8-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:45 GMT'
2025-10-06 15:51:42,657 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F230d3a25-f2b5-4f1b-8a7a-4d367b89d62c%2Fdate_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04C22708AE48"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '40f152f8-a29e-11f0-847b-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 15:51:42,753 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 10:21:46 GMT'
    'ETag': '"0x8DE04C22724B3DD"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '6d396fbe-e01f-0034-23ab-36187e000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '40f152f8-a29e-11f0-847b-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:45 GMT'
2025-10-06 15:51:42,754 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL_corrected.xlsx
2025-10-06 15:51:42,754 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL_corrected.xlsx
2025-10-06 15:51:42,755 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 15:51:43,043 - data_validation_endpoints - INFO - [DATABASE] [OK] Validation history stored with ID: 2
2025-10-06 15:51:43,043 - data_validation_endpoints - INFO - Corrections saved: 1 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL_corrected.xlsx
2025-10-06 15:51:43,091 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:43] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 15:51:43,261 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:43] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 15:51:44,718 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 15:51:44,723 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:44] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:44,723 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:44] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 15:51:44,912 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0ca937d2-016c-41b9-b9fe-a14fa65d6500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:48 GMT'
    'Content-Length': '1753'
2025-10-06 15:51:44,913 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 15:51:44,978 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:44] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 15:51:45,039 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:45] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 15:51:45,078 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ad32a1ad-3086-474d-8371-80fc78a48100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:48 GMT'
    'Content-Length': '1687'
2025-10-06 15:51:45,079 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 15:51:45,079 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.blob.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL_corrected.xlsx'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '422bd425-a29e-11f0-a318-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 15:51:45,847 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '5048'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 06 Oct 2025 10:21:46 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE04C22724B3DD"'
    'Server': 'Windows-Azure-Blob/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': 'afef674c-301e-0015-36ab-369074000000'
    'x-ms-client-request-id': '422bd425-a29e-11f0-a318-3003c8abdcf2'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 10:21:48 GMT'
2025-10-06 15:51:45,850 - __main__ - INFO - Downloaded file from OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/230d3a25-f2b5-4f1b-8a7a-4d367b89d62c/date_SL_corrected.xlsx
2025-10-06 15:51:45,851 - data_validation_endpoints - INFO - [DOWNLOAD] Downloading corrected file: date_corrected.xlsx
2025-10-06 15:51:45,854 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 15:51:45] "GET /api/data-validation/download-corrected HTTP/1.1" 200 -
2025-10-06 16:20:01,918 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints_optimized.py', reloading
2025-10-06 16:20:03,109 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:20:05,347 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:20:05,444 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:20:07,800 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:20:07,902 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:20:08,075 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:20:08,241 - __main__ - INFO - validation_history table ready
2025-10-06 16:20:08,295 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:20:08,381 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:20:08,583 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:20:08,588 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:20:09,431 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:20:09,431 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:20:09,432 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:20:09,432 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:20:09,432 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:20:09,432 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:20:09,433 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:20:09,433 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:20:09,453 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:20:09,464 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:20:16,957 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints_optimized.py', reloading
2025-10-06 16:20:17,115 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:20:18,215 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:20:18,242 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:20:18,971 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:20:18,995 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:20:19,018 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:20:19,083 - __main__ - INFO - validation_history table ready
2025-10-06 16:20:19,106 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:20:19,151 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:20:19,230 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:20:19,237 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:20:20,075 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:20:20,076 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:20:20,076 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:20:20,076 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:20:20,076 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:20:20,077 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:20:20,077 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:20:20,077 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:20:20,088 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:20:20,096 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:20:21,978 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints_optimized.py', reloading
2025-10-06 16:20:22,121 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:20:23,271 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:20:23,301 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:20:24,016 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:20:24,040 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:20:24,063 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:20:24,129 - __main__ - INFO - validation_history table ready
2025-10-06 16:20:24,152 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:20:24,193 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:20:24,252 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:20:24,258 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:20:25,164 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:20:25,165 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:20:25,165 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:20:25,165 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:20:25,166 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:20:25,166 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:20:25,166 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:20:25,166 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:20:25,179 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:20:25,188 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:29:08,114 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\data_validation_endpoints_optimized.py', reloading
2025-10-06 16:29:08,636 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:29:10,129 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:29:10,187 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:29:12,171 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:29:12,206 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:29:12,377 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:29:12,686 - __main__ - INFO - validation_history table ready
2025-10-06 16:29:12,791 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:29:12,994 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:29:13,073 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:29:13,078 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:29:13,908 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:29:13,909 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:29:13,909 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:29:13,909 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:29:13,909 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:29:13,910 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:29:13,910 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:29:13,910 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:29:13,927 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:29:13,935 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:37:14,498 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:37:14,514 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:37:19,100 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:37:19,204 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:37:19,305 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:37:19,614 - __main__ - INFO - validation_history table ready
2025-10-06 16:37:19,721 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:37:19,921 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:37:19,976 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:37:19,980 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:37:20,723 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:37:20,723 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:37:20,723 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:37:20,724 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:37:20,724 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:37:20,724 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:37:20,724 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:37:20,724 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:37:20,752 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 16:37:20,753 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 16:37:20,755 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:37:21,534 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:37:21,550 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:37:23,096 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:37:23,201 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:37:23,301 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:37:23,603 - __main__ - INFO - validation_history table ready
2025-10-06 16:37:23,627 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:37:23,744 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:37:23,798 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:37:23,804 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:37:24,595 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:37:24,595 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:37:24,595 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:37:24,595 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:37:24,595 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:37:24,596 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:37:24,596 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:37:24,596 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:37:24,608 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:37:24,617 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:37:34,056 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:37:34,178 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:37:34,258 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:34] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:37:34,299 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:37:34,461 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:37:34,569 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:34] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:37:43,142 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: date.xlsx by user vamsi@gmail.com
2025-10-06 16:37:43,686 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 4 columns, 3 rows
2025-10-06 16:37:43,687 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 16:37:43,687 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 4 columns
2025-10-06 16:37:43,881 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'date.xlsx'
2025-10-06 16:37:43,881 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=3, Name=date.xlsx
2025-10-06 16:37:43,881 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 4 columns match
2025-10-06 16:37:43,881 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 16:37:45,526 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:37:46,033 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5b4a7781-b043-41e6-84df-aabaf0c35900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:07:49 GMT'
    'Content-Length': '1753'
2025-10-06 16:37:46,047 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:37:46,342 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5707d6ac-3a6f-4dba-89b2-4ac9545f5d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:07:49 GMT'
    'Content-Length': '1692'
2025-10-06 16:37:46,343 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:37:46,344 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0dab829d-e99a-45b0-a968-6a3695ac0bdc%2Fdate_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'afbd7f9d-a2a4-11f0-a75c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:37:48,490 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:07:51 GMT'
    'ETag': '"0x8DE04C8978FD478"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '99f9f0dc-501f-0003-31b1-3666a3000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'afbd7f9d-a2a4-11f0-a75c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:07:51 GMT'
2025-10-06 16:37:48,492 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0dab829d-e99a-45b0-a968-6a3695ac0bdc%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '16591'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b1822866-a2a4-11f0-b91e-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:37:48,593 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '99f9f0f2-501f-0003-47b1-3666a3000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b1822866-a2a4-11f0-b91e-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:07:51 GMT'
2025-10-06 16:37:48,595 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F0dab829d-e99a-45b0-a968-6a3695ac0bdc%2Fdate_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04C8978FD478"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b191e13c-a2a4-11f0-a7fa-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:37:48,694 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:07:51 GMT'
    'ETag': '"0x8DE04C897BC3885"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '99f9f0f7-501f-0003-4bb1-3666a3000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b191e13c-a2a4-11f0-a7fa-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:07:51 GMT'
2025-10-06 16:37:48,695 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/0dab829d-e99a-45b0-a968-6a3695ac0bdc/date_SL.xlsx
2025-10-06 16:37:48,696 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/0dab829d-e99a-45b0-a968-6a3695ac0bdc/date_SL.xlsx
2025-10-06 16:37:48,696 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 16:37:48,722 - __main__ - INFO - File loaded for validation: date.xlsx (3 rows)
2025-10-06 16:37:48,723 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_0dab829d_e99a_45b0_a968_6a3695ac0bdc
2025-10-06 16:37:48,724 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: date.xlsx matched with template date.xlsx (ID: 3)
2025-10-06 16:37:48,724 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 0dab829d-e99a-45b0-a968-6a3695ac0bdc created with 3 rows ready for validation
2025-10-06 16:37:48,906 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:48] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 16:37:49,413 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:49] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 16:37:49,519 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:37:49,864 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 4 rule sets
2025-10-06 16:37:49,874 - data_validation_endpoints - INFO - [VALIDATION] Found 4 errors in 3 rows
2025-10-06 16:37:49,878 - data_validation_endpoints - INFO - Error detection complete: 4 errors found
2025-10-06 16:37:49,890 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:49] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 16:37:49,890 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:37:49,911 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:49] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 16:37:50,281 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:50] "GET /api/rule-config/get-template/3 HTTP/1.1" 200 -
2025-10-06 16:37:52,683 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:37:52,685 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:37:52,932 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:37:53,010 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:37:54,329 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:37:54,648 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:37:54,658 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:37:54,839 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:37:54,839 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:37:54,839 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:37:54,840 - rule_configuration_endpoints - INFO - [HISTORY] Found 3 configured templates
2025-10-06 16:37:54,943 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:54] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:37:55,264 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:37:55,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:37:55,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:37:55,453 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:37:55,453 - rule_configuration_endpoints - INFO - [HISTORY] Found 3 configured templates
2025-10-06 16:37:55,558 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:37:55] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:38:02,043 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: Vehicle_Billing_Datain.csv by user vamsi@gmail.com
2025-10-06 16:38:02,043 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for Vehicle_Billing_Datain.csv
2025-10-06 16:38:02,043 - __main__ - INFO - Starting DuckDB analysis for file: 7f2405b8-690e-445a-8d28-f41ac800a04e_Vehicle_Billing_Datain.csv
2025-10-06 16:38:02,124 - __main__ - INFO - File analysis completed: 25189 rows, 14 columns
2025-10-06 16:38:02,135 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 25189, Columns: 14
2025-10-06 16:38:02,136 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-06 16:38:02,313 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-06 16:38:02,722 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=9, Name=Vehicle_Billing_Datain
2025-10-06 16:38:02,829 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:02] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-06 16:38:03,343 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:03] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:38:03,548 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:03] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:03,549 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:03] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:38:04,057 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:04] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:04,365 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:04] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:11,920 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:11] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-06 16:38:13,065 - rule_configuration_endpoints - INFO - Headers selected for template 9: ['SOLD TO PARTY', 'SALES ORG']
2025-10-06 16:38:13,171 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:13] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-06 16:38:13,580 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:13] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:28,615 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:28] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:38:30,986 - rule_configuration_endpoints - INFO - Rules configured for template 9: {'SOLD TO PARTY': ['Required', 'Int'], 'SALES ORG': ['Required', 'Int']}
2025-10-06 16:38:31,092 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:31] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:38:31,504 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:31] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:32,221 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:32] "GET /api/rule-config/get-template-rules/9 HTTP/1.1" 200 -
2025-10-06 16:38:34,394 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:34] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:38:36,516 - rule_configuration_endpoints - INFO - Rules configured for template 9: {'SALES ORG': ['Int', 'Required'], 'SOLD TO PARTY': ['Int', 'Required']}
2025-10-06 16:38:36,620 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:36] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:38:36,952 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:38:36,955 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:36] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:38:37,130 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:38:37,130 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:38:37,131 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:38:37,131 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:38:37,131 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-06 16:38:37,208 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:37] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:38:37,236 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:37] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:38:37,268 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:38:37,437 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:38:37,438 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:38:37,438 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:38:37,438 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:38:37,438 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-06 16:38:37,543 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:37] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:38:39,710 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:38:39,895 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:38:40,001 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:40] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:38:40,324 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:38:40,510 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:38:40,614 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:40] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:38:51,808 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Vehicle_Billing_Datain.csv by user vamsi@gmail.com
2025-10-06 16:38:51,865 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 14 columns, 25189 rows
2025-10-06 16:38:51,865 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 16:38:51,865 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 14 columns
2025-10-06 16:38:51,979 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'Vehicle_Billing_Datain'
2025-10-06 16:38:51,979 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Filename also matches - perfect match!
2025-10-06 16:38:51,979 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=9, Name=Vehicle_Billing_Datain
2025-10-06 16:38:51,979 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 14 columns match
2025-10-06 16:38:51,980 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 16:38:51,984 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:38:52,497 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '897d69c7-8e7b-4e15-998c-65d90ce38900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:08:54 GMT'
    'Content-Length': '1753'
2025-10-06 16:38:52,498 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:38:52,800 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0c407712-1bec-4bce-bbf3-3ad176a96e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:08:55 GMT'
    'Content-Length': '1692'
2025-10-06 16:38:52,800 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:38:52,801 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F88b78c27-43b1-4504-85b5-ebebad5fedff%2FVehicle_Billing_Datain_SL.csv?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd75a5fc9-a2a4-11f0-bf80-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:38:53,925 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:08:56 GMT'
    'ETag': '"0x8DE04C8BE891764"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b8ba701-401f-002d-77b1-3698c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'd75a5fc9-a2a4-11f0-bf80-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:08:57 GMT'
2025-10-06 16:38:53,926 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F88b78c27-43b1-4504-85b5-ebebad5fedff%2FVehicle_Billing_Datain_SL.csv?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1867930'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd882a7df-a2a4-11f0-8011-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:38:54,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b8ba70e-401f-002d-02b1-3698c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'd882a7df-a2a4-11f0-8011-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:08:57 GMT'
2025-10-06 16:38:54,173 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F88b78c27-43b1-4504-85b5-ebebad5fedff%2FVehicle_Billing_Datain_SL.csv?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04C8BE891764"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'd8a85391-a2a4-11f0-a623-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:38:54,261 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:08:57 GMT'
    'ETag': '"0x8DE04C8BED2B4BD"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '0b8ba721-401f-002d-13b1-3698c5000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'd8a85391-a2a4-11f0-a623-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:08:57 GMT'
2025-10-06 16:38:54,261 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/88b78c27-43b1-4504-85b5-ebebad5fedff/Vehicle_Billing_Datain_SL.csv
2025-10-06 16:38:54,262 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/88b78c27-43b1-4504-85b5-ebebad5fedff/Vehicle_Billing_Datain_SL.csv
2025-10-06 16:38:54,262 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 16:38:54,333 - __main__ - INFO - File loaded for validation: Vehicle_Billing_Datain.csv (25189 rows)
2025-10-06 16:38:54,334 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_88b78c27_43b1_4504_85b5_ebebad5fedff
2025-10-06 16:38:54,335 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: Vehicle_Billing_Datain.csv matched with template Vehicle_Billing_Datain (ID: 9)
2025-10-06 16:38:54,335 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 88b78c27-43b1-4504-85b5-ebebad5fedff created with 25189 rows ready for validation
2025-10-06 16:38:54,362 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:54] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 16:38:54,461 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:54] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:54,725 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:54] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:38:54,805 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 2 rule sets
2025-10-06 16:38:55,018 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:55] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:55,072 - data_validation_endpoints - INFO - [VALIDATION] Found 25189 errors in 25189 rows
2025-10-06 16:38:55,529 - data_validation_endpoints - INFO - Error detection complete: 25189 errors found
2025-10-06 16:38:55,761 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:55] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:38:55,820 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:55] "GET /api/rule-config/get-template/9 HTTP/1.1" 200 -
2025-10-06 16:38:55,969 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:38:55] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 16:47:51,331 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:47:51,413 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:47:53,840 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:47:53,892 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:47:53,951 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:47:54,045 - __main__ - INFO - validation_history table ready
2025-10-06 16:47:54,067 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:47:54,108 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:47:54,180 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:47:54,184 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:47:54,937 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:47:54,937 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:47:54,938 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:47:54,938 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:47:54,938 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:47:54,938 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:47:54,938 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:47:54,938 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:47:54,970 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-06 16:47:54,970 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-06 16:47:54,973 - werkzeug - INFO -  * Restarting with stat
2025-10-06 16:47:55,829 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-06 16:47:55,850 - __main__ - INFO - DuckDB memory tables initialized
2025-10-06 16:47:57,507 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-06 16:47:57,608 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-06 16:47:57,713 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-06 16:47:57,834 - __main__ - INFO - validation_history table ready
2025-10-06 16:47:57,917 - __main__ - INFO - validation_corrections table ready
2025-10-06 16:47:58,121 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-06 16:47:58,177 - data_validation_endpoints - INFO - Data validation endpoints registered successfully
2025-10-06 16:47:58,181 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-06 16:47:59,099 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-06 16:47:59,103 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-06 16:47:59,104 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-06 16:47:59,109 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-06 16:47:59,111 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-06 16:47:59,120 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-06 16:47:59,131 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-06 16:47:59,132 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-06 16:47:59,149 - werkzeug - WARNING -  * Debugger is active!
2025-10-06 16:47:59,166 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-06 16:48:11,657 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:11,948 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:12,588 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:48:12,685 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:12] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:13,352 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:13] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:48:13,493 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:13] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:16,645 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:48:16,763 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:48:16,766 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:48:16,766 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:48:16,766 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:48:16,769 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-06 16:48:16,837 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:16] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:17,174 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:17] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:48:17,349 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:48:17,608 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:48:17,784 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:48:17,785 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:48:17,785 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:48:17,785 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:48:17,785 - rule_configuration_endpoints - INFO - [HISTORY] Found 4 configured templates
2025-10-06 16:48:18,051 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:18] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:48:25,507 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: Test_18_07.xlsx by user vamsi@gmail.com
2025-10-06 16:48:25,507 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for Test_18_07.xlsx
2025-10-06 16:48:25,507 - __main__ - INFO - Starting DuckDB analysis for file: 6989a65a-453b-4717-bba4-394870db0a53_Test_18_07.xlsx
2025-10-06 16:48:26,030 - __main__ - INFO - File analysis completed: 14 rows, 6 columns
2025-10-06 16:48:26,043 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 14, Columns: 6
2025-10-06 16:48:26,043 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-06 16:48:26,070 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-06 16:48:26,165 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=10, Name=Test_18_07
2025-10-06 16:48:26,414 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:26] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-06 16:48:27,545 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:27] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:48:27,904 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:27] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:48:28,082 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:28] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:48:28,602 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:28] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:48:29,263 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:29] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:48:39,112 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:39] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-06 16:48:40,924 - rule_configuration_endpoints - INFO - Headers selected for template 10: ['Sno', 'Name ', 'Date', 'Salary', 'Emp id', 'Comprassion']
2025-10-06 16:48:41,191 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:41] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-06 16:48:41,916 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:48:41] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:49:31,790 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:31] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:49:36,841 - rule_configuration_endpoints - INFO - Rules configured for template 10: {'Sno': ['Required', 'Int'], 'Name ': ['Required', 'Text'], 'Date': ['Required', 'Alphanumeric'], 'Salary': ['Required', 'Int'], 'Emp id': ['Required', 'Int'], 'Comprassion': ['Required', 'Int']}
2025-10-06 16:49:37,133 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:37] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:49:38,134 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:38] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:49:38,773 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:38] "GET /api/rule-config/get-template-rules/10 HTTP/1.1" 200 -
2025-10-06 16:49:42,671 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:42] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:49:45,092 - rule_configuration_endpoints - INFO - Rules configured for template 10: {'Comprassion': ['Int', 'Required'], 'Date': ['Alphanumeric', 'Required'], 'Emp id': ['Int', 'Required'], 'Name ': ['Required', 'Text'], 'Salary': ['Int', 'Required'], 'Sno': ['Int', 'Required']}
2025-10-06 16:49:45,274 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:45] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-06 16:49:45,753 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:49:45,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-06 16:49:45,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:49:45,776 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:49:45,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:49:45,777 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:49:45,777 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-06 16:49:45,792 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:45] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:49:45,976 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:45] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:49:46,513 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-06 16:49:46,516 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:49:46,582 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-06 16:49:46,583 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-06 16:49:46,583 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-06 16:49:46,583 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-06 16:49:46,583 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-06 16:49:46,583 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-06 16:49:46,852 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:46] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-06 16:49:50,333 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:49:50,459 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:49:50,834 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:50] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:49:50,957 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:49:51,071 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 2 validation sessions
2025-10-06 16:49:51,347 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:49:51] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:50:05,160 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Test_18_07.xlsx by user vamsi@gmail.com
2025-10-06 16:50:05,172 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 6 columns, 14 rows
2025-10-06 16:50:05,172 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 16:50:05,172 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 6 columns
2025-10-06 16:50:05,220 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'Test_18_07'
2025-10-06 16:50:05,221 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Filename also matches - perfect match!
2025-10-06 16:50:05,221 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=10, Name=Test_18_07
2025-10-06 16:50:05,221 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 6 columns match
2025-10-06 16:50:05,222 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 16:50:07,200 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:50:07,763 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '60ef1c62-95a1-4ac7-bf82-74a361648500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:20:10 GMT'
    'Content-Length': '1753'
2025-10-06 16:50:07,780 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:50:08,174 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ddf9cc7d-aefe-4ccd-9cfe-7d2a31dc7a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:20:11 GMT'
    'Content-Length': '1691'
2025-10-06 16:50:08,175 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:50:08,176 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '69cffd66-a2a6-11f0-b443-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:50:08,992 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:20:12 GMT'
    'ETag': '"0x8DE04CA50EB38BC"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '532dccb4-201f-0066-42b3-366496000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '69cffd66-a2a6-11f0-b443-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:20:11 GMT'
2025-10-06 16:50:08,994 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '9957'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6ae1dc31-a2a6-11f0-8a12-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:50:09,094 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '532dccbe-201f-0066-4cb3-366496000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6ae1dc31-a2a6-11f0-8a12-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:20:12 GMT'
2025-10-06 16:50:09,095 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CA50EB38BC"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '6af141eb-a2a6-11f0-9b44-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:50:09,197 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:20:12 GMT'
    'ETag': '"0x8DE04CA51165621"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '532dccc4-201f-0066-52b3-366496000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '6af141eb-a2a6-11f0-9b44-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:20:12 GMT'
2025-10-06 16:50:09,198 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL.xlsx
2025-10-06 16:50:09,198 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL.xlsx
2025-10-06 16:50:09,199 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 16:50:09,215 - __main__ - INFO - File loaded for validation: Test_18_07.xlsx (14 rows)
2025-10-06 16:50:09,215 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_2adbf4c5_1fa6_43c9_8707_9eaa72e895f2
2025-10-06 16:50:09,216 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: Test_18_07.xlsx matched with template Test_18_07 (ID: 10)
2025-10-06 16:50:09,216 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 2adbf4c5-1fa6-43c9-8707-9eaa72e895f2 created with 14 rows ready for validation
2025-10-06 16:50:09,402 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:09] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 16:50:10,123 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:10] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:50:10,269 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:10] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:50:10,848 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 6 rule sets
2025-10-06 16:50:10,864 - data_validation_endpoints - INFO - [VALIDATION] Found 27 errors in 13 rows
2025-10-06 16:50:10,884 - data_validation_endpoints - INFO - Error detection complete: 27 errors found
2025-10-06 16:50:10,959 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:10] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 16:50:11,379 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:11] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:50:11,379 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:11] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:50:12,343 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:12] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:50:19,597 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:50:19] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:51:52,386 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:51:52] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:51:52,937 - data_validation_endpoints - INFO - [CORRECTION] Applying 4 column corrections
2025-10-06 16:51:52,944 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 16:52:03,524 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:52:04,101 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '04f8c14b-23f7-4c27-ab46-a2814cf47d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:06 GMT'
    'Content-Length': '1753'
2025-10-06 16:52:04,102 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:52:04,401 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '35905f1d-037a-4fb2-918b-94cdf0995a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:06 GMT'
    'Content-Length': '1691'
2025-10-06 16:52:04,402 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:52:04,402 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'af25afe8-a2a6-11f0-903c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:05,275 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:05] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:52:05,323 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:08 GMT'
    'ETag': '"0x8DE04CA963CA27C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1cc8ab41-101f-005f-44b3-3633fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'af25afe8-a2a6-11f0-903c-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:08 GMT'
2025-10-06 16:52:05,325 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1468782'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b038816e-a2a6-11f0-9202-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:52:05,480 - data_validation_endpoints - INFO - [CORRECTION] Applying 4 column corrections
2025-10-06 16:52:05,487 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 16:52:05,646 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1cc8ab62-101f-005f-64b3-3633fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b038816e-a2a6-11f0-9202-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:08 GMT'
2025-10-06 16:52:05,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CA963CA27C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'b06e65e2-a2a6-11f0-bcab-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:06,238 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:09 GMT'
    'ETag': '"0x8DE04CA96B783C9"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '1cc8aba6-101f-005f-28b3-3633fb000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'b06e65e2-a2a6-11f0-bcab-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:09 GMT'
2025-10-06 16:52:06,254 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:06,301 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:07,013 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 16:52:07,281 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): 'Date'
2025-10-06 16:52:07,311 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 16:52:07,342 - data_validation_endpoints - INFO - Corrections saved: 4 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:10,902 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:10] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:52:11,062 - data_validation_endpoints - INFO - [CORRECTION] Applying 4 column corrections
2025-10-06 16:52:11,089 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 16:52:19,267 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:19] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:52:26,484 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:52:27,155 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ab063e35-9d79-4fb0-8038-6a0663b95000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:29 GMT'
    'Content-Length': '1753'
2025-10-06 16:52:27,168 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:52:27,569 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '9f7b1014-2399-42f9-9375-4c61cd525f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:29 GMT'
    'Content-Length': '1692'
2025-10-06 16:52:27,574 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:52:27,587 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.blob.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx'
Request method: 'GET'
Request headers:
    'x-ms-range': 'REDACTED'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/xml'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bcd52ef6-a2a6-11f0-b5f6-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:28,146 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:52:28,167 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:28] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:52:28,609 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 206
Response headers:
    'Content-Length': '1468782'
    'Content-Type': 'application/octet-stream'
    'Content-Range': 'REDACTED'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:09 GMT'
    'Accept-Ranges': 'REDACTED'
    'ETag': '"0x8DE04CA96B783C9"'
    'Server': 'Windows-Azure-Blob/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-id': '812ba0e6-801e-0032-30b3-362bc1000000'
    'x-ms-client-request-id': 'bcd52ef6-a2a6-11f0-b5f6-3003c8abdcf2'
    'x-ms-version': 'REDACTED'
    'x-ms-resource-type': 'REDACTED'
    'x-ms-creation-time': 'REDACTED'
    'x-ms-lease-status': 'REDACTED'
    'x-ms-lease-state': 'REDACTED'
    'x-ms-blob-type': 'REDACTED'
    'x-ms-server-encrypted': 'REDACTED'
    'x-ms-owner': 'REDACTED'
    'x-ms-group': 'REDACTED'
    'x-ms-permissions': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:31 GMT'
2025-10-06 16:52:29,417 - __main__ - INFO - Downloaded file from OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:29,427 - data_validation_endpoints - INFO - [DOWNLOAD] Downloading corrected file: Test_18_07_corrected.xlsx
2025-10-06 16:52:30,110 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:30] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-06 16:52:30,153 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:30] "GET /api/data-validation/download-corrected HTTP/1.1" 200 -
2025-10-06 16:52:30,191 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:30] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-06 16:52:30,692 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:52:30,708 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:52:30,879 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '045831df-e2bf-4fe2-b4ba-01acb4796300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:34 GMT'
    'Content-Length': '1753'
2025-10-06 16:52:30,880 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:52:30,937 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c1dd6856-7268-46b3-831b-3b39d4a68600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:33 GMT'
    'Content-Length': '1753'
2025-10-06 16:52:30,939 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:52:31,043 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f2070716-c7f9-45bd-97b2-f6eb6e916600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:34 GMT'
    'Content-Length': '1693'
2025-10-06 16:52:31,045 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:52:31,045 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bf59b116-a2a6-11f0-824a-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:31,172 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '1bda9406-33d0-42c1-bb7c-0ce3ebca8e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:33 GMT'
    'Content-Length': '1688'
2025-10-06 16:52:31,174 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:52:31,175 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bf573a60-a2a6-11f0-b3a8-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:31,395 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:34 GMT'
    'ETag': '"0x8DE04CAA5D856E4"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5f491776-401f-0076-73b3-36fd45000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bf59b116-a2a6-11f0-824a-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:33 GMT'
2025-10-06 16:52:31,397 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1468782'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfc2c6fa-a2a6-11f0-afff-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:52:31,503 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:34 GMT'
    'ETag': '"0x8DE04CAA5E8D470"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '50e7fdff-c01f-0033-39b3-36741d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bf573a60-a2a6-11f0-b3a8-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:34 GMT'
2025-10-06 16:52:31,505 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1468783'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfd35b6b-a2a6-11f0-865b-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:52:31,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '5f49177e-401f-0076-7bb3-36fd45000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bfc2c6fa-a2a6-11f0-afff-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:33 GMT'
2025-10-06 16:52:31,618 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CAA5D856E4"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfe492a9-a2a6-11f0-9f49-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:31,659 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 412
Response headers:
    'Content-Length': '200'
    'Content-Type': 'application/json; charset=utf-8'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-error-code': 'ConditionNotMet'
    'x-ms-request-id': '5f491792-401f-0076-0fb3-36fd45000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bfe492a9-a2a6-11f0-9f49-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:33 GMT'
2025-10-06 16:52:31,660 - __main__ - ERROR - Failed to store corrected file in OneLake: (ConditionNotMet) The condition specified using HTTP conditional header(s) is not met.
RequestId:5f491792-401f-0076-0fb3-36fd45000000
Time:2025-10-06T11:22:34.8415065Z
Code: ConditionNotMet
Message: The condition specified using HTTP conditional header(s) is not met.
RequestId:5f491792-401f-0076-0fb3-36fd45000000
Time:2025-10-06T11:22:34.8415065Z
2025-10-06 16:52:31,761 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '50e7fe0b-c01f-0033-45b3-36741d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bfd35b6b-a2a6-11f0-865b-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:34 GMT'
2025-10-06 16:52:31,793 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F2adbf4c5-1fa6-43c9-8707-9eaa72e895f2%2FTest_18_07_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CAA5E8D470"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': 'bfff4892-a2a6-11f0-a6e8-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:52:31,997 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:22:35 GMT'
    'ETag': '"0x8DE04CAA63232B1"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '50e7fe1e-c01f-0033-58b3-36741d000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': 'bfff4892-a2a6-11f0-a6e8-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:22:34 GMT'
2025-10-06 16:52:32,028 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:32,058 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:32,741 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 16:52:33,053 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): 'Date'
2025-10-06 16:52:33,084 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 16:52:33,115 - data_validation_endpoints - INFO - Corrections saved: 4 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:37,332 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:37] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:52:46,537 - __main__ - INFO - Stored corrected file locally: validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:46,539 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:46,989 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 16:52:47,060 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): 'Date'
2025-10-06 16:52:47,060 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 16:52:47,061 - data_validation_endpoints - INFO - Corrections saved: 4 corrections applied, stored at: validation/corrected/1/2adbf4c5-1fa6-43c9-8707-9eaa72e895f2/Test_18_07_SL_corrected.xlsx
2025-10-06 16:52:47,374 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:52:47] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:54:29,781 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:54:29,917 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 5 validation sessions
2025-10-06 16:54:30,261 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:30] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:54:30,401 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Fetching for user vamsi@gmail.com
2025-10-06 16:54:30,529 - data_validation_endpoints - INFO - [VALIDATION HISTORY] Found 5 validation sessions
2025-10-06 16:54:30,862 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:30] "GET /api/data-validation/history HTTP/1.1" 200 -
2025-10-06 16:54:46,611 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File upload initiated: Test_18_07_1.xlsx by user vamsi@gmail.com
2025-10-06 16:54:46,623 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] File has 6 columns, 14 rows
2025-10-06 16:54:46,624 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Searching for template by header structure...
2025-10-06 16:54:46,624 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] Uploaded file has 6 columns
2025-10-06 16:54:46,647 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Structure match found: Template 'Test_18_07'
2025-10-06 16:54:46,648 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Template matched: ID=10, Name=Test_18_07
2025-10-06 16:54:46,648 - data_validation_endpoints - INFO - [TEMPLATE LOOKUP] [OK] Header verification passed - 6 columns match
2025-10-06 16:54:46,648 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing original file in Lakehouse with *_SL suffix
2025-10-06 16:54:46,651 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:54:46,900 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a3a015b6-d69c-4436-93c4-1b6ff2a67300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:24:49 GMT'
    'Content-Length': '1753'
2025-10-06 16:54:46,902 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:54:47,154 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '35905f1d-037a-4fb2-918b-94cd42b25a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:24:50 GMT'
    'Content-Length': '1691'
2025-10-06 16:54:47,155 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:54:47,156 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '1060f6cb-a2a7-11f0-988b-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:54:47,558 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:24:50 GMT'
    'ETag': '"0x8DE04CAF702974C"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7e8fa4dd-b01f-005d-30b3-367d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '1060f6cb-a2a7-11f0-988b-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:24:50 GMT'
2025-10-06 16:54:47,560 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '10101'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '10ebac42-a2a7-11f0-b5af-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:54:47,617 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7e8fa4e1-b01f-005d-34b3-367d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '10ebac42-a2a7-11f0-b5af-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:24:50 GMT'
2025-10-06 16:54:47,618 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Foriginal%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CAF702974C"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '10f48909-a2a7-11f0-a352-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:54:47,702 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:24:50 GMT'
    'ETag': '"0x8DE04CAF716E939"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': '7e8fa4e4-b01f-005d-37b3-367d89000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '10f48909-a2a7-11f0-a352-3003c8abdcf2'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:24:50 GMT'
2025-10-06 16:54:47,703 - __main__ - INFO - Stored original file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL.xlsx
2025-10-06 16:54:47,704 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Original file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/original/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL.xlsx
2025-10-06 16:54:47,704 - data_validation_endpoints - INFO - [DUCKDB] Loading file into in-memory database for validation
2025-10-06 16:54:47,717 - __main__ - INFO - File loaded for validation: Test_18_07_1.xlsx (14 rows)
2025-10-06 16:54:47,717 - data_validation_endpoints - INFO - [DUCKDB] [OK] File loaded into table: validation_data_115bbe86_3c12_4602_8804_8acffcbad84f
2025-10-06 16:54:47,718 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] [OK] Upload complete: Test_18_07_1.xlsx matched with template Test_18_07 (ID: 10)
2025-10-06 16:54:47,718 - data_validation_endpoints - INFO - [VALIDATION UPLOAD] Session 115bbe86-3c12-4602-8804-8acffcbad84f created with 14 rows ready for validation
2025-10-06 16:54:47,978 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:47] "POST /api/data-validation/upload HTTP/1.1" 200 -
2025-10-06 16:54:49,010 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:54:49,301 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:49] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:54:49,576 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:49] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-06 16:54:50,091 - data_validation_endpoints - INFO - [VALIDATION] Starting error detection with 6 rule sets
2025-10-06 16:54:50,096 - data_validation_endpoints - INFO - [VALIDATION] Found 29 errors in 14 rows
2025-10-06 16:54:50,109 - data_validation_endpoints - INFO - Error detection complete: 29 errors found
2025-10-06 16:54:50,417 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:50] "POST /api/data-validation/detect-errors HTTP/1.1" 200 -
2025-10-06 16:54:50,466 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:50] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:54:51,354 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:51] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:54:55,045 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:54:55] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:55:26,295 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:55:26] "OPTIONS /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:55:26,915 - data_validation_endpoints - INFO - [CORRECTION] Applying 4 column corrections
2025-10-06 16:55:26,921 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 16:55:32,115 - data_validation_endpoints - INFO - [CORRECTION] Applying 4 column corrections
2025-10-06 16:55:32,129 - data_validation_endpoints - INFO - [LAKEHOUSE] Storing corrected file in Lakehouse with *_SL suffix
2025-10-06 16:55:48,035 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:55:48,090 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
No body was attached to the request
2025-10-06 16:55:48,579 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'f4c18ef9-cb05-43aa-bd81-0960010b5400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:51 GMT'
    'Content-Length': '1753'
2025-10-06 16:55:48,580 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:55:48,668 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5db7507c-c383-452e-91ce-238ea7de9800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:51 GMT'
    'Content-Length': '1753'
2025-10-06 16:55:48,670 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://login.microsoftonline.com/5e9613ad-7abe-497b-9548-d462ce17e43b/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.14.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
A body is sent with the request
2025-10-06 16:55:48,870 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '39cb7f57-4c7b-4fb9-87f6-d244eb426800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:51 GMT'
    'Content-Length': '1692'
2025-10-06 16:55:48,871 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:55:48,871 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '34f7696d-a2a7-11f0-9a4c-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:55:48,975 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'cf0310d4-4fb4-4755-9cbc-91ec905a5f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
    'Content-Length': '1687'
2025-10-06 16:55:48,976 - azure.identity._internal.get_token_mixin - INFO - ClientSecretCredential.get_token succeeded
2025-10-06 16:55:48,977 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?resource=REDACTED'
Request method: 'PUT'
Request headers:
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '34ffb978-a2a7-11f0-8ffd-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:55:49,585 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:25:52 GMT'
    'ETag': '"0x8DE04CB1BEF2A84"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd6e8e862-b01f-0034-3fb3-36b40f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '34f7696d-a2a7-11f0-9a4c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
2025-10-06 16:55:49,587 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1468783'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '35e44306-a2a7-11f0-a59c-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:55:49,678 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 201
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:25:52 GMT'
    'ETag': '"0x8DE04CB1C0A4C58"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f6d45110-b01f-004d-68b3-36b8e1000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '34ffb978-a2a7-11f0-8ffd-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
2025-10-06 16:55:49,679 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?action=REDACTED&position=REDACTED'
Request method: 'PATCH'
Request headers:
    'Content-Length': '1468783'
    'x-ms-version': 'REDACTED'
    'Content-Type': 'application/json'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '35f252b2-a2a7-11f0-ad0b-3003c8abdcf2'
    'Authorization': 'REDACTED'
A body is sent with the request
2025-10-06 16:55:49,805 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'd6e8e864-b01f-0034-40b3-36b40f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '35e44306-a2a7-11f0-a59c-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
2025-10-06 16:55:49,806 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CB1BEF2A84"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3605a60a-a2a7-11f0-a706-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:55:49,861 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 412
Response headers:
    'Content-Length': '200'
    'Content-Type': 'application/json'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-error-code': 'ConditionNotMet'
    'x-ms-request-id': 'd6e8e866-b01f-0034-42b3-36b40f000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3605a60a-a2a7-11f0-a706-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
2025-10-06 16:55:49,862 - __main__ - ERROR - Failed to store corrected file in OneLake: (ConditionNotMet) The condition specified using HTTP conditional header(s) is not met.
RequestId:d6e8e866-b01f-0034-42b3-36b40f000000
Time:2025-10-06T11:25:53.0385510Z
Code: ConditionNotMet
Message: The condition specified using HTTP conditional header(s) is not met.
RequestId:d6e8e866-b01f-0034-42b3-36b40f000000
Time:2025-10-06T11:25:53.0385510Z
2025-10-06 16:55:49,885 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 202
Response headers:
    'Content-Length': '0'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f6d45119-b01f-004d-71b3-36b8e1000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '35f252b2-a2a7-11f0-ad0b-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:52 GMT'
2025-10-06 16:55:49,905 - azure.core.pipeline.policies.http_logging_policy - INFO - Request URL: 'https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse%2FFiles%2FSL_files%2Fvalidation%2Fcorrected%2F1%2F115bbe86-3c12-4602-8804-8acffcbad84f%2FTest_18_07_1_SL_corrected.xlsx?action=REDACTED&position=REDACTED&close=REDACTED'
Request method: 'PATCH'
Request headers:
    'If-Match': '"0x8DE04CB1C0A4C58"'
    'x-ms-version': 'REDACTED'
    'Accept': 'application/json'
    'User-Agent': 'azsdk-python-storage-dfs/12.12.0 Python/3.13.3 (Windows-11-10.0.26220-SP0)'
    'x-ms-date': 'REDACTED'
    'x-ms-client-request-id': '3614ba4b-a2a7-11f0-9028-3003c8abdcf2'
    'Authorization': 'REDACTED'
No body was attached to the request
2025-10-06 16:55:50,059 - azure.core.pipeline.policies.http_logging_policy - INFO - Response status: 200
Response headers:
    'Content-Length': '0'
    'Last-Modified': 'Mon, 06 Oct 2025 11:25:53 GMT'
    'ETag': '"0x8DE04CB1C3FF439"'
    'Server': 'Windows-Azure-HDFS/1.0,Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0 Microsoft-HTTPAPI/2.0'
    'x-ms-request-server-encrypted': 'REDACTED'
    'x-ms-request-id': 'f6d45138-b01f-004d-10b3-36b8e1000000'
    'x-ms-version': 'REDACTED'
    'x-ms-client-request-id': '3614ba4b-a2a7-11f0-9028-3003c8abdcf2'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Headers': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'Access-Control-Expose-Headers': 'REDACTED'
    'x-ms-root-activity-id': 'REDACTED'
    'Date': 'Mon, 06 Oct 2025 11:25:53 GMT'
2025-10-06 16:55:50,084 - __main__ - INFO - Stored corrected file in OneLake: Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:50,114 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:50,832 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 16:55:51,128 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): 'Date'
2025-10-06 16:55:51,159 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 16:55:51,175 - data_validation_endpoints - INFO - Corrections saved: 4 corrections applied, stored at: onelake://Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files/validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:54,536 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:55:54] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-06 16:55:56,669 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:55:56] "GET /api/rule-config/get-template/10 HTTP/1.1" 200 -
2025-10-06 16:55:59,086 - __main__ - INFO - Stored corrected file locally: validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:59,087 - data_validation_endpoints - INFO - [LAKEHOUSE] [OK] Corrected file stored at: validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:59,313 - data_validation_endpoints - INFO - [DATABASE] Storing validation history and corrections
2025-10-06 16:55:59,640 - data_validation_endpoints - WARNING - [DATABASE] Failed to save to database (non-critical): 'Date'
2025-10-06 16:55:59,640 - data_validation_endpoints - INFO - [DATABASE] Continuing without database save - file was saved successfully
2025-10-06 16:55:59,640 - data_validation_endpoints - INFO - Corrections saved: 4 corrections applied, stored at: validation/corrected/1/115bbe86-3c12-4602-8804-8acffcbad84f/Test_18_07_1_SL_corrected.xlsx
2025-10-06 16:55:59,815 - werkzeug - INFO - 127.0.0.1 - - [06/Oct/2025 16:55:59] "POST /api/data-validation/save-corrections HTTP/1.1" 200 -
2025-10-07 11:57:52,656 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 11:57:52,744 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 11:57:55,742 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 11:57:55,828 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 11:57:55,927 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 11:57:56,233 - __main__ - INFO - validation_history table ready
2025-10-07 11:57:56,266 - __main__ - INFO - validation_corrections table ready
2025-10-07 11:57:56,438 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 11:59:00,581 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 11:59:00,601 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 11:59:02,492 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 11:59:02,516 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 11:59:02,595 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 11:59:02,898 - __main__ - INFO - validation_history table ready
2025-10-07 11:59:03,000 - __main__ - INFO - validation_corrections table ready
2025-10-07 11:59:03,206 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 11:59:03,272 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 11:59:04,029 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 11:59:04,030 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 11:59:04,030 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 11:59:04,030 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 11:59:04,031 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 11:59:04,031 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 11:59:04,031 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 11:59:04,031 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 11:59:04,081 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 11:59:04,082 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 11:59:04,087 - werkzeug - INFO -  * Restarting with stat
2025-10-07 11:59:05,026 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 11:59:05,042 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 11:59:06,380 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 11:59:06,481 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 11:59:06,591 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 11:59:06,892 - __main__ - INFO - validation_history table ready
2025-10-07 11:59:06,997 - __main__ - INFO - validation_corrections table ready
2025-10-07 11:59:07,201 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 11:59:07,264 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 11:59:08,003 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 11:59:08,003 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 11:59:08,004 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 11:59:08,004 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 11:59:08,004 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 11:59:08,004 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 11:59:08,004 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 11:59:08,005 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 11:59:08,014 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 11:59:08,023 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 11:59:37,236 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:37] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 11:59:37,481 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:37] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 11:59:39,647 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:39] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 11:59:40,018 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-07 11:59:40,095 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:40] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 11:59:40,599 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:40,864 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:40,929 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 11:59:40,930 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:40] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:41,177 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 11:59:41,256 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:41] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:43,326 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:43] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:43,327 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 11:59:43,585 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:43] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 11:59:43,650 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:43] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:46,085 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:46,392 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 11:59:46,409 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:46] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:46,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 11:59:46,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 11:59:46,452 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 11:59:46,453 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 11:59:46,453 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 11:59:46,453 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 11:59:46,526 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:46] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 11:59:46,849 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 11:59:46,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 11:59:46,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 11:59:46,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 11:59:46,951 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 11:59:46,952 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 11:59:46,952 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 11:59:47,038 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:47] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 11:59:50,421 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:50,737 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 11:59:50,737 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 11:59:51,061 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 11:59:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:00:28,020 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:28,020 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:28] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:00:28,274 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:28] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:00:28,337 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:28] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:33,796 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:00:33,798 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:33,934 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 12:00:33,935 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 12:00:33,935 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 12:00:33,935 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 12:00:33,935 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 12:00:33,935 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 12:00:34,040 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:34] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:00:34,050 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:34] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:34,109 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:00:34,244 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 12:00:34,244 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 12:00:34,246 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 12:00:34,246 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 12:00:34,246 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 12:00:34,247 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 12:00:34,351 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:34] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:00:47,410 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:47,714 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:47] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:00:47,727 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:47] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:00:48,041 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:00:48] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:03:10,461 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:10,726 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:10,792 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:10] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:03:10,804 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:11,039 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:11] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:03:11,120 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:15,194 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:03:15,197 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:15,279 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:15] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-07 12:03:15,461 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:15] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:15,508 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:03:15,520 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:15] "[35m[1mGET /api/rule-config/history HTTP/1.1[0m" 500 -
2025-10-07 12:03:40,402 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:03:40,472 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:03:41,488 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:03:41,518 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:03:41,558 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:03:41,655 - __main__ - INFO - validation_history table ready
2025-10-07 12:03:41,687 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:03:41,729 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:03:41,790 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:03:42,520 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:03:42,520 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:03:42,521 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:03:42,521 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:03:42,521 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:03:42,521 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:03:42,522 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:03:42,522 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:03:42,544 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 12:03:42,545 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 12:03:42,547 - werkzeug - INFO -  * Restarting with stat
2025-10-07 12:03:43,334 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:03:43,350 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:03:45,104 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:03:45,186 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:03:45,290 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:03:45,698 - __main__ - INFO - validation_history table ready
2025-10-07 12:03:45,799 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:03:46,005 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:03:46,056 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:03:46,782 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:03:46,783 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:03:46,783 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:03:46,783 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:03:46,783 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:03:46,784 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:03:46,784 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:03:46,784 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:03:46,793 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 12:03:46,799 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 12:03:57,835 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:57] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:58,084 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:58,161 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:03:58,163 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:58,211 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 12:03:58,211 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 12:03:58,211 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 12:03:58,212 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 12:03:58,212 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 12:03:58,212 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 12:03:58,295 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:58] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:03:58,399 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:58] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:03:58,476 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:03:58,603 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=10, Name=Test_18_07, File=Test_18_07.xlsx, Columns=6, Rules=4
2025-10-07 12:03:58,603 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=9, Name=Vehicle_Billing_Datain, File=Vehicle_Billing_Datain.csv, Columns=2, Rules=2
2025-10-07 12:03:58,603 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=8, Name=test24-7, File=test24-7.xlsx, Columns=5, Rules=4
2025-10-07 12:03:58,603 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=4, Name=test_10-07.xlsx, File=Unknown File, Columns=6, Rules=4
2025-10-07 12:03:58,604 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=3, Name=date.xlsx, File=Unknown File, Columns=4, Rules=5
2025-10-07 12:03:58,604 - rule_configuration_endpoints - INFO - [HISTORY] Found 5 configured templates
2025-10-07 12:03:58,708 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:03:58] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:04:19,534 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_04-07.xlsx by user vamsi@gmail.com
2025-10-07 12:04:19,534 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_04-07.xlsx
2025-10-07 12:04:19,535 - __main__ - INFO - Starting DuckDB analysis for file: 695e1051-6905-4ca5-84e4-cd99c9ad094f_test_04-07.xlsx
2025-10-07 12:04:20,470 - __main__ - INFO - File analysis completed: 3 rows, 4 columns
2025-10-07 12:04:20,480 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 4
2025-10-07 12:04:20,481 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-07 12:04:20,541 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-07 12:04:21,027 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=1, Name=test_04-07
2025-10-07 12:04:21,134 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:21] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-07 12:04:21,753 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:21] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:04:21,953 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:21] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:04:21,953 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:21] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:04:22,466 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:22] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:04:22,772 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:22] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:04:29,398 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:04:29,402 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:29,532 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=test_04-07, File=test_04-07.xlsx, Columns=0, Rules=0
2025-10-07 12:04:29,533 - rule_configuration_endpoints - INFO - [HISTORY] Found 1 configured templates
2025-10-07 12:04:29,632 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:29] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:04:29,658 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:29] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:29,717 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:04:29,834 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=test_04-07, File=test_04-07.xlsx, Columns=0, Rules=0
2025-10-07 12:04:29,835 - rule_configuration_endpoints - INFO - [HISTORY] Found 1 configured templates
2025-10-07 12:04:29,938 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:29] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:04:50,073 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:50] "OPTIONS /api/rule-config/delete/1 HTTP/1.1" 200 -
2025-10-07 12:04:50,384 - rule_configuration_endpoints - INFO - [DELETE] Deleting template 1 for user vamsi@gmail.com
2025-10-07 12:04:50,725 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:50] "DELETE /api/rule-config/delete/1 HTTP/1.1" 200 -
2025-10-07 12:04:50,740 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:04:50,826 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:04:50,931 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:50] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:04:53,860 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:53] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:04:53,860 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:53] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:54,105 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:54] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:54,183 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:54] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:04:55,361 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:55,668 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:04:55,686 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:55] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:04:55,844 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:04:55,950 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:55] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:04:56,263 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:04:56,459 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:04:56,564 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:04:56] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:05:00,631 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:00,945 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:00] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:00,959 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:05:01,065 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:05:01,173 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:01] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:05:01,211 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:01,256 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:05:01,291 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:05:01,315 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:01] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:05:01,492 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:01] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:17,375 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:17] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-07 12:05:17,704 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:17] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-07 12:05:17,946 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:17] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 12:05:18,211 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:18] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 12:05:21,012 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:21] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 12:05:21,332 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-07 12:05:21,451 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:21] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 12:05:21,910 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:21] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:22,158 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:22,225 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:05:22,244 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:22,473 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:22] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:05:22,549 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:22] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:26,008 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:26,307 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:05:26,326 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:26] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:05:26,462 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:05:26,572 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:26] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:05:26,884 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:05:27,077 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:05:27,182 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:05:27] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:06:09,460 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: test_04-07.xlsx by user vamsi@gmail.com
2025-10-07 12:06:09,460 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for test_04-07.xlsx
2025-10-07 12:06:09,460 - __main__ - INFO - Starting DuckDB analysis for file: 65b69768-a74d-4a20-b7b5-2b0abcda2d8b_test_04-07.xlsx
2025-10-07 12:06:09,469 - __main__ - INFO - File analysis completed: 3 rows, 4 columns
2025-10-07 12:06:09,470 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 4
2025-10-07 12:06:09,471 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-07 12:06:09,572 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-07 12:06:09,983 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=1, Name=test_04-07
2025-10-07 12:06:10,092 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:10] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-07 12:06:10,601 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:10] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:06:10,702 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:10] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:06:11,318 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:11] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:06:11,319 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:11] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:06:12,034 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:12] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:06:19,781 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:19] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-07 12:06:21,246 - rule_configuration_endpoints - INFO - Headers selected for template 1: ['name ', 'num1', 'num2', 'sum']
2025-10-07 12:06:21,353 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:21] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-07 12:06:22,073 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:22] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:06:33,225 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:06:33,542 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:33] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:06:33,543 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:33] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:06:33,866 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:06:33] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:07:06,055 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:07:06,074 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:07:06,784 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:07:06,806 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:07:06,844 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:07:06,927 - __main__ - INFO - validation_history table ready
2025-10-07 12:07:06,949 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:07:06,976 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-07 12:07:07,208 - __main__ - INFO - Seeded 10 validation rule types
2025-10-07 12:07:07,235 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:07:07,319 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:07:08,131 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:07:08,131 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:07:08,132 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:07:08,132 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:07:08,132 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:07:08,132 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:07:08,133 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:07:08,133 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:07:08,168 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 12:07:08,170 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 12:07:08,174 - werkzeug - INFO -  * Restarting with stat
2025-10-07 12:07:09,089 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:07:09,111 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:07:09,865 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:07:09,888 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:07:09,924 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:07:09,998 - __main__ - INFO - validation_history table ready
2025-10-07 12:07:10,022 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:07:10,071 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:07:10,117 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:07:10,861 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:07:10,861 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:07:10,861 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:07:10,862 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:07:10,862 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:07:10,862 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:07:10,862 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:07:10,862 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:07:10,872 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 12:07:10,877 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 12:07:30,561 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:30] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 12:07:30,822 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:30] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 12:07:49,301 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:49] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 12:07:49,939 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-07 12:07:49,980 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:49] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 12:07:50,323 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:50,654 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:50,671 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:07:50,902 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:50,980 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 12:07:50,994 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:50] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:52,389 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:52,695 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:07:52,716 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:07:52,718 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:07:52,744 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:52] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:07:53,063 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:07:53,086 - rule_configuration_endpoints - INFO - [HISTORY] Found 0 configured templates
2025-10-07 12:07:53,113 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:07:53] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:16:08,402 - werkzeug - INFO -  * Detected change in 'C:\\Users\\MOM\\Downloads\\DATA_SYNC_AI\\BACKEND\\rule_configuration_endpoints.py', reloading
2025-10-07 12:16:08,871 - werkzeug - INFO -  * Restarting with stat
2025-10-07 12:16:10,301 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:16:10,388 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:16:12,268 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:16:12,298 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:16:12,362 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:16:12,462 - __main__ - INFO - validation_history table ready
2025-10-07 12:16:12,491 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:16:12,540 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:16:53,368 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:16:53,399 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:16:54,108 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:16:54,132 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:16:54,153 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:16:54,220 - __main__ - INFO - validation_history table ready
2025-10-07 12:16:54,245 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:16:54,285 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:34:55,337 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:34:55,407 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:34:56,086 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:34:56,112 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:34:56,155 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:34:56,254 - __main__ - INFO - validation_history table ready
2025-10-07 12:34:56,281 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:34:56,305 - __main__ - INFO - validation_rule_types table exists but is empty - seeding default rules
2025-10-07 12:34:56,572 - __main__ - INFO - Seeded 10 validation rule types
2025-10-07 12:34:56,603 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:43:17,485 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:43:17,562 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:43:18,303 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:43:18,324 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:43:18,363 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:43:18,452 - __main__ - INFO - validation_history table ready
2025-10-07 12:43:18,477 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:43:18,519 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:46:43,399 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:46:43,470 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:46:44,806 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:46:44,846 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:46:44,886 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:46:45,002 - __main__ - INFO - validation_history table ready
2025-10-07 12:46:45,042 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:46:45,116 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:48:29,245 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:48:29,259 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:48:29,939 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:48:29,964 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:48:29,987 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:48:30,059 - __main__ - INFO - validation_history table ready
2025-10-07 12:48:30,087 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:48:30,139 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:50:53,709 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:50:53,725 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:50:54,416 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:50:54,439 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:50:54,499 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:50:54,586 - __main__ - INFO - validation_history table ready
2025-10-07 12:50:54,607 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:50:54,647 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:50:54,695 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:50:55,379 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:50:55,379 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:50:55,380 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:50:55,380 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:50:55,380 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:50:55,380 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:50:55,380 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:50:55,380 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:50:55,401 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 12:50:55,402 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 12:50:55,404 - werkzeug - INFO -  * Restarting with stat
2025-10-07 12:50:56,185 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 12:50:56,202 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 12:50:56,902 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 12:50:56,924 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 12:50:56,947 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 12:50:57,008 - __main__ - INFO - validation_history table ready
2025-10-07 12:50:57,030 - __main__ - INFO - validation_corrections table ready
2025-10-07 12:50:57,070 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 12:50:57,129 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 12:50:57,822 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 12:50:57,822 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 12:50:57,823 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 12:50:57,823 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 12:50:57,823 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 12:50:57,823 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 12:50:57,823 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 12:50:57,823 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 12:50:57,832 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 12:50:57,840 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 12:51:07,945 - rule_configuration_endpoints - INFO - [ENTERPRISE] File upload initiated: 31-07.xlsx by user vamsi@gmail.com
2025-10-07 12:51:07,945 - rule_configuration_endpoints - INFO - [DUCKDB] Analyzing file structure for 31-07.xlsx
2025-10-07 12:51:07,946 - __main__ - INFO - Starting DuckDB analysis for file: 8fffceba-3be6-4856-9a56-b9fbe9737ef5_31-07.xlsx
2025-10-07 12:51:08,377 - __main__ - INFO - File analysis completed: 3 rows, 3 columns
2025-10-07 12:51:08,388 - rule_configuration_endpoints - INFO - [DUCKDB] Analysis complete - Rows: 3, Columns: 3
2025-10-07 12:51:08,389 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] Searching for existing templates with matching structure
2025-10-07 12:51:08,418 - rule_configuration_endpoints - INFO - [TEMPLATE DETECTION] No matching template found - creating new template
2025-10-07 12:51:08,509 - rule_configuration_endpoints - INFO - [TEMPLATE CREATION] New template created: ID=1, Name=31-07
2025-10-07 12:51:08,537 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:08] "POST /api/rule-config/upload HTTP/1.1" 200 -
2025-10-07 12:51:08,788 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:08] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:51:09,059 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:09] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:51:09,175 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:09] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:51:09,398 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:09] "GET /api/rule-config/get-all-rules HTTP/1.1" 200 -
2025-10-07 12:51:09,556 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:09] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:51:14,429 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:14] "OPTIONS /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-07 12:51:14,982 - rule_configuration_endpoints - INFO - Headers selected for template 1: ['name', 'age', 'date']
2025-10-07 12:51:15,012 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:15] "POST /api/rule-config/select-headers HTTP/1.1" 200 -
2025-10-07 12:51:15,149 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:15] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:51:34,292 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:34] "OPTIONS /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-07 12:51:35,198 - rule_configuration_endpoints - INFO - Rules configured for template 1: {'name': ['Required', 'Text'], 'age': ['Required', 'Int'], 'date': ['Required', 'Alphanumeric']}
2025-10-07 12:51:35,221 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:35] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-07 12:51:35,327 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:35] "GET /api/rule-config/get-template/1 HTTP/1.1" 200 -
2025-10-07 12:51:35,729 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:35] "GET /api/rule-config/get-template-rules/1 HTTP/1.1" 200 -
2025-10-07 12:51:37,565 - rule_configuration_endpoints - INFO - Rules configured for template 1: {'age': ['Int', 'Required'], 'date': ['Alphanumeric', 'Required'], 'name': ['Required', 'Text']}
2025-10-07 12:51:37,589 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:37] "POST /api/rule-config/configure-rules HTTP/1.1" 200 -
2025-10-07 12:51:37,936 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:51:37,939 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:37] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:51:37,959 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=31-07, File=31-07.xlsx, Columns=3, Rules=4
2025-10-07 12:51:37,959 - rule_configuration_endpoints - INFO - [HISTORY] Found 1 configured templates
2025-10-07 12:51:37,983 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:37] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 12:51:38,190 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:38] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 12:51:38,259 - rule_configuration_endpoints - INFO - [HISTORY] Fetching configuration history for user vamsi@gmail.com
2025-10-07 12:51:38,281 - rule_configuration_endpoints - INFO - [HISTORY] Template: ID=1, Name=31-07, File=31-07.xlsx, Columns=3, Rules=4
2025-10-07 12:51:38,281 - rule_configuration_endpoints - INFO - [HISTORY] Found 1 configured templates
2025-10-07 12:51:38,308 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 12:51:38] "GET /api/rule-config/history HTTP/1.1" 200 -
2025-10-07 13:59:36,754 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 13:59:36,843 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 13:59:38,835 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 13:59:38,990 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 13:59:39,087 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 13:59:39,266 - __main__ - INFO - validation_history table ready
2025-10-07 13:59:39,398 - __main__ - INFO - validation_corrections table ready
2025-10-07 13:59:39,451 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 13:59:39,534 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 13:59:40,278 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 13:59:40,279 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 13:59:40,279 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 13:59:40,279 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 13:59:40,279 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 13:59:40,279 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 13:59:40,280 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 13:59:40,280 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 13:59:40,306 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 13:59:40,307 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 13:59:40,309 - werkzeug - INFO -  * Restarting with stat
2025-10-07 13:59:41,147 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 13:59:41,164 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 13:59:42,022 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 13:59:42,047 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 13:59:42,164 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 13:59:42,228 - __main__ - INFO - validation_history table ready
2025-10-07 13:59:42,250 - __main__ - INFO - validation_corrections table ready
2025-10-07 13:59:42,389 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 13:59:42,444 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 13:59:43,187 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 13:59:43,187 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 13:59:43,188 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 13:59:43,188 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 13:59:43,188 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 13:59:43,188 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 13:59:43,188 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 13:59:43,189 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 13:59:43,197 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 13:59:43,205 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 14:14:57,543 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 14:14:57,618 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 14:15:00,256 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 14:15:00,289 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 14:15:00,368 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 14:15:00,479 - __main__ - INFO - validation_history table ready
2025-10-07 14:15:00,514 - __main__ - INFO - validation_corrections table ready
2025-10-07 14:15:00,562 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 14:15:00,652 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 14:15:01,399 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 14:15:01,399 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 14:15:01,400 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 14:15:01,400 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 14:15:01,400 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 14:15:01,400 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 14:15:01,400 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 14:15:01,400 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 14:15:01,422 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.65:5000
2025-10-07 14:15:01,422 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-10-07 14:15:01,424 - werkzeug - INFO -  * Restarting with stat
2025-10-07 14:15:02,275 - __main__ - INFO - Using Azure Data Lake: https://onelake.dfs.fabric.microsoft.com/Keansa_AI_Suite/Keansa_AI_Suite_Backend.Lakehouse/Files/SL_files
2025-10-07 14:15:02,291 - __main__ - INFO - DuckDB memory tables initialized
2025-10-07 14:15:03,998 - __main__ - INFO - Connected to SQL Fabric: Keansa_AI_Suite_SQL_DB-62c0a061-dfa5-4157-ab9b-94a6b62e41e7
2025-10-07 14:15:04,100 - __main__ - INFO - Existing tables: ['validation_history', 'validation_corrections', 'validation_sessions', 'validation_errors', 'excel_templates', 'template_columns', 'validation_rule_types', 'column_validation_rules', 'login_details', 'Address', 'Product', 'SalesOrderDetail', 'ProductModelProductDescription', 'SalesOrderHeader', 'Customer', 'ProductDescription', 'ProductModel', 'CustomerAddress', 'ProductCategory']
2025-10-07 14:15:04,202 - __main__ - INFO - Current login_details columns: [('id', 'bigint'), ('first_name', 'nvarchar'), ('last_name', 'nvarchar'), ('email', 'nvarchar'), ('mobile', 'nvarchar'), ('password', 'nvarchar'), ('password_hash', 'varchar'), ('role', 'varchar'), ('domain', 'varchar'), ('is_approved', 'bit'), ('updated_at', 'datetime')]
2025-10-07 14:15:04,509 - __main__ - INFO - validation_history table ready
2025-10-07 14:15:04,613 - __main__ - INFO - validation_corrections table ready
2025-10-07 14:15:04,815 - __main__ - INFO - SQL Fabric tables initialized successfully
2025-10-07 14:15:04,872 - rule_configuration_endpoints - INFO - Rule configuration endpoints registered successfully
2025-10-07 14:15:05,612 - __main__ - INFO - Starting Data Sync AI Enterprise v2.0
2025-10-07 14:15:05,612 - __main__ - INFO - DuckDB Analytics: Enabled
2025-10-07 14:15:05,612 - __main__ - INFO - Fabric Lakehouse: Enabled
2025-10-07 14:15:05,613 - __main__ - INFO - Multi-tenant: Admin/Tenant/User roles
2025-10-07 14:15:05,613 - __main__ - INFO - Rule Configuration: 3-step workflow
2025-10-07 14:15:05,613 - __main__ - INFO - Data Validation: 3-step workflow
2025-10-07 14:15:05,613 - __main__ - INFO - Server: http://127.0.0.1:5000
2025-10-07 14:15:05,613 - __main__ - INFO - Demo Login: admin@example.com / admin123
2025-10-07 14:15:05,621 - werkzeug - WARNING -  * Debugger is active!
2025-10-07 14:15:05,629 - werkzeug - INFO -  * Debugger PIN: 135-922-860
2025-10-07 14:23:18,173 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:18] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:23:18,367 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:18] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:23:50,163 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:50] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:23:50,912 - __main__ - INFO - Login successful: admin@datasyncai.com (admin) - Real database
2025-10-07 14:23:51,090 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:51] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:23:51,275 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:23:51,603 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:23:51,761 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 2, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:23:51,765 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:51] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:23:51,856 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:51] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:23:52,025 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 2, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:23:52,029 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:52] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:23:52,086 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:23:52] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:24:58,719 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:24:58] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:24:59,060 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:24:59] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:24:59,296 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:24:59] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:24:59,546 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:24:59] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:26:30,513 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:26:30] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:27:15,650 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:15] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:27:16,428 - __main__ - INFO - Login successful: admin@datasyncai.com (admin) - Real database
2025-10-07 14:27:16,475 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:16] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:27:16,962 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:16] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:27:17,283 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:27:17,410 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:17] "[33mGET /api/admin/stats HTTP/1.1[0m" 404 -
2025-10-07 14:27:17,545 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:17] "[33mGET /api/admin/stats HTTP/1.1[0m" 404 -
2025-10-07 14:27:26,463 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 2, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:27:26,468 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:26] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:27:27,036 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 2, 'pending_approvals': 0, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 1}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:27:27,042 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:27] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:27:28,348 - __main__ - INFO - Admin retrieved 2 users from SQL Fabric
2025-10-07 14:27:28,353 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:28] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:27:28,742 - __main__ - INFO - Admin retrieved 2 users from SQL Fabric
2025-10-07 14:27:28,746 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:27:28] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:28:18,339 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:28:18] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:28:18,661 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:28:18] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:28:19,071 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:28:19] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:28:19,385 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:28:19] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:29:08,144 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:08] "OPTIONS /api/auth/register HTTP/1.1" 200 -
2025-10-07 14:29:08,823 - __main__ - INFO - Registering user: email=kiran@gmail.com, first_name=kiran, last_name=kumar, phone=9392136686
2025-10-07 14:29:09,028 - __main__ - INFO - [SUCCESS] User registered successfully: kiran@gmail.com (ID: 3) - Pending approval
2025-10-07 14:29:09,132 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:09] "[35m[1mPOST /api/auth/register HTTP/1.1[0m" 201 -
2025-10-07 14:29:15,938 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:15] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:29:16,665 - __main__ - INFO - Login successful: admin@datasyncai.com (admin) - Real database
2025-10-07 14:29:16,820 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:16] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:29:17,024 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:29:17,345 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:17] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:29:17,628 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:29:17,631 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:17] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:29:18,037 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:29:18,042 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:18] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:29:19,678 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:29:19,682 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:19] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:29:21,212 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:29:21,216 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:29:21] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:36:11,655 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:36:11,879 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:11] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:36:12,133 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:36:12,137 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:36:12,316 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:36:12,320 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:12] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:36:13,138 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:36:13,141 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:13] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:36:13,586 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:36:13,589 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:36:13] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:39:39,774 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:39] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:39:39,983 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:39] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:39:40,649 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:39:40,654 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:40] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:39:41,161 - __main__ - INFO - Admin stats: {'dashboard_type': 'admin', 'total_users': 3, 'pending_approvals': 1, 'total_validations': 0, 'total_templates': 1, 'role_distribution': {'admin': 1, 'user': 2}, 'system_status': 'operational', 'active_tenants': 0}
2025-10-07 14:39:41,166 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:41] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:39:42,799 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:39:42,804 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:42] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:39:44,339 - __main__ - INFO - Admin retrieved 3 users from SQL Fabric
2025-10-07 14:39:44,343 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:39:44] "GET /api/admin/users HTTP/1.1" 200 -
2025-10-07 14:40:05,186 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:05] "OPTIONS /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:40:05,517 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:05] "POST /api/auth/logout HTTP/1.1" 200 -
2025-10-07 14:40:05,776 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:05] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:40:06,026 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:06] "[31m[1mGET /api/auth/me HTTP/1.1[0m" 401 -
2025-10-07 14:40:09,037 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:09] "OPTIONS /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:40:09,400 - __main__ - INFO - Login successful: vamsi@gmail.com (user) - Real database
2025-10-07 14:40:09,539 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:09] "POST /api/auth/login HTTP/1.1" 200 -
2025-10-07 14:40:10,032 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:40:10,296 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:40:10,362 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:40:10,362 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/auth/me HTTP/1.1" 200 -
2025-10-07 14:40:10,611 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/dashboard/stats HTTP/1.1" 200 -
2025-10-07 14:40:10,690 - werkzeug - INFO - 127.0.0.1 - - [07/Oct/2025 14:40:10] "GET /api/auth/me HTTP/1.1" 200 -
